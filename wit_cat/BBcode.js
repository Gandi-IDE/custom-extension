const witcat_BBcode_icon = "data:@file/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKcAAACWCAMAAACM7mjWAAAAjVBMVEUAAADi4eTi4uTh4OPf3+Pq1eri4eXi4eTj4uTi4eXi4uXh4ePf3+Xi4uTi4eXi4eTj4OTf39+/v7/j4uTj4uXi4eTj4uXj4eTj4OTj4uTf3+Df39/h4eTh4OTg3+Th4OPj4uTh3+Ti4uXh4ePi4eLj4uXj3+Pm5ubi4OTi4uXj4ePf39/f39/j4eXi4eQ4kjUHAAAALnRSTlMAn7+AQAzg+sfDuXQo8eekRwgEls2q69hoYxgQbGMwJINwUjosjUAUv7NcMCCHUysqWQAAA2hJREFUeNrt3dly2jAAheEDxvuCF0gwawJkb8/7P17btNO0km1IR7bkjr4XyD8wCC6iY7Ry87gKPc/nEHzPC6s4d/FJByfwOTw/dA64WrENqE+wLXCNTZxRryze4KL6hvrd1Oj2FtAMQYIOK5+m8Fdo485pkrnbkhnSLGFj6PqWprldQ7IxL/N7qGv8m97y1pv1EfowFw4kmmqFP7yZc26K/Dd8MOVbqEmA33ZscxNEkyFEwQ3b7PDLJmWjqD5gOIc6anmtNvjJYZPlGUM7L9nEwbui6SX3HqHDo0dZVuCHLWUvLvRwI8q2+GFBybKELuWSkgW+Syh5KaFPGVGSALijyHOhk+tRdNd4xj9Cr8ems971KVhCtyUFvoucojN021OUI6ZgCv1CCmJMKLiHfvcUVHJ6Av0SCkKIh0AKE6TiUSl1LmCChdTpG/gxAqbiwQRe1ekeHyYKVKv1v3Xyqs7SSamIP1n31rmZUqHs1FNnOaVS2Zd+OmMqNu2ls0ip2qmPzpzKPfTR6VC5sI/Oisp5fXTeUblFH501lVv20fnkU7XXPjoxoWJe0Uvnl4xq5T19v59SqhT39nspWVCZ7AhlnbLjXMk/DHjRvYv+OrvNKHDQxXbaTttpO22n7bSdttN22k7baTttp+20nbbTdtpO22k7bafttJ2203baTttpO22n7bSdttOQzqKOvIZZhvnRrM7cY4tFYlDnzmer9GRM58lnh2xtSGe5YKeJIZ05u/lPZnRWvODVjM6IFzhDdO4/+1dl1RCda/nisuDFiNcT3qULdg4vyAfpfOBfbiFK2C0rB+lcp/zTEZI5O91jkE68CssPkrXHDlHZe6e8i7Ms0CC57ch0MVQnTgHfZSs0e6p8NkrjEv11yvZxNbnLC7R6qh8mkq9H97rfn6O5xzeWe5FjuWdq5L3dMwUhqpHcg47ldP0a7pXnFO2hVfM9/dHsHiCgaAa9ZhQFI9rlSCiJTNw5GctuDLaURQbu8BQZZd4MOsw6do3gsMn8jKHt52ziXNjdeh50dyupn9t2t8zZMXsOUrbZjW4XDnuDd/b2I9wtHM0O5Gh2NeGOY6d0NLuvBr71oTuOXeJiDDvPaY0OiSnfTEGCbjsjdsh3/82u+2h28t8dnND85w58PMdhOuBzHKadz3H4Bhhs5K+IK1U6AAAAAElFTkSuQmCC";

const witcat_BBcode_picture = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBmaWxsPSJub25lIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2NDAiIGhlaWdodD0iMzYwIiB2aWV3Qm94PSIwIDAgNjQwIDM2MCI+PGRlZnM+PGNsaXBQYXRoIGlkPSJtYXN0ZXJfc3ZnMF8xNF8wMDMiPjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSI2NDAiIGhlaWdodD0iMzYwIiByeD0iMCIvPjwvY2xpcFBhdGg+PGxpbmVhckdyYWRpZW50IHgxPSIwIiB5MT0iMCIgeDI9IjEiIHkyPSIxIiBpZD0ibWFzdGVyX3N2ZzFfMjFfNTciPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNFMTZDOTYiIHN0b3Atb3BhY2l0eT0iMSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI0ZCRTRGRCIgc3RvcC1vcGFjaXR5PSIxIi8+PC9saW5lYXJHcmFkaWVudD48ZmlsdGVyIGlkPSJtYXN0ZXJfc3ZnMl8xNF8wMDQiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIiB4PSItNjQiIHk9Ii02MCIgd2lkdGg9IjM5OCIgaGVpZ2h0PSIzOTgiPjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+PGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiLz48ZmVPZmZzZXQgZHk9IjQiIGR4PSIwIi8+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTYiLz48ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4zMDE5NjA3OTYxMTc3ODI2IDAiLz48ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvdyIvPjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93IiByZXN1bHQ9InNoYXBlIi8+PC9maWx0ZXI+PGZpbHRlciBpZD0ibWFzdGVyX3N2ZzNfMTdfMDYzMSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiIHg9Ii0yMCIgeT0iLTE2IiB3aWR0aD0iNDY1IiBoZWlnaHQ9IjQ2MCI+PGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz48ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIvPjxmZU9mZnNldCBkeT0iNCIgZHg9IjAiLz48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSI1Ii8+PGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMzAxOTYwNzk2MTE3NzgyNiAwIi8+PGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3ciLz48ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvdyIgcmVzdWx0PSJzaGFwZSIvPjwvZmlsdGVyPjwvZGVmcz48ZyBjbGlwLXBhdGg9InVybCgjbWFzdGVyX3N2ZzBfMTRfMDAzKSI+PGc+PHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjY0MCIgaGVpZ2h0PSIzNjAiIHJ4PSIwIiBmaWxsPSJ1cmwoI21hc3Rlcl9zdmcxXzIxXzU3KSIgZmlsbC1vcGFjaXR5PSIxIi8+PC9nPjxnIGZpbHRlcj0idXJsKCNtYXN0ZXJfc3ZnMl8xNF8wMDQpIj48cGF0aCBkPSJNMjQxLDQ1QzI3MC44MjMsNDUsMjk1LDcxLjg2MjksMjk1LDEwNUwyOTUsMjU1QzI5NSwyODguMTM3LDI3MC44MjMsMzE1LDI0MSwzMTVMNzksMzE1QzQ5LjE3NjYsMzE1LDI0Ljk5OTk5NjkxMDA5LDI4OC4xMzcsMjUsMjU1TDI1LDEwNUMyNC45OTk5OTM4MjAxOSw3MS44NjI5LDQ5LjE3NjYsNDUsNzksNDVMMjQxLDQ1Wk0yNDEsNzVMNzksNzVDNjQuODcwNiw3NC45OTUsNTMuMTI3Miw4Ny4wOTQ3OTk5OTk5OTk5OSw1Mi4wNjc0OTk5OTk5OTk5OTUsMTAyLjc1TDUyLDEwNUw1MiwyNTVDNTEuOTk1NSwyNzAuNjk5LDYyLjg4NTQsMjgzLjc0OCw3Ni45NzUsMjg0LjkyNUw3OSwyODVMMjQxLDI4NUMyNTUuMTI5LDI4NS4wMDUsMjY2Ljg3MywyNzIuOTA1LDI2Ny45MzMsMjU3LjI1TDI2OCwyNTVMMjY4LDEwNUMyNjguMDA0LDg5LjMwMDYsMjU3LjExNSw3Ni4yNTI1LDI0My4wMjUsNzUuMDc1TDI0MSw3NVpNMjI3LjUsMjI1QzIzNC45NTEsMjI1LjAwOCwyNDAuOTg3LDIzMS43MjEsMjQwLjk4NywyNDBDMjQwLjk4NywyNDguMjc5LDIzNC45NTEsMjU0Ljk5MiwyMjcuNSwyNTVMMjAwLjUsMjU1QzE5My4wNDQsMjU1LDE4NywyNDguMjg0LDE4NywyNDBDMTg3LDIzMS43MTYsMTkzLjA0NCwyMjUsMjAwLjUsMjI1TDIyNy41LDIyNVpNMjAwLjUsMTA1QzIwNy45NTIsMTA1LjAwNTY5OTk5OTk5OTk5LDIxMy45OTEsMTExLjcxOTgsMjEzLjk5MSwxMjBDMjEzLjk5MSwxMjguMjgwMTk5OTk5OTk5OTgsMjA3Ljk1MiwxMzQuOTk0MywyMDAuNSwxMzVMMTYwLDEzNUwxNjAsMjQwQzE1OS45OTMsMjQ4LjI3OSwxNTMuOTUxLDI1NC45ODUsMTQ2LjUsMjU0Ljk4NUMxMzkuMDQ5LDI1NC45ODUsMTMzLjAwNywyNDguMjc5LDEzMywyNDBMMTMzLDEzNUw5Mi41LDEzNUM4NS4wNDA1MDAwMDAwMDAwMSwxMzUuMDA1Nyw3OC45OTA3LDEyOC4yODgzLDc4Ljk5MDcsMTIwQzc4Ljk5MDcsMTExLjcxMTcsODUuMDQwNTAwMDAwMDAwMDEsMTA0Ljk5NDMwMDAwMDAwMDAxLDkyLjUsMTA1TDIwMC41LDEwNVoiIGZpbGw9IiNGRkZGRkYiIGZpbGwtb3BhY2l0eT0iMSIvPjwvZz48ZyBmaWx0ZXI9InVybCgjbWFzdGVyX3N2ZzNfMTdfMDYzMSkiPjxwYXRoIGQ9Ik0zNjEuMzQzOCw3OS4yTDM1OS4yNSw5NS45MzQ0TDM1NS4wNzgxLDk4LjY4NDRMMzU4LjUzMTIsMTAxLjUxMjVMMzU2LjQ1MzEsMTE1LjM3MTlRMzU1LjkzNzUsMTE3LjQ2NTYsMzU0LjUsMTE4Ljg0MDZRMzUzLjA2MjUsMTIwLjIsMzUwLjk2ODgsMTIwLjJMMzEyLjIzNDM4LDEyMC4yTDMxNy4wNjI1LDgxLjk1TDMxNC45Njg3NSw3OS4yTDM2MS4zNDM4LDc5LjJaTTMzMC4yMzQ0LDg2LjE2ODdMMzI5LjUxNTYsOTUuMkwzNDUuNDM3NSw5NS4yTDM0Ni43OTY5LDg2LjE2ODdMMzMwLjIzNDQsODYuMTY4N1pNMzI4LjE1NjIsMTAyLjE2ODdMMzI2Ljc4MTIsMTEzLjIzMTJMMzQzLjM0MzgsMTEzLjIzMTJMMzQ0LjcxODgsMTAyLjE2ODdMMzI4LjE1NjIsMTAyLjE2ODdaTTQxNy4zNDQsNzkuMkw0MTUuMjUsOTUuOTM0NEw0MTEuMDc4LDk4LjY4NDRMNDE0LjUzMSwxMDEuNTEyNUw0MTIuNDUzLDExNS4zNzE5UTQxMS45MzgsMTE3LjQ2NTYsNDEwLjUsMTE4Ljg0MDZRNDA5LjA2MiwxMjAuMiw0MDYuOTY4OCwxMjAuMkwzNjguMjM0NCwxMjAuMkwzNzMuMDYyNSw4MS45NUwzNzAuOTY4OCw3OS4yTDQxNy4zNDQsNzkuMlpNMzg2LjIzNDQsODYuMTY4N0wzODUuNTE1Niw5NS4yTDQwMS40Mzc1LDk1LjJMNDAyLjc5NjksODYuMTY4N0wzODYuMjM0NCw4Ni4xNjg3Wk0zODQuMTU2MiwxMDIuMTY4N0wzODIuNzgxMiwxMTMuMjMxMkwzOTkuMzQzOCwxMTMuMjMxMkw0MDAuNzE4OCwxMDIuMTY4N0wzODQuMTU2MiwxMDIuMTY4N1pNNDM3LjI2NTk5OTk5OTk5OTk2LDE5MC4xNjlMNDE1LjE1NiwxOTAuMTY5TDQxMi40MjIsMjA3LjIzMUw0MzEuNzE5LDIwNy4yMzFMNDM1LjE3MiwyMDQuNDE5TDQzMy44MTIsMjE0LjJMMzk3Ljg3NSwyMTQuMkw0MDIuNzAzMSwxODMuMkw0MzcuOTg0MDAwMDAwMDAwMDQsMTgzLjJMNDM3LjI2NTk5OTk5OTk5OTk2LDE5MC4xNjlaTTQ3OC4zNTkwMDAwMDAwMDAwNCwxODMuMlE0ODAuNDM4LDE4My4yLDQ4MS40NjksMTg0LjkwM1E0ODIuNSwxODYuNjA2LDQ4Mi41LDE4OC43MTZMNDc5LjA2MiwyMTQuMkw0NDguMTU2LDIxNC4yUTQ0Ni4wNzgsMjE0LjIsNDQ1LjAzMSwyMTIuODI1UTQ0NCwyMTEuNDUsNDQ0LDIwOS4zNDFMNDQ3LjQzOCwxODMuMkw0NzguMzU5MDAwMDAwMDAwMDQsMTgzLjJaTTQ2MC40NTMsMTkwLjE2OUw0NTcuNzM0MDAwMDAwMDAwMDQsMjA3LjIzMUw0NjUuOTY5LDIwNy4yMzFMNDY4Ljc2NTk5OTk5OTk5OTk2LDE5MC4xNjlMNDYwLjQ1MywxOTAuMTY5Wk01MTUuNjU2LDE2OC4yTDUyOS40ODQsMTY4LjJMNTIzLjI4MSwyMTQuMkw0OTIuMTg4LDIxNC4yUTQ5MC4wOTQsMjE0LjIsNDg5LjA0NywyMTIuODI1UTQ4OCwyMTEuNDUsNDg4LDIwOS4zNDFMNDkxLjQ2OSwxODMuMkw1MTMuNTYyLDE4My4yTDUxNS42NTYsMTY4LjJaTTUwNC4yMDMsMTkwLjE2OUw1MDEuNTQ3LDIwNy4yMzFMNTEwLjMyOCwyMDcuMjMxTDUxMi45MjIsMTkwLjE2OUw1MDQuMjAzLDE5MC4xNjlaTTU3MS42NTYsMjAxLjJMNTQ5LjU0NywyMDEuMkw1NDguODI4LDIwNy4yMzFMNTY4LjIwMywyMDcuMjMxTDU3MS42NTYsMjA0LjI2Mkw1NjkuNTYyLDIxNC4yTDUzOS4xODgsMjE0LjJRNTM3LjA5NCwyMTQuMiw1MzYuMDQ3LDIxMi44MjVRNTM1LDIxMS40NSw1MzUsMjA5LjM0MUw1MzguNDY5LDE4My4yTDU3NC4zOTEwMDAwMDAwMDAxLDE4My4yTDU3MS42NTYsMjAxLjJaTTU1MS41NjIsMTkwLjE2OUw1NTAuOTIyLDE5NC4yMzFMNTU5LjIwMywxOTQuMjMxTDU1OS45MjIsMTkwLjE2OUw1NTEuNTYyLDE5MC4xNjlaIiBmaWxsPSIjRkZGRkZGIiBmaWxsLW9wYWNpdHk9IjEiLz48L2c+PC9nPjwvc3ZnPg==";

const witcat_BBcode_extensionId = "WitCatBBcode";

/**
 * 获取到的返回值
 */

/** @typedef {string|number|boolean} SCarg 来自Scratch圆形框的参数，虽然这个框可能只能输入数字，但是可以放入变量，因此有可能获得数字、布尔和文本（极端情况下还有 null 或 undefined，需要同时处理 */

class WitCatBBcode {
    constructor(runtime) {
        this.runtime = runtime;

        /**
         * Scratch 所使用的 canvas，获取不到返回 null
         * @return {HTMLcanvasElement | null}
         */
        this.canvas = () => {
            try {
                const canvas = runtime.renderer.canvas;
                if (canvas instanceof HTMLCanvasElement) {
                    return canvas;
                }
            } catch (err) {
                return null;
            }
        };

        /**
         * 所有输入框所在的父角色，目前设为 canvas 的父角色。
         * 获取不到返回 null
         * @return {HTMLElement | null}
         */
        this.inputParent = () => {
            try {
                const canvas = runtime.renderer.canvas;
                if (canvas instanceof HTMLCanvasElement) {
                    return canvas.parentElement;
                }
            } catch (err) {
                console.error(err);
                return null;
            }
        };


        /**
         * 创建滚动条
         */
        let ScrollStyle = document.createElement("style");
        ScrollStyle.innerText = `
        h1{
            font-size:2.0em;
        }
        h3{
            font-size:1.17em;
        }
        h5{
            font-size:0.83em;
        }
        h6{
            font-size:0.67em;
        }
        .WitCatBBcode::-webkit-scrollbar{
            display: none;
        }
        .WitCatBBcode{
            color:black;
        }
        .WitCatBBcode ul{
            padding-inline-start: 40px;
            list-style:none;
        }
        .WitCatBBcode ol{
            padding-inline-start: 40px;
            list-style:auto;
        }
        .WitCatBBcode blockquote{
            display: block;
            margin-block-start: 1em;
            margin-block-end: 1em;
            margin-inline-start: 40px;
            margin-inline-end: 40px;
        }
        code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}
        `;
        document.body.appendChild(ScrollStyle);

        this._formatMessage = runtime.getFormatMessage({
            "zh-cn": {
                "WitCatBBcode.name": "[beta]白猫的BBcode",
                "WitCatBBcode.docs": "📖拓展教程",
                "WitCatBBcode.docss": "📖示例内容",
                "WitCatBBcode.tutorial": '[size=40]欢迎来到[color=#ffff00]白猫[/color]的BBcode[/size]\n\n加粗：\n[b]粗体字 Bold text[/b]\n\n斜体：\n[i]斜体字 Italic[/i]\n\n删除线：\n[s]删除线[/s]\n\n下划线：\n[u]下划线[/u]\n\n改变字号：\n[size=2]大小可变[/size]\n\n改变颜色：\n[color=#ff0000]我是红色[/color]\n\n网页链接：\n[url=https://ccw.site/]示例网址[/url]\n\n引用：\n[quote]《我三》是《艺三》难以企及的标杆[/quote]\n\n列表（无序）：\n[list]\n[*]列表项目\n[*]列表项目\n[/list]\n\n列表（数字）：\n[list=1]\n[*]列表项目A\n[*]列表项目B\n[/list]\n\n列表（字母）：\n[list=a]\n[*]列表项目A\n[*]列表项目B\n[/list]\n\n插入图片：\n[img=5]https://m.xiguacity.cn/works-covers/f6348af6-ba33-4172-b99d-246733242a00.png?x-oss-process=image%2Fresize%2Cs_360%2Fformat%2Cwebp[/img]\n\n插入代码：\n[code]printf("hello world!")[/code]\n使用代码高亮积木为代码配置语言高亮\n\n当然，你也可以嵌套：\n[color=#ff0000][b][size=100]aaa[/size][/b][/color]',
                "WitCatBBcode.create": "创建 BBcode ID[id]X[x]Y[y]宽[width]高[height]内容[text]",
                "WitCatBBcode.delete": "删除 BBcode ID[id]",
                "WitCatBBcode.deleteall": "删除所有 BBcode ",
                "WitCatBBcode.get": " BBcode ID[id]的[type]",
                "WitCatBBcode.set": "设置 BBcode ID[id]的[type]为[text]",
                "WitCatBBcode.imgstyle": " BBcode ID[id]的第[num]张图片的宽[width]高[height]",
                "WitCatBBcode.loadfontfamily": "从[text]加载字体名[name]",
                "WitCatBBcode.setfontfamily": "设置 BBcode ID[id]的字体为[name]",
                "WitCatBBcode.code": "设置 BBcode ID[id]第[num]个代码框的高亮为[name]",
                "WitCatBBcode.type.1": "X",
                "WitCatBBcode.type.2": "Y",
                "WitCatBBcode.type.3": "宽",
                "WitCatBBcode.type.4": "高",
                "WitCatBBcode.type.5": "内容",
                "WitCatBBcode.type.6": "json",
            },
            en: {
                "WitCatBBcode.name": "[beta]WitCat’s BBcode",
                "WitCatBBcode.docs": "📖 Tutorial",
                "WitCatBBcode.docss": "📖Example Content",
                "WitCatBBcode.tutorial": '[size=40] Welcome to [color=#ffff00] White Cat [/color] BBcode[/size]\n\nBold:\n[/b] Bold text[/b]\n\nItalics:\n[i] Italic[/i]\n\nDelete line:\n[s] stripper line [/s]\n\nUnderline:\n[u] Underline [/u]\n\nChange the font size:\n[size=2] Variable size [/size]\n\nChange color:\n[color=#ff0000] I am red [/color]\n\nWeb link:\n[url=https://ccw.site/] Example url [/url]\n\nQuote:\n[quote] "My Three" is "Art Three" difficult to match the benchmark [/quote]\n\nList (unordered) :\n[list]\n[*] List items\n[*] List items\n[/list]\n\nList (numbers) :\n[list=1]\n[*] List item A\n[*] List item B\n[/list]\n\nList (letters) :\n[list=a]\n[*] List item A\n[*] List item B\n[/list]\n\nInsert picture:\n[img=5]https://m.xiguacity.cn/works-covers/f6348af6-ba33-4172-b99d-246733242a00.png?x-oss-process=image%2Fresize%2Cs_360 %2Fformat%2Cwebp[/img]\n\nInsert code:\n[code]printf("hello world!" )[/code]\nConfigure language highlighting for code using code highlighting blocks\n\nOf course, you can also nest:\n[color=#ff0000][b][size=100]aaa[/size][/b][/color]',
                "WitCatBBcode.create": "Create BBcode ID[id]X[x]Y[y] width [width] height [height] content [text]",
                "WitCatBBcode.delete": "Delete BBcode ID[id]",
                "WitCatBBcode.deleteall": "Delete all BBcode",
                "WitCatBBcode.get": "ID[id]BBcode`s[type]",
                "WitCatBBcode.set": "set BBcode ID[id]`s[type] to [text]",
                "WitCatBBcode.imgstyle": "BBcode ID[id] width of [num] picture [width] height [height]",
                "WitCatBBcode.loadfontfamily": "load[name]from url[text]",
                "WitCatBBcode.setfontfamily": "set BBcode ID[id]`s font family[name]",
                "WitCatBBcode.code": "Set the [num] code box highlighted by BBcode ID[id] to [name]",
                "WitCatBBcode.type.1": "X",
                "WitCatBBcode.type.2": "Y",
                "WitCatBBcode.type.3": "width",
                "WitCatBBcode.type.4": "height",
                "WitCatBBcode.type.5": "content",
                "WitCatBBcode.type.6": "json",
            }
        })
    }

    /**
     * 翻译
     * @param {string} id
     * @return {string}
     */
    formatMessage(id) {
        return this._formatMessage({
            id,
            default: id,
            description: id
        });
    }

    getInfo() {
        return {
            id: witcat_BBcode_extensionId, // 拓展id
            name: this.formatMessage("WitCatBBcode.name"), // 拓展名
            blockIconURI: witcat_BBcode_icon,
            menuIconURI: witcat_BBcode_icon,
            color1: "#e16c96",
            color2: "#c75f85",
            blocks: [
                {
                    blockType: "button",
                    text: this.formatMessage('WitCatBBcode.docs'),
                    onClick: this.docs,
                },
                "---" + this.formatMessage("WitCatBBcode.name"),
                {
                    opcode: "create",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.create"),
                    arguments: {
                        id: {
                            type: "string",
                            defaultValue: 'i',
                        },
                        x: {
                            type: "number",
                            defaultValue: '0',
                        },
                        y: {
                            type: "number",
                            defaultValue: '0',
                        },
                        width: {
                            type: "number",
                            defaultValue: '100',
                        },
                        height: {
                            type: "number",
                            defaultValue: '100',
                        },
                        text: {
                            type: "string",
                            defaultValue: 'wit_cat!!!',
                        },
                    },
                },
                {
                    opcode: "set",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.set"),
                    arguments: {
                        id: {
                            type: "string",
                            defaultValue: 'i',
                        },
                        type: {
                            type: "string",
                            menu: 'types',
                        },
                        text: {
                            type: "string",
                            defaultValue: '0',
                        },
                    },
                },
                {
                    opcode: "imgstyle",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.imgstyle"),
                    arguments: {
                        id: {
                            type: "string",
                            defaultValue: 'i',
                        },
                        num: {
                            type: "number",
                            defaultValue: '1',
                        },
                        width: {
                            type: "string",
                            defaultValue: '100',
                        },
                        height: {
                            type: "string",
                            defaultValue: '100',
                        },
                    },
                },
                {
                    opcode: "setfont",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.setfontfamily"),
                    arguments: {
                        id: {
                            type: "string",
                            defaultValue: "i",
                        },
                        name: {
                            type: "string",
                            defaultValue: "arial",
                        },
                    },
                },
                {
                    opcode: "code",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.code"),
                    arguments: {
                        id: {
                            type: "string",
                            defaultValue: "i",
                        },
                        num: {
                            type: "number",
                            defaultValue: "1",
                        },
                        name: {
                            type: "string",
                            menu: "code",
                        },
                    },
                },
                {
                    opcode: "loadfont",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.loadfontfamily"),
                    arguments: {
                        text: {
                            type: "string",
                            defaultValue: "url",
                        },
                        name: {
                            type: "string",
                            defaultValue: "arial",
                        },
                    },
                },
                {
                    opcode: "delete",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.delete"),
                    arguments: {
                        id: {
                            type: "string",
                            defaultValue: 'i',
                        },
                    },
                },
                {
                    opcode: "deleteall",
                    blockType: "command",
                    text: this.formatMessage("WitCatBBcode.deleteall"),
                    arguments: {},
                },
                {
                    opcode: "get",
                    blockType: "reporter",
                    text: this.formatMessage("WitCatBBcode.get"),
                    arguments: {
                        id: {
                            type: "string",
                            defaultValue: 'i',
                        },
                        type: {
                            type: "string",
                            menu: 'type',
                        },
                    },
                },
                {
                    opcode: "docss",
                    blockType: "reporter",
                    text: this.formatMessage("WitCatBBcode.docss"),
                    disableMonitor: true,
                    arguments: {},
                },
            ],
            menus: {
                type: [
                    {
                        text: this.formatMessage('WitCatBBcode.type.1'),
                        value: 'x'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.2'),
                        value: 'y'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.3'),
                        value: 'width'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.4'),
                        value: 'height'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.5'),
                        value: 'content'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.6'),
                        value: 'json'
                    },
                ],
                types: [
                    {
                        text: this.formatMessage('WitCatBBcode.type.1'),
                        value: 'x'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.2'),
                        value: 'y'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.3'),
                        value: 'width'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.4'),
                        value: 'height'
                    },
                    {
                        text: this.formatMessage('WitCatBBcode.type.5'),
                        value: 'content'
                    },
                ],
                code: [
                    {
                        text: "javascript",
                        value: 'language-javascript'
                    },
                    {
                        text: "css",
                        value: 'language-css'
                    },
                    {
                        text: "HTML",
                        value: 'language-html'
                    },
                    {
                        text: "python",
                        value: 'language-python'
                    },
                ],
            },
        };
    }

    /** 打开教程 */
    docs() {
        let a = document.createElement('a');
        a.href = "https://www.ccw.site/post/7d129e01-e30a-4d88-92d2-320b555ed0f5";
        a.rel = "noopener noreferrer";
        a.target = "_blank";
        a.click();
    }
    /**
     * 限制值的范围，如果值是NaN，返回最小值
     * @param {number} x 数值
     * @param {number} min 最小值
     * @param {number} max 最大值
     * @return {number}
     */
    _clamp(x, min, max) {
        return isNaN(x) ? min : x < min ? min : x > max ? max : x;
        // return isNaN(x) ? min : Math.min(max, Math.max(min, x));
    }
    /**
     * 创建文本框
     * @param {Object} args 
     */
    create(args) {
        if (this.canvas() === null || this.inputParent() === null) {
            console.error(this.canvas(), this.inputParent())
            return;
        }
        let x = Number(args.x);
        let y = Number(args.y);
        let width = Number(args.width);
        let height = Number(args.height);
        x = this._clamp(x, 0, this.runtime.stageWidth);
        y = this._clamp(y, 0, this.runtime.stageHeight);
        width = this._clamp(width, 0, this.runtime.stageWidth - x);
        height = this._clamp(height, 0, this.runtime.stageHeight - y);
        x = (x / this.runtime.stageWidth) * 100;
        y = (y / this.runtime.stageHeight) * 100;
        width = (width / this.runtime.stageWidth) * 100;
        height = (height / this.runtime.stageHeight) * 100;

        /** @type {HTMLDivElement|null} */
        let search = null;
        let search_1 = document.getElementById("WitCatBBcode" + args.id);
        if (search_1 instanceof HTMLDivElement) {
            search = search_1;
        }
        if (search !== null) {
            this.inputParent().removeChild(search);
            search = null;
        }
        if (search === null) {
            search = document.createElement("div");
            search.id = "WitCatBBcode" + args.id;
            search.className = "WitCatBBcode";
            search.style.overflow = "auto";
            search.style.webkitUserSelect = "text";
            search.style.userSelect = "text";
            this.inputParent().appendChild(search);
        }

        let sstyle = search.style;
        sstyle.position = "absolute";
        sstyle.left = `${x}%`;
        sstyle.top = `${y}%`;
        sstyle.width = `${width}%`;
        sstyle.height = `${height}%`;
        search.innerHTML = new bbcode.Parser().toHTML(String(args.text));
        search.setAttribute("name", args.text);
    }

    imgstyle(args) {
        let search = null;
        let search_1 = document.getElementById("WitCatBBcode" + args.id);
        if (search_1 instanceof HTMLDivElement) {
            search = search_1;
        }
        if (search !== null) {
            if (search.getElementsByTagName("img").length > args.num - 1 && args.num > 0) {
                search.getElementsByTagName("img")[args.num - 1].style.width = args.width == "" ? "" : args.width + "px";
                search.getElementsByTagName("img")[args.num - 1].style.height = args.height == "" ? "" : args.height + "px";
            }
        }
    }

    /**
     * 设置bbcode
     * @param {object} args
     * @param {SCarg} args.id ID
     * @param {SCarg} args.type 属性类型
     * @param {SCarg} args.text 属性值
     */
    set(args) {
        let search = null;
        let search_1 = document.getElementById("WitCatBBcode" + args.id);
        if (search_1 instanceof HTMLDivElement) {
            search = search_1;
        }
        if (search !== null) {
            const sstyle = search.style;
            let x;
            let y;
            let width;
            let height;
            switch (args.type) {
                case "x":
                    x = this._clamp(Number(args.text), 0, this.runtime.stageWidth);
                    x = (x / this.runtime.stageWidth) * 100;
                    sstyle.left = `${x}%`;
                    break;
                case "y":
                    y = this._clamp(Number(args.text), 0, this.runtime.stageHeight);
                    y = (y / this.runtime.stageHeight) * 100;
                    sstyle.top = `${y}%`;
                    break;
                case "width":
                    x = (parseFloat(sstyle.left) / 100) * this.runtime.stageWidth;
                    width = this._clamp(Number(args.text), 0, this.runtime.stageWidth - x);
                    width = (width / this.runtime.stageWidth) * 100;
                    sstyle.width = `${Number(width)}%`;
                    break;
                case "height":
                    y = (parseFloat(sstyle.top) / 100) * this.runtime.stageHeight;
                    height = this._clamp(Number(args.text), 0, this.runtime.stageHeight - y);
                    height = (height / this.runtime.stageHeight) * 100;
                    sstyle.height = `${Number(height)}%`;
                    break;
                case "content":
                    search.innerHTML = new bbcode.Parser().toHTML(String(args.text));
                    search.setAttribute("name", args.text);
                    break;
                default:
                    break;
            }
        }
    }

    /**
     * 设置字体
     * @param {object} args 
     * @param {string} args.id ID
     * @param {string} args.name 要设置的字体
     */
    setfont(args) {
        let search = null;
        let search_1 = document.getElementById("WitCatBBcode" + args.id);
        if (search_1 instanceof HTMLDivElement) {
            search = search_1;
        }
        search.style.fontFamily = `"${args.name}"`;
    }

    /**
     * 设置代码框高亮
     * @param {object} args 
     */
    code(args) {
        let search = null;
        let search_1 = document.getElementById("WitCatBBcode" + args.id);
        if (search_1 instanceof HTMLDivElement) {
            search = search_1;
        }
        if (search !== null) {
            if (search.getElementsByTagName("code").length > args.num - 1 && args.num > 0) {
                search.getElementsByTagName("code")[args.num - 1].className = args.name;
                prism();
            }
        }
    }

    /**
     * 加载字体
     * @param {object} args 
     * @param {string} args.id ID
     * @param {string} args.name 要获取的字体
     */
    loadfont(args) {
        if (
            String(args.text).startsWith("https://m.ccw.site") ||
            String(args.text).startsWith("https://m.xiguacity")) {
            const xhr = new XMLHttpRequest(); // 定义一个异步对象
            xhr.open("GET", String(args.text), true); // 异步GET方式加载字体
            xhr.responseType = "arraybuffer"; // 把异步获取类型改为arraybuffer二进制类型
            xhr.onload = function () {
                document.fonts.add(new FontFace(String(args.name), this.response)); // 将字体对象添加到页面中
            };
            xhr.send();
        }
        else {
            console.warn("不允许的链接\nDisallowed links")
        }
    }

    /**
     * 获取代码返回值
     * @param {Object} args
     */
    get(args) {
        if (this.canvas() === null || this.inputParent() === null) {
            return;
        }
        let search = null;
        let search_1 = document.getElementById("WitCatBBcode" + args.id);
        if (search_1 instanceof HTMLDivElement) {
            search = search_1;
        }
        if (search !== null) {
            return this._getattrib(search, args.type);
        }
    }

    /**
     * 删除文本框
     * @param {Object} args 
     * @returns 
     */
    delete(args) {
        if (this.inputParent() === null) {
            return;
        }
        let search = document.getElementById("WitCatBBcode" + args.id);
        if (search !== null) {
            this.inputParent().removeChild(search);
        }
    }

    /**
     * 删除所有文本框
     * @param {Object} args 
     * @returns 
     */
    deleteall() {
        if (this.inputParent() === null) {
            return;
        }
        let search = document.getElementsByClassName("WitCatBBcode");
        for (const item of Array.from(search)) {
            this.inputParent().removeChild(item);
        }
    }

    /**
     * 获取示例BBcode
     * @returns {string}
     */
    docss() {
        return this.formatMessage('WitCatBBcode.tutorial');
    }

    /**
     * 获取文本框的属性
     * @param {Element} element 文本框元素
     * @param {string} type 属性类型
     * @returns {number|string}
     */
    _getattrib(element, type) {
        // 用于通过类型检查，确保不出错
        if (!(element instanceof HTMLDivElement)) {
            console.warn("Input.js: 获取到的元素的类型不正确: ", element);
            return "";
        }
        switch (type) {
            case "x":
                return parseFloat(element.style.left) / 100 * this.runtime.stageWidth;
            case "y":
                return parseFloat(element.style.top) / 100 * this.runtime.stageHeight;
            case "width":
                return parseFloat(element.style.width) / 100 * this.runtime.stageWidth;
            case "height":
                return parseFloat(element.style.height) / 100 * this.runtime.stageHeight;
            case "content":
                return element.getAttribute("name");
            case "json":
                // 直接把整个东西转成 JSON 对象，再拼接
                return JSON.stringify(
                    {
                        X: this._getattrib(element, "x"),
                        Y: this._getattrib(element, "y"),
                        width: this._getattrib(element, "width"),
                        height: this._getattrib(element, "height"),
                        content: this._getattrib(element, "content"),
                    }
                )
            default:
                return "";
        }
    }
}

window.tempExt = {
    Extension: WitCatBBcode,
    info: {
        name: "WitCatBBcode.name",
        description: "WitCatBBcode.descp",
        extensionId: witcat_BBcode_extensionId,
        iconURL: witcat_BBcode_picture,
        insetIconURL: witcat_BBcode_icon,
        featured: true,
        disabled: false,
        collaborator: "白猫 @ CCW"
    },
    l10n: {
        "zh-cn": {
            "WitCatBBcode.name": "[beta]白猫的BBcode",
            "WitCatBBcode.descp": "更优雅的文本框"
        },
        en: {
            "WitCatBBcode.name": "[beta]WitCat’s BBcode",
            "WitCatBBcode.descp": "Make your text box more colorful"
        }
    }
};

//以下代码来自github
// Generated by CoffeeScript 1.9.1
(function () {
    this.bbcode = {};

    if ("undefined" !== typeof module) {
        module.exports = this.bbcode;
    }

}).call(this);
// Generated by CoffeeScript 1.9.1
(function () {
    var _COSMETIC_DICT, _COSMETIC_RE, _ESCAPE_DICT, _ESCAPE_RE, _URL_RE, bbcode, key,
        slice = [].slice;

    _ESCAPE_RE = /[&<>"]/g;

    _ESCAPE_DICT = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;'
    };

    _URL_RE = /\b((?:([\w-]+):(\/{1,3})|www[.])(?:(?:(?:[^\s&()]|&amp;|&quot;)*(?:[^!"#$%&'()*+,.:;<=>?@\[\]^`{|}~\s]))|(?:\((?:[^\s&()]|&amp;|&quot;)*\)))+)/g;

    _COSMETIC_DICT = {
        '--': '&ndash;',
        '---': '&mdash;',
        '...': '&#8230;',
        '(c)': '&copy;',
        '(reg)': '&reg;',
        '(tm)': '&trade;'
    };

    _COSMETIC_RE = new RegExp(((function () {
        var results;
        results = [];
        for (key in _COSMETIC_DICT) {
            results.push(key.replace(/(\.|\)|\()/g, '\\$1'));
        }
        return results;
    })()).join('|'));

    bbcode = this.bbcode;

    this.bbcode.Renderer = (function () {
        function Renderer(options) {
            options = options || {};

            this._contexts = [];
            this.options = {
                linkify: !!options.linkify
            };
        }

        Renderer.prototype.context = function (context, func) {
            var k, newOptions, ref, v;
            newOptions = {};
            ref = this.options;
            for (k in ref) {
                v = ref[k];
                newOptions[k] = v;
            }
            for (k in context) {
                v = context[k];
                newOptions[k] = v;
            }
            this._contexts.push(this.options);
            this.options = newOptions;
            v = func();
            this.options = this._contexts.pop();
            return v;
        };

        Renderer.prototype.escape = function (value) {
            return value.replace(_ESCAPE_RE, function (match) {
                return _ESCAPE_DICT[match];
            });
        };

        Renderer.prototype.linkify = function (value) {
            return value.replace(_URL_RE, function () {
                var href, match, proto, url;
                match = 1 <= arguments.length ? slice.call(arguments, 0) : [];
                url = match[1];
                proto = match[2];
                if (proto && (proto !== 'http' && proto !== 'https')) {
                    return url;
                }
                href = match[1];
                if (!proto) {
                    href = 'http://' + href;
                }
                return "<a href=\"" + href + "\" target=\"_blank\">" + url + "</a>";
            });
        };

        Renderer.prototype.strip = function (text) {
            return text.replace(/^\s+|\s+$/g, '');
        };

        Renderer.prototype.cosmeticReplace = function (value) {
            return value.replace(_COSMETIC_RE, function () {
                var item, match;
                match = 1 <= arguments.length ? slice.call(arguments, 0) : [];
                item = match[0];
                return _COSMETIC_DICT[item] || item;
            });
        };

        Renderer.prototype.htmlAttributes = function (attributes) {
            var k, v;
            if (!attributes) {
                return '';
            }
            return ((function () {
                var results;
                results = [];
                for (k in attributes) {
                    v = attributes[k];
                    results.push(k + "=\"" + v + "\"");
                }
                return results;
            })()).join(' ');
        };

        return Renderer;

    })();

}).call(this);
// Generated by CoffeeScript 1.9.1
(function () {
    var CenterTag, CodeTag, ColorTag, HorizontalRuleTag, ImageTag, LinkTag, ListItemTag, ListTag, QuoteTag, RightTag, SizeTag, _LINE_BREAK, _NEWLINE_RE, bbcode,
        indexOf = [].indexOf || function (item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },
        extend = function (child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
        hasProp = {}.hasOwnProperty;

    _NEWLINE_RE = /\r?\n/g;

    _LINE_BREAK = '<br />';

    bbcode = this.bbcode;

    this.bbcode.Tag = (function () {
        function Tag(renderer, settings) {
            var i, key, len, ref, ref1, value;
            this.renderer = renderer;
            if (settings == null) {
                settings = {};
            }
            this.CLOSED_BY = [];
            this.SELF_CLOSE = false;
            this.STRIP_INNER = false;
            this.STRIP_OUTER = false;
            this.DISCARD_TEXT = false;
            this.name = settings['name'] || null;
            this.parent = settings['parent'] || null;
            this.text = settings['text'] || '';
            if (this.parent) {
                this.parent.children.push(this);
            }
            if (settings['params'] == null) {
                settings['params'] = [];
            }
            this.params = {};
            ref = settings['params'];
            for (i = 0, len = ref.length; i < len; i++) {
                ref1 = ref[i], key = ref1[0], value = ref1[1];
                if (value) {
                    this.params[key] = value;
                }
            }
            this.children = [];
        }

        Tag.prototype.getContent = function (raw) {
            var child, children, content, i, len, pieces, text;
            if (raw == null) {
                raw = false;
            }
            pieces = [];
            if (this.text) {
                text = this.renderer.escape(this.text);
                if (!raw) {
                    if (this.renderer.options['linkify']) {
                        text = this.renderer.linkify(text);
                    }
                    text = this.renderer.cosmeticReplace(text.replace(_NEWLINE_RE, _LINE_BREAK));
                }
                pieces.push(text);
            }
            children = this.children;
            for (i = 0, len = children.length; i < len; i++) {
                child = children[i];
                if (raw) {
                    pieces.push(child.toText());
                } else {
                    if (this.DISCARD_TEXT && child.name === null) {
                        continue;
                    }
                    pieces.push(child.toHTML());
                }
            }
            content = pieces.join('');
            if (!raw && this.STRIP_INNER) {
                content = this.renderer.strip(content);
                while (content.slice(0, _LINE_BREAK.length) === _LINE_BREAK) {
                    content = content.slice(_LINE_BREAK.length);
                }
                while (content.slice(-_LINE_BREAK.length) === _LINE_BREAK) {
                    content = content.slice(0, -_LINE_BREAK.length);
                }
                content = this.renderer.strip(content);
            }
            return content;
        };

        Tag.prototype.toText = function (contentAsHTML) {
            var k, params, pieces, ref, v;
            if (contentAsHTML == null) {
                contentAsHTML = false;
            }
            pieces = [];
            if (this.name !== null) {
                if (this.params.length) {
                    params = ((function () {
                        var ref, results;
                        ref = this.params;
                        results = [];
                        for (k in ref) {
                            v = ref[k];
                            results.push([k, v].join('='));
                        }
                        return results;
                    }).call(this)).join(' ');
                    if (this.name in this.params) {
                        pieces.push("[" + params + "]");
                    } else {
                        pieces.push("[" + this.name + " " + params + "]");
                    }
                } else {
                    pieces.push("[" + this.name + "]");
                }
            }
            pieces.push(this.getContent(!contentAsHTML));
            if (this.name !== null && (ref = this.name, indexOf.call(this.CLOSED_BY, ref) < 0)) {
                pieces.push("[/" + this.name + "]");
            }
            return pieces.join('');
        };

        Tag.prototype._toHTML = function () {
            return this.toText(true);
        };

        Tag.prototype.toHTML = function () {
            var pieces;
            pieces = this._toHTML();
            if (typeof pieces === 'string') {
                return pieces;
            } else {
                return pieces.join('');
            }
        };

        return Tag;

    })();

    CodeTag = (function (superClass) {
        extend(CodeTag, superClass);

        function CodeTag() {
            CodeTag.__super__.constructor.apply(this, arguments);
            this.STRIP_INNER = true;
            this._inline = this.params['code'] === 'inline';
            if (!this._inline) {
                this.STRIP_OUTER = true;
            }
        }

        CodeTag.prototype._toHTML = function () {
            var lang;
            lang = this.params['lang'] || this.params[this.name];
            if (lang) {
                return ["<pre class=\"prettyprint lang-" + lang + "\" style=\"background: none;\"><code>", this.getContent(true), '</code></pre>'];
            } else {
                return ['<pre style="background: none;"><code class="language-javascript">', this.getContent(true), '</code></pre>'];
            }
        };

        return CodeTag;

    })(this.bbcode.Tag);

    ImageTag = (function (superClass) {
        extend(ImageTag, superClass);

        function ImageTag() {
            return ImageTag.__super__.constructor.apply(this, arguments);
        }

        ImageTag.prototype._toHTML = function () {
            var attributes;
            attributes = {
                src: this.renderer.strip(this.getContent(true))
            };
            if ('width' in this.params) {
                attributes['width'] = this.params['width'];
            }
            if ('height' in this.params) {
                attributes['height'] = this.params['height'];
            }
            return "<img " + (this.renderer.htmlAttributes(attributes)) + " />";
        };

        return ImageTag;

    })(this.bbcode.Tag);

    SizeTag = (function (superClass) {
        extend(SizeTag, superClass);

        function SizeTag() {
            return SizeTag.__super__.constructor.apply(this, arguments);
        }

        SizeTag.prototype._toHTML = function () {
            var size;
            size = this.params['size'];
            if (isNaN(size)) {
                return this.getContent();
            } else {
                return ["<span style=\"font-size:" + size + "px\">", this.getContent(), '</span>'];
            }
        };

        return SizeTag;

    })(this.bbcode.Tag);

    ColorTag = (function (superClass) {
        extend(ColorTag, superClass);

        function ColorTag() {
            return ColorTag.__super__.constructor.apply(this, arguments);
        }

        ColorTag.prototype._toHTML = function () {
            var color;
            color = this.params['color'];
            if (color != null) {
                return ["<span style=\"color:" + color + "\">", this.getContent(), '</span>'];
            } else {
                return this.getContent();
            }
        };

        return ColorTag;

    })(this.bbcode.Tag);

    CenterTag = (function (superClass) {
        extend(CenterTag, superClass);

        function CenterTag() {
            return CenterTag.__super__.constructor.apply(this, arguments);
        }

        CenterTag.prototype._toHTML = function () {
            return ['<div style="text-align:center;">', this.getContent(), '</div>'];
        };

        return CenterTag;

    })(this.bbcode.Tag);

    RightTag = (function (superClass) {
        extend(RightTag, superClass);

        function RightTag() {
            return RightTag.__super__.constructor.apply(this, arguments);
        }

        RightTag.prototype._toHTML = function () {
            return ['<div style="float:right;">', this.getContent(), '</div>'];
        };

        return RightTag;

    })(this.bbcode.Tag);

    HorizontalRuleTag = (function (superClass) {
        extend(HorizontalRuleTag, superClass);

        function HorizontalRuleTag() {
            HorizontalRuleTag.__super__.constructor.apply(this, arguments);
            this.SELF_CLOSE = true;
            this.STRIP_OUTER = true;
        }

        HorizontalRuleTag.prototype._toHTML = function () {
            return '<hr />';
        };

        return HorizontalRuleTag;

    })(this.bbcode.Tag);

    ListTag = (function (superClass) {
        extend(ListTag, superClass);

        function ListTag() {
            ListTag.__super__.constructor.apply(this, arguments);
            this.STRIP_INNER = true;
            this.STRIP_OUTER = true;
        }

        ListTag.prototype._toHTML = function () {
            var listType;
            listType = this.params['list'];
            if (listType === '1') {
                return ['<ol>', this.getContent(), '</ol>'];
            } else if (listType === 'a') {
                return ['<ol style="list-style-type:lower-alpha;">', this.getContent(), '</ol>'];
            } else if (listType === 'A') {
                return ['<ol style="list-style-type:upper-alpha;">', this.getContent(), '</ol>'];
            } else {
                return ['<ul>', this.getContent(), '</ul>'];
            }
        };

        return ListTag;

    })(this.bbcode.Tag);

    ListItemTag = (function (superClass) {
        extend(ListItemTag, superClass);

        function ListItemTag() {
            ListItemTag.__super__.constructor.apply(this, arguments);
            this.CLOSED_BY = ['*', '/list'];
            this.STRIP_INNER = true;
        }

        ListItemTag.prototype._toHTML = function () {
            return ['<li>', this.getContent(), '</li>'];
        };

        return ListItemTag;

    })(this.bbcode.Tag);

    QuoteTag = (function (superClass) {
        extend(QuoteTag, superClass);

        function QuoteTag() {
            QuoteTag.__super__.constructor.apply(this, arguments);
            this.STRIP_INNER = true;
            this.STRIP_OUTER = true;
        }

        QuoteTag.prototype._toHTML = function () {
            var citation, pieces;
            pieces = ['<blockquote>', this.getContent()];
            citation = this.params['quote'];
            if (citation) {
                pieces.push('<small>');
                pieces.push(citation);
                pieces.push('</small>');
            }
            pieces.push('</blockquote>');
            return pieces;
        };

        return QuoteTag;

    })(this.bbcode.Tag);

    LinkTag = (function (superClass) {
        extend(LinkTag, superClass);

        function LinkTag() {
            return LinkTag.__super__.constructor.apply(this, arguments);
        }

        LinkTag.prototype._toHTML = function () {
            var url;
            url = this.renderer.strip(this.params[this.name] || this.getContent(true));
            if (/javascript:/i.test(url)) {
                url = '';
            }
            if (url) {
                return this.renderer.context({
                    'linkify': false
                }, (function (_this) {
                    return function () {
                        return ["<a href=\"" + url + "\" target=\"_blank\">", _this.getContent(), '</a>'];
                    };
                })(this));
            } else {
                return this.getContent();
            }
        };

        return LinkTag;

    })(this.bbcode.Tag);

    this.bbcode.createSimpleTag = (function (_this) {
        return function (name, attributes) {
            var SimpleTag;
            return SimpleTag = (function (superClass) {
                extend(SimpleTag, superClass);

                function SimpleTag() {
                    var k, v;
                    SimpleTag.__super__.constructor.apply(this, arguments);
                    for (k in attributes) {
                        v = attributes[k];
                        this[k] = v;
                    }
                }

                SimpleTag.prototype._toHTML = function () {
                    var htmlAttributes;
                    htmlAttributes = this.renderer.htmlAttributes(this.params);
                    if (htmlAttributes) {
                        htmlAttributes = ' ' + htmlAttributes;
                    }
                    return ["<" + name + htmlAttributes + ">", this.getContent(), "</" + name + ">"];
                };

                return SimpleTag;

            })(_this.bbcode.Tag);
        };
    })(this);

    this.bbcode.BUILTIN = {
        b: this.bbcode.createSimpleTag('strong'),
        i: this.bbcode.createSimpleTag('em'),
        u: this.bbcode.createSimpleTag('u'),
        s: this.bbcode.createSimpleTag('strike'),
        h1: this.bbcode.createSimpleTag('h1', {
            STRIP_OUTER: true
        }),
        h2: this.bbcode.createSimpleTag('h2', {
            STRIP_OUTER: true
        }),
        h3: this.bbcode.createSimpleTag('h3', {
            STRIP_OUTER: true
        }),
        h4: this.bbcode.createSimpleTag('h4', {
            STRIP_OUTER: true
        }),
        h5: this.bbcode.createSimpleTag('h5', {
            STRIP_OUTER: true
        }),
        h6: this.bbcode.createSimpleTag('h6', {
            STRIP_OUTER: true
        }),
        pre: this.bbcode.createSimpleTag('pre'),
        table: this.bbcode.createSimpleTag('table', {
            DISCARD_TEXT: true
        }),
        thead: this.bbcode.createSimpleTag('thead', {
            DISCARD_TEXT: true
        }),
        tbody: this.bbcode.createSimpleTag('tbody', {
            DISCARD_TEXT: true
        }),
        tr: this.bbcode.createSimpleTag('tr', {
            DISCARD_TEXT: true
        }),
        th: this.bbcode.createSimpleTag('th'),
        td: this.bbcode.createSimpleTag('td'),
        code: CodeTag,
        img: ImageTag,
        hr: HorizontalRuleTag,
        size: SizeTag,
        center: CenterTag,
        right: RightTag,
        color: ColorTag,
        list: ListTag,
        '*': ListItemTag,
        quote: QuoteTag,
        url: LinkTag,
        link: LinkTag
    };

}).call(this);
// Generated by CoffeeScript 1.9.1
(function () {
    var _SPACE_RE, _START_NEWLINE_RE, _TOKEN_RE, bbcode,
        indexOf = [].indexOf || function (item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

    _SPACE_RE = /^\s*$/;

    _TOKEN_RE = /(\[\/?.+?\])/;

    _START_NEWLINE_RE = /^\r?\n/;

    bbcode = this.bbcode;

    this.bbcode.Parser = (function () {
        function Parser(allowedTags) {
            var i, len, name, ref, tag;
            if (allowedTags == null) {
                allowedTags = null;
            }
            this.tags = {};
            if (!allowedTags) {
                ref = bbcode.BUILTIN;
                for (name in ref) {
                    tag = ref[name];
                    this.registerTag(name, tag);
                }
            } else {
                for (i = 0, len = allowedTags.length; i < len; i++) {
                    name = allowedTags[i];
                    if (indexOf.call(bbcode.BUILTIN, name) >= 0) {
                        this.registerTag(name, bbcode.BUILTIN[name]);
                    }
                }
            }
            this.renderer = new bbcode.Renderer();
        }

        Parser.prototype.registerTag = function (name, tag) {
            return this.tags[name] = tag;
        };

        Parser.prototype._parseParams = function (token) {
            var c, i, key, len, params, skipNext, target, terminate, value;
            params = [];
            if (token) {
                target = key = [];
                value = [];
                terminate = ' ';
                skipNext = false;
                for (i = 0, len = token.length; i < len; i++) {
                    c = token[i];
                    if (skipNext) {
                        skipNext = false;
                    } else if (target === key && c === '=') {
                        target = value;
                    } else if (target === key && c === ':') {
                        target = value;
                    } else if (!value.length && c === '"') {
                        terminate = c;
                    } else if (c !== terminate) {
                        target.push(c);
                    } else {
                        params.push([key.join('').toLowerCase(), value.join('')]);
                        if (!_SPACE_RE.test(terminate)) {
                            skipNext = true;
                        }
                        target = key = [];
                        value = [];
                        terminate = ' ';
                    }
                }
                params.push([key.join('').toLowerCase(), value.join('')]);
            }
            return params;
        };

        Parser.prototype._createTextNode = function (parent, text) {
            var ref;
            if ((ref = parent.children.slice(-1)[0]) != null ? ref.STRIP_OUTER : void 0) {
                text = text.replace(_START_NEWLINE_RE, '');
            }
            return new bbcode.Tag(this.renderer, {
                text: text,
                parent: parent
            });
        };

        Parser.prototype.parse = function (input) {
            var cls, current, params, root, tag, tagName, token, tokens;
            current = root = new bbcode.Tag(this.renderer);
            tokens = input.split(_TOKEN_RE);
            while (tokens.length) {
                token = tokens.shift();
                if (token.match(_TOKEN_RE)) {
                    params = this._parseParams(token.slice(1, -1));
                    tagName = params[0][0];
                    if (indexOf.call(current.CLOSED_BY, tagName) >= 0) {
                        tokens.unshift(token);
                        tagName = '/' + current.name;
                        params = [];
                    }
                    if (tagName[0] === '/') {
                        tagName = tagName.slice(1);
                        if (!(tagName in this.tags)) {
                            this._createTextNode(current, token);
                            continue;
                        }
                        if (current.name === tagName) {
                            current = current.parent;
                        }
                    } else {
                        cls = this.tags[tagName];
                        if (!cls) {
                            this._createTextNode(current, token);
                            continue;
                        }
                        tag = new cls(this.renderer, {
                            name: tagName,
                            parent: current,
                            params: params
                        });
                        if (!tag.SELF_CLOSE && (indexOf.call(tag.CLOSED_BY, tagName) < 0 || current.name !== tagName)) {
                            current = tag;
                        }
                    }
                } else {
                    this._createTextNode(current, token);
                }
            }
            return root;
        };

        Parser.prototype.toHTML = function (input) {
            var html;
            return html = this.parse(input).toHTML();
        };

        return Parser;

    })();

}).call(this);
// Generated by CoffeeScript 1.9.1
(function () {
    var MARKUP, bbcode;

    bbcode = this.bbcode;

    MARKUP = {
        bold: {
            keyCode: 66,
            title: 'Bold (Ctrl+B)',
            placeholder: 'bold text',
            open: '[b]',
            close: '[/b]'
        },
        italic: {
            keyCode: 73,
            title: 'Italic (Ctrl+I)',
            placeholder: 'italic text',
            open: '[i]',
            close: '[/i]'
        },
        center: {
            keyCode: 69,
            title: 'Center (Ctrl+E)',
            placeholder: 'center text',
            open: '[center]',
            close: '[/center]'
        },
        hyperlink: {
            keyCode: 76,
            title: 'Hyperlink (Ctrl+L)',
            placeholder: 'link text',
            open: function () {
                var url;
                url = prompt('Please enter the URL of your link', 'http://') || 'link url';
                return "[url=" + url + "]";
            },
            close: '[/url]'
        },
        blockquote: {
            keyCode: 190,
            title: 'Blockquote (Ctrl+.)',
            placeholder: 'blockquote',
            open: '[quote]',
            close: '[/quote]'
        },
        code: {
            keyCode: 76,
            title: 'Code (Ctrl+K)',
            placeholder: 'print("code sample");',
            open: '[code]',
            close: '[/code]'
        },
        image: {
            keyCode: 71,
            placeholder: 'image url',
            open: '[img]',
            close: '[/img]'
        },
        nlist: {
            keyCode: 79,
            title: 'Numbered List (Ctrl+O)',
            placeholder: 'list item',
            open: function (value) {
                var close, open, ref, ref1;
                open = ((ref = value.match(/\[list=1\]/g)) != null ? ref.length : void 0) || 0;
                close = ((ref1 = value.match(/\[\/list\]/g)) != null ? ref1.length : void 0) || 0;
                if (open === close) {
                    return '[list=1]\n\t[*]';
                }
                return '\t[*]';
            },
            close: function (value) {
                var close, open, ref, ref1;
                open = ((ref = value.match(/\[list=1\]/g)) != null ? ref.length : void 0) || 0;
                close = ((ref1 = value.match(/\[\/list\]/g)) != null ? ref1.length : void 0) || 0;
                if (open === close) {
                    return '\n[/list]';
                }
            }
        },
        list: {
            keyCode: 85,
            title: 'Bulleted List (Ctrl+O)',
            placeholder: 'list item',
            open: function (value) {
                var close, open, ref, ref1;
                open = ((ref = value.match(/\[list\]/g)) != null ? ref.length : void 0) || 0;
                close = ((ref1 = value.match(/\[\/list\]/g)) != null ? ref1.length : void 0) || 0;
                if (open === close) {
                    return '[list]\n\t[*]';
                }
                return '\t[*]';
            },
            close: function (value) {
                var close, open, ref, ref1;
                open = ((ref = value.match(/\[list\]/g)) != null ? ref.length : void 0) || 0;
                close = ((ref1 = value.match(/\[\/list\]/g)) != null ? ref1.length : void 0) || 0;
                if (open === close) {
                    return '\n[/list]';
                }
            }
        },
        heading: {
            keyCode: 72,
            title: 'Heading (Ctrl+H)',
            placeholder: 'heading',
            open: '[h3]',
            close: '[/h3]',
            before: /\n$/,
            after: /^\n/
        },
        hrule: {
            keyCode: 82,
            title: 'Hprizontal Rule (Ctrl+R)',
            open: '[hr]\n',
            before: /\n\n$/,
            after: /^\n\n/
        }
    };

    this.bbcode.Editor = (function () {
        function Editor(textarea, markup) {
            this.markup = markup != null ? markup : MARKUP;
            this.$ = $(textarea);
            this.textarea = this.$[0];
            this.$.on('keydown', (function (_this) {
                return function (e) {
                    var end, i, len, length, line, lines, offset, ref, ref1, ref2, ref3, selection, start, tab;
                    if (e.which === 9) {
                        selection = _this.getSelection();
                        offset = 0;
                        if (selection.start === selection.end && !e.shiftKey) {
                            offset++;
                            selection.value[1] = "\t" + selection.value[1];
                            _this.setValue(selection.value.join(''));
                        } else {
                            length = 0;
                            tab = false;
                            lines = [];
                            ref = _this.textarea.value.split('\n');
                            for (i = 0, len = ref.length; i < len; i++) {
                                line = ref[i];
                                ref1 = [length, length += line.length + 1], start = ref1[0], end = ref1[1];
                                if (!tab && (start <= (ref2 = selection.start) && ref2 < end)) {
                                    tab = true;
                                }
                                if (tab) {
                                    if (e.shiftKey) {
                                        if (line[0] === '\t') {
                                            line = line.slice(1);
                                            offset--;
                                        }
                                    } else {
                                        line = "\t" + line;
                                        offset++;
                                    }
                                    tab = !((start <= (ref3 = selection.end) && ref3 <= end));
                                }
                                lines.push(line);
                            }
                            _this.setValue(lines.join('\n'));
                        }
                        if (offset > 0) {
                            selection.start++;
                        } else if (offset < 0) {
                            selection.start--;
                        }
                        _this.select(selection.start, selection.end + offset);
                    } else if (!e.ctrlKey || e.altKey || (_this.getRule(e.which) == null)) {
                        return true;
                    } else {
                        _this.replace(e.which);
                    }
                    return false;
                };
            })(this));
        }

        Editor.prototype._escapeRe = function (pattern) {
            var escaped, special;
            special = ['/', '.', '*', '+', '?', '|', '(', ')', '[', ']', '{', '}', '\\', '^', '$'];
            escaped = pattern.replace(new RegExp('(\\' + special.join('|\\') + ')', 'g'), '\\$1');
            return new RegExp('^' + escaped.replace(/\d+/, '\\d+') + '$');
        };

        Editor.prototype.getRule = function (keyCode) {
            var key, ref, rule;
            ref = this.markup;
            for (key in ref) {
                rule = ref[key];
                if (rule.keyCode === keyCode) {
                    return rule;
                }
            }
        };

        Editor.prototype.replace = function (keyCode, value, text) {
            var close, open, replacement, rule, selection, start;
            this.$.focus();
            selection = this.getSelection();
            rule = this.getRule(keyCode);
            value = this.textarea.value;
            open = (typeof rule.open === 'function' ? rule.open(selection.value[0]) : rule.open) || '';
            close = (typeof rule.close === 'function' ? rule.close(selection.value[2]) : rule.close) || '';
            if (this._escapeRe(open).test(value.slice(selection.start - open.length, selection.start)) && this._escapeRe(close).test(value.slice(selection.end, selection.end + close.length))) {
                start = selection.start - open.length;
                this.setValue(value.substr(0, start) + selection.value[1] + value.substr(selection.end + close.length, value.length));
                return this.select(start, start + selection.value[1].length);
            } else {
                replacement = open + (text || selection.value[1] || rule.placeholder || '') + close;
                if ((rule.before != null) && !rule.before.test(selection.value[0])) {
                    replacement = "\n\n" + replacement;
                    selection.start += 2;
                }
                if ((rule.after != null) && !rule.after.test(selection.value[2])) {
                    replacement += '\n\n';
                    selection.end += 2;
                }
                this.setValue(selection.value[0] + replacement + selection.value[2]);
                return this.select(selection.start + open.length, selection.start + replacement.length - close.length);
            }
        };

        Editor.prototype.setValue = function (value) {
            var position;
            position = this.$.scrollTop();
            this.$.val(value);
            return this.$.scrollTop(position);
        };

        Editor.prototype.select = function (start, end) {
            var range, ref;
            if (((ref = document.selection) != null ? ref.createRange : void 0) != null) {
                range = this.textarea.createTextRange();
                range.collapse(true);
                range.moveStart('character', start);
                range.moveEnd('character', end - start);
                return range.select();
            } else {
                this.textarea.selectionStart = start;
                return this.textarea.selectionEnd = end;
            }
        };

        Editor.prototype.getSelection = function () {
            var close, end, open, range, ref, selection, start, storedRange, value;
            value = this.textarea.value;
            if (((ref = document.selection) != null ? ref.createRange : void 0) != null) {
                selection = document.selection;
                if (!/testarea/i.test(this.textarea.tagName)) {
                    range = selection.createRange().duplicate();
                    range.moveEnd('character', value.length);
                    start = range.text === '' ? value.length : value.lastIndexOf(range.text);
                    range = selection.createRange().duplicate();
                    range.moveStart('character', -value.length);
                    end = range.text.length + 1;
                } else {
                    range = selection.createRange();
                    storedRange = range.duplicate();
                    storedRange.moveToElementText(this.textarea);
                    storedRange.setEndPoint('EndToEnd', range);
                    start = storedRange.text.length - range.text.length;
                    end = start + range.text.length;
                }
            } else {
                start = this.textarea.selectionStart;
                end = this.textarea.selectionEnd;
            }
            open = value.substring(0, start);
            close = value.substring(end, value.length);
            return selection = {
                start: start,
                end: end,
                value: [open, value.substring(start, end), close]
            };
        };

        return Editor;

    })();

}).call(this);

//以下为https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism.min.css（代码高亮）

prism = () => {
    var _self = "undefined" != typeof window ? window : "undefined" != typeof WorkerGlobalScope && self instanceof WorkerGlobalScope ? self : {},
        Prism = function (o) {
            var u = /\blang(?:uage)?-([\w-]+)\b/i,
                t = 0,
                e = {},
                j = {
                    manual: o.Prism && o.Prism.manual,
                    disableWorkerMessageHandler: o.Prism && o.Prism.disableWorkerMessageHandler,
                    util: {
                        encode: function e(t) {
                            return t instanceof C ? new C(t.type, e(t.content), t.alias) : Array.isArray(t) ? t.map(e) : t.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/\u00a0/g, " ")
                        },
                        type: function (e) {
                            return Object.prototype.toString.call(e).slice(8, -1)
                        },
                        objId: function (e) {
                            return e.__id || Object.defineProperty(e, "__id", {
                                value: ++t
                            }), e.__id
                        },
                        clone: function n(e, a) {
                            var r, t;
                            switch (a = a || {}, j.util.type(e)) {
                                case "Object":
                                    if (t = j.util.objId(e), a[t]) return a[t];
                                    for (var s in r = {}, a[t] = r, e) e.hasOwnProperty(s) && (r[s] = n(e[s], a));
                                    return r;
                                case "Array":
                                    return (t = j.util.objId(e), a[t]) ? a[t] : (r = [], a[t] = r, e.forEach(function (e, t) {
                                        r[t] = n(e, a)
                                    }), r);
                                default:
                                    return e
                            }
                        },
                        getLanguage: function (e) {
                            for (; e && !u.test(e.className);) e = e.parentElement;
                            return e ? (e.className.match(u) || [, "none"])[1].toLowerCase() : "none"
                        },
                        currentScript: function () {
                            if ("undefined" == typeof document) return null;
                            if ("currentScript" in document) return document.currentScript;
                            try {
                                throw new Error
                            } catch (e) {
                                var t = (/at [^(\r\n]*\((.*):.+:.+\)$/i.exec(e.stack) || [])[1];
                                if (t) {
                                    var n, a = document.getElementsByTagName("script");
                                    for (n in a)
                                        if (a[n].src == t) return a[n]
                                }
                                return null
                            }
                        },
                        isActive: function (e, t, n) {
                            for (var a = "no-" + t; e;) {
                                var r = e.classList;
                                if (r.contains(t)) return !0;
                                if (r.contains(a)) return !1;
                                e = e.parentElement
                            }
                            return !!n
                        }
                    },
                    languages: {
                        plain: e,
                        plaintext: e,
                        text: e,
                        txt: e,
                        extend: function (e, t) {
                            var n, a = j.util.clone(j.languages[e]);
                            for (n in t) a[n] = t[n];
                            return a
                        },
                        insertBefore: function (n, e, t, a) {
                            var r, s = (a = a || j.languages)[n],
                                i = {};
                            for (r in s)
                                if (s.hasOwnProperty(r)) {
                                    if (r == e)
                                        for (var l in t) t.hasOwnProperty(l) && (i[l] = t[l]);
                                    t.hasOwnProperty(r) || (i[r] = s[r])
                                } var o = a[n];
                            return a[n] = i, j.languages.DFS(j.languages, function (e, t) {
                                t === o && e != n && (this[e] = i)
                            }), i
                        },
                        DFS: function e(t, n, a, r) {
                            r = r || {};
                            var s, i, l, o = j.util.objId;
                            for (s in t) t.hasOwnProperty(s) && (n.call(t, s, t[s], a || s), i = t[s], "Object" !== (l = j.util.type(i)) || r[o(i)] ? "Array" !== l || r[o(i)] || (r[o(i)] = !0, e(i, n, s, r)) : (r[o(i)] = !0, e(i, n, null, r)))
                        }
                    },
                    plugins: {},
                    highlightAll: function (e, t) {
                        j.highlightAllUnder(document, e, t)
                    },
                    highlightAllUnder: function (e, t, n) {
                        var a = {
                            callback: n,
                            container: e,
                            selector: 'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'
                        };
                        j.hooks.run("before-highlightall", a), a.elements = Array.prototype.slice.apply(a.container.querySelectorAll(a.selector)), j.hooks.run("before-all-elements-highlight", a);
                        for (var r, s = 0; r = a.elements[s++];) j.highlightElement(r, !0 === t, a.callback)
                    },
                    highlightElement: function (e, t, n) {
                        var a = j.util.getLanguage(e),
                            r = j.languages[a];
                        e.className = e.className.replace(u, "").replace(/\s+/g, " ") + " language-" + a;
                        var s = e.parentElement;
                        s && "pre" === s.nodeName.toLowerCase() && (s.className = s.className.replace(u, "").replace(/\s+/g, " ") + " language-" + a);
                        var i = {
                            element: e,
                            language: a,
                            grammar: r,
                            code: e.textContent
                        };

                        function l(e) {
                            i.highlightedCode = e, j.hooks.run("before-insert", i), i.element.innerHTML = i.highlightedCode, j.hooks.run("after-highlight", i), j.hooks.run("complete", i), n && n.call(i.element)
                        }
                        if (j.hooks.run("before-sanity-check", i), (s = i.element.parentElement) && "pre" === s.nodeName.toLowerCase() && !s.hasAttribute("tabindex") && s.setAttribute("tabindex", "0"), !i.code) return j.hooks.run("complete", i), void (n && n.call(i.element));
                        j.hooks.run("before-highlight", i), i.grammar ? t && o.Worker ? ((t = new Worker(j.filename)).onmessage = function (e) {
                            l(e.data)
                        }, t.postMessage(JSON.stringify({
                            language: i.language,
                            code: i.code,
                            immediateClose: !0
                        }))) : l(j.highlight(i.code, i.grammar, i.language)) : l(j.util.encode(i.code))
                    },
                    highlight: function (e, t, n) {
                        n = {
                            code: e,
                            grammar: t,
                            language: n
                        };
                        return j.hooks.run("before-tokenize", n), n.tokens = j.tokenize(n.code, n.grammar), j.hooks.run("after-tokenize", n), C.stringify(j.util.encode(n.tokens), n.language)
                    },
                    tokenize: function (e, t) {
                        var n = t.rest;
                        if (n) {
                            for (var a in n) t[a] = n[a];
                            delete t.rest
                        }
                        var r = new s;
                        return z(r, r.head, e),
                            function e(t, n, a, r, s, i) {
                                for (var l in a)
                                    if (a.hasOwnProperty(l) && a[l]) {
                                        var o = a[l];
                                        o = Array.isArray(o) ? o : [o];
                                        for (var u = 0; u < o.length; ++u) {
                                            if (i && i.cause == l + "," + u) return;
                                            var c, g = o[u],
                                                d = g.inside,
                                                p = !!g.lookbehind,
                                                m = !!g.greedy,
                                                h = g.alias;
                                            m && !g.pattern.global && (c = g.pattern.toString().match(/[imsuy]*$/)[0], g.pattern = RegExp(g.pattern.source, c + "g"));
                                            for (var f = g.pattern || g, b = r.next, y = s; b !== n.tail && !(i && y >= i.reach); y += b.value.length, b = b.next) {
                                                var v = b.value;
                                                if (n.length > t.length) return;
                                                if (!(v instanceof C)) {
                                                    var F, k = 1;
                                                    if (m) {
                                                        if (!(F = O(f, y, t, p))) break;
                                                        var x = F.index,
                                                            w = F.index + F[0].length,
                                                            P = y;
                                                        for (P += b.value.length; P <= x;) b = b.next, P += b.value.length;
                                                        if (P -= b.value.length, y = P, b.value instanceof C) continue;
                                                        for (var A = b; A !== n.tail && (P < w || "string" == typeof A.value); A = A.next) k++, P += A.value.length;
                                                        k--, v = t.slice(y, P), F.index -= y
                                                    } else if (!(F = O(f, 0, v, p))) continue;
                                                    var x = F.index,
                                                        $ = F[0],
                                                        S = v.slice(0, x),
                                                        E = v.slice(x + $.length),
                                                        _ = y + v.length;
                                                    i && _ > i.reach && (i.reach = _);
                                                    v = b.prev;
                                                    S && (v = z(n, v, S), y += S.length), T(n, v, k);
                                                    $ = new C(l, d ? j.tokenize($, d) : $, h, $);
                                                    b = z(n, v, $), E && z(n, b, E), 1 < k && (_ = {
                                                        cause: l + "," + u,
                                                        reach: _
                                                    }, e(t, n, a, b.prev, y, _), i && _.reach > i.reach && (i.reach = _.reach))
                                                }
                                            }
                                        }
                                    }
                            }(e, r, t, r.head, 0),
                            function (e) {
                                var t = [],
                                    n = e.head.next;
                                for (; n !== e.tail;) t.push(n.value), n = n.next;
                                return t
                            }(r)
                    },
                    hooks: {
                        all: {},
                        add: function (e, t) {
                            var n = j.hooks.all;
                            n[e] = n[e] || [], n[e].push(t)
                        },
                        run: function (e, t) {
                            var n = j.hooks.all[e];
                            if (n && n.length)
                                for (var a, r = 0; a = n[r++];) a(t)
                        }
                    },
                    Token: C
                };

            function C(e, t, n, a) {
                this.type = e, this.content = t, this.alias = n, this.length = 0 | (a || "").length
            }

            function O(e, t, n, a) {
                e.lastIndex = t;
                n = e.exec(n);
                return n && a && n[1] && (a = n[1].length, n.index += a, n[0] = n[0].slice(a)), n
            }

            function s() {
                var e = {
                    value: null,
                    prev: null,
                    next: null
                },
                    t = {
                        value: null,
                        prev: e,
                        next: null
                    };
                e.next = t, this.head = e, this.tail = t, this.length = 0
            }

            function z(e, t, n) {
                var a = t.next,
                    n = {
                        value: n,
                        prev: t,
                        next: a
                    };
                return t.next = n, a.prev = n, e.length++, n
            }

            function T(e, t, n) {
                for (var a = t.next, r = 0; r < n && a !== e.tail; r++) a = a.next;
                (t.next = a).prev = t, e.length -= r
            }
            if (o.Prism = j, C.stringify = function t(e, n) {
                if ("string" == typeof e) return e;
                if (Array.isArray(e)) {
                    var a = "";
                    return e.forEach(function (e) {
                        a += t(e, n)
                    }), a
                }
                var r = {
                    type: e.type,
                    content: t(e.content, n),
                    tag: "span",
                    classes: ["token", e.type],
                    attributes: {},
                    language: n
                },
                    e = e.alias;
                e && (Array.isArray(e) ? Array.prototype.push.apply(r.classes, e) : r.classes.push(e)), j.hooks.run("wrap", r);
                var s, i = "";
                for (s in r.attributes) i += " " + s + '="' + (r.attributes[s] || "").replace(/"/g, "&quot;") + '"';
                return "<" + r.tag + ' class="' + r.classes.join(" ") + '"' + i + ">" + r.content + "</" + r.tag + ">"
            }, !o.document) return o.addEventListener && (j.disableWorkerMessageHandler || o.addEventListener("message", function (e) {
                var t = JSON.parse(e.data),
                    n = t.language,
                    e = t.code,
                    t = t.immediateClose;
                o.postMessage(j.highlight(e, j.languages[n], n)), t && o.close()
            }, !1)), j;
            var n = j.util.currentScript();

            function a() {
                j.manual || j.highlightAll()
            }
            return n && (j.filename = n.src, n.hasAttribute("data-manual") && (j.manual = !0)), j.manual || ("loading" === (e = document.readyState) || "interactive" === e && n && n.defer ? document.addEventListener("DOMContentLoaded", a) : window.requestAnimationFrame ? window.requestAnimationFrame(a) : window.setTimeout(a, 16)), j
        }(_self);
    "undefined" != typeof module && module.exports && (module.exports = Prism), "undefined" != typeof global && (global.Prism = Prism), Prism.languages.markup = {
        comment: /<!--[\s\S]*?-->/,
        prolog: /<\?[\s\S]+?\?>/,
        doctype: {
            pattern: /<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,
            greedy: !0,
            inside: {
                "internal-subset": {
                    pattern: /(^[^\[]*\[)[\s\S]+(?=\]>$)/,
                    lookbehind: !0,
                    greedy: !0,
                    inside: null
                },
                string: {
                    pattern: /"[^"]*"|'[^']*'/,
                    greedy: !0
                },
                punctuation: /^<!|>$|[[\]]/,
                "doctype-tag": /^DOCTYPE/,
                name: /[^\s<>'"]+/
            }
        },
        cdata: /<!\[CDATA\[[\s\S]*?\]\]>/i,
        tag: {
            pattern: /<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,
            greedy: !0,
            inside: {
                tag: {
                    pattern: /^<\/?[^\s>\/]+/,
                    inside: {
                        punctuation: /^<\/?/,
                        namespace: /^[^\s>\/:]+:/
                    }
                },
                "special-attr": [],
                "attr-value": {
                    pattern: /=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,
                    inside: {
                        punctuation: [{
                            pattern: /^=/,
                            alias: "attr-equals"
                        }, /"|'/]
                    }
                },
                punctuation: /\/?>/,
                "attr-name": {
                    pattern: /[^\s>\/]+/,
                    inside: {
                        namespace: /^[^\s>\/:]+:/
                    }
                }
            }
        },
        entity: [{
            pattern: /&[\da-z]{1,8};/i,
            alias: "named-entity"
        }, /&#x?[\da-f]{1,8};/i]
    }, Prism.languages.markup.tag.inside["attr-value"].inside.entity = Prism.languages.markup.entity, Prism.languages.markup.doctype.inside["internal-subset"].inside = Prism.languages.markup, Prism.hooks.add("wrap", function (e) {
        "entity" === e.type && (e.attributes.title = e.content.replace(/&amp;/, "&"))
    }), Object.defineProperty(Prism.languages.markup.tag, "addInlined", {
        value: function (e, t) {
            var n = {};
            n["language-" + t] = {
                pattern: /(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,
                lookbehind: !0,
                inside: Prism.languages[t]
            }, n.cdata = /^<!\[CDATA\[|\]\]>$/i;
            n = {
                "included-cdata": {
                    pattern: /<!\[CDATA\[[\s\S]*?\]\]>/i,
                    inside: n
                }
            };
            n["language-" + t] = {
                pattern: /[\s\S]+/,
                inside: Prism.languages[t]
            };
            t = {};
            t[e] = {
                pattern: RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g, function () {
                    return e
                }), "i"),
                lookbehind: !0,
                greedy: !0,
                inside: n
            }, Prism.languages.insertBefore("markup", "cdata", t)
        }
    }), Object.defineProperty(Prism.languages.markup.tag, "addAttribute", {
        value: function (e, t) {
            Prism.languages.markup.tag.inside["special-attr"].push({
                pattern: RegExp(/(^|["'\s])/.source + "(?:" + e + ")" + /\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source, "i"),
                lookbehind: !0,
                inside: {
                    "attr-name": /^[^\s=]+/,
                    "attr-value": {
                        pattern: /=[\s\S]+/,
                        inside: {
                            value: {
                                pattern: /(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,
                                lookbehind: !0,
                                alias: [t, "language-" + t],
                                inside: Prism.languages[t]
                            },
                            punctuation: [{
                                pattern: /^=/,
                                alias: "attr-equals"
                            }, /"|'/]
                        }
                    }
                }
            })
        }
    }), Prism.languages.html = Prism.languages.markup, Prism.languages.mathml = Prism.languages.markup, Prism.languages.svg = Prism.languages.markup, Prism.languages.xml = Prism.languages.extend("markup", {}), Prism.languages.ssml = Prism.languages.xml, Prism.languages.atom = Prism.languages.xml, Prism.languages.rss = Prism.languages.xml,
        function (e) {
            var t = /(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;
            e.languages.css = {
                comment: /\/\*[\s\S]*?\*\//,
                atrule: {
                    pattern: /@[\w-](?:[^;{\s]|\s+(?![\s{]))*(?:;|(?=\s*\{))/,
                    inside: {
                        rule: /^@[\w-]+/,
                        "selector-function-argument": {
                            pattern: /(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,
                            lookbehind: !0,
                            alias: "selector"
                        },
                        keyword: {
                            pattern: /(^|[^\w-])(?:and|not|only|or)(?![\w-])/,
                            lookbehind: !0
                        }
                    }
                },
                url: {
                    pattern: RegExp("\\burl\\((?:" + t.source + "|" + /(?:[^\\\r\n()"']|\\[\s\S])*/.source + ")\\)", "i"),
                    greedy: !0,
                    inside: {
                        function: /^url/i,
                        punctuation: /^\(|\)$/,
                        string: {
                            pattern: RegExp("^" + t.source + "$"),
                            alias: "url"
                        }
                    }
                },
                selector: {
                    pattern: RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|" + t.source + ")*(?=\\s*\\{)"),
                    lookbehind: !0
                },
                string: {
                    pattern: t,
                    greedy: !0
                },
                property: {
                    pattern: /(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,
                    lookbehind: !0
                },
                important: /!important\b/i,
                function: {
                    pattern: /(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,
                    lookbehind: !0
                },
                punctuation: /[(){};:,]/
            }, e.languages.css.atrule.inside.rest = e.languages.css;
            e = e.languages.markup;
            e && (e.tag.addInlined("style", "css"), e.tag.addAttribute("style", "css"))
        }(Prism), Prism.languages.clike = {
            comment: [{
                pattern: /(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,
                lookbehind: !0,
                greedy: !0
            }, {
                pattern: /(^|[^\\:])\/\/.*/,
                lookbehind: !0,
                greedy: !0
            }],
            string: {
                pattern: /(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,
                greedy: !0
            },
            "class-name": {
                pattern: /(\b(?:class|interface|extends|implements|trait|instanceof|new)\s+|\bcatch\s+\()[\w.\\]+/i,
                lookbehind: !0,
                inside: {
                    punctuation: /[.\\]/
                }
            },
            keyword: /\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,
            boolean: /\b(?:true|false)\b/,
            function: /\b\w+(?=\()/,
            number: /\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,
            operator: /[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,
            punctuation: /[{}[\];(),.:]/
        }, Prism.languages.javascript = Prism.languages.extend("clike", {
            "class-name": [Prism.languages.clike["class-name"], {
                pattern: /(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:prototype|constructor))/,
                lookbehind: !0
            }],
            keyword: [{
                pattern: /((?:^|\})\s*)catch\b/,
                lookbehind: !0
            }, {
                pattern: /(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,
                lookbehind: !0
            }],
            function: /#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,
            number: /\b(?:(?:0[xX](?:[\dA-Fa-f](?:_[\dA-Fa-f])?)+|0[bB](?:[01](?:_[01])?)+|0[oO](?:[0-7](?:_[0-7])?)+)n?|(?:\d(?:_\d)?)+n|NaN|Infinity)\b|(?:\b(?:\d(?:_\d)?)+\.?(?:\d(?:_\d)?)*|\B\.(?:\d(?:_\d)?)+)(?:[Ee][+-]?(?:\d(?:_\d)?)+)?/,
            operator: /--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/
        }), Prism.languages.javascript["class-name"][0].pattern = /(\b(?:class|interface|extends|implements|instanceof|new)\s+)[\w.\\]+/, Prism.languages.insertBefore("javascript", "keyword", {
            regex: {
                pattern: /((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)\/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/,
                lookbehind: !0,
                greedy: !0,
                inside: {
                    "regex-source": {
                        pattern: /^(\/)[\s\S]+(?=\/[a-z]*$)/,
                        lookbehind: !0,
                        alias: "language-regex",
                        inside: Prism.languages.regex
                    },
                    "regex-delimiter": /^\/|\/$/,
                    "regex-flags": /^[a-z]+$/
                }
            },
            "function-variable": {
                pattern: /#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,
                alias: "function"
            },
            parameter: [{
                pattern: /(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,
                lookbehind: !0,
                inside: Prism.languages.javascript
            }, {
                pattern: /(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,
                lookbehind: !0,
                inside: Prism.languages.javascript
            }, {
                pattern: /(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,
                lookbehind: !0,
                inside: Prism.languages.javascript
            }, {
                pattern: /((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,
                lookbehind: !0,
                inside: Prism.languages.javascript
            }],
            constant: /\b[A-Z](?:[A-Z_]|\dx?)*\b/
        }), Prism.languages.insertBefore("javascript", "string", {
            hashbang: {
                pattern: /^#!.*/,
                greedy: !0,
                alias: "comment"
            },
            "template-string": {
                pattern: /`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,
                greedy: !0,
                inside: {
                    "template-punctuation": {
                        pattern: /^`|`$/,
                        alias: "string"
                    },
                    interpolation: {
                        pattern: /((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,
                        lookbehind: !0,
                        inside: {
                            "interpolation-punctuation": {
                                pattern: /^\$\{|\}$/,
                                alias: "punctuation"
                            },
                            rest: Prism.languages.javascript
                        }
                    },
                    string: /[\s\S]+/
                }
            }
        }), Prism.languages.markup && (Prism.languages.markup.tag.addInlined("script", "javascript"), Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source, "javascript")), Prism.languages.js = Prism.languages.javascript,
        function () {
            var i, l, o, u, a, e;

            function c(e, t) {
                var n = (n = e.className).replace(a, " ") + " language-" + t;
                e.className = n.replace(/\s+/g, " ").trim()
            }
            void 0 !== Prism && "undefined" != typeof document && (Element.prototype.matches || (Element.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector), i = {
                js: "javascript",
                py: "python",
                rb: "ruby",
                ps1: "powershell",
                psm1: "powershell",
                sh: "bash",
                bat: "batch",
                h: "c",
                tex: "latex"
            }, u = "pre[data-src]:not([" + (l = "data-src-status") + '="loaded"]):not([' + l + '="' + (o = "loading") + '"])', a = /\blang(?:uage)?-([\w-]+)\b/i, Prism.hooks.add("before-highlightall", function (e) {
                e.selector += ", " + u
            }), Prism.hooks.add("before-sanity-check", function (e) {
                var t, n, a, r, s = e.element;
                s.matches(u) && (e.code = "", s.setAttribute(l, o), (t = s.appendChild(document.createElement("CODE"))).textContent = "Loading…", n = s.getAttribute("data-src"), "none" === (e = e.language) && (a = (/\.(\w+)$/.exec(n) || [, "none"])[1], e = i[a] || a), c(t, e), c(s, e), (a = Prism.plugins.autoloader) && a.loadLanguages(e), (r = new XMLHttpRequest).open("GET", n, !0), r.onreadystatechange = function () {
                    4 == r.readyState && (r.status < 400 && r.responseText ? (s.setAttribute(l, "loaded"), t.textContent = r.responseText, Prism.highlightElement(t)) : (s.setAttribute(l, "failed"), 400 <= r.status ? t.textContent = "✖ Error " + r.status + " while fetching file: " + r.statusText : t.textContent = "✖ Error: File does not exist or is empty"))
                }, r.send(null))
            }), e = !(Prism.plugins.fileHighlight = {
                highlight: function (e) {
                    for (var t, n = (e || document).querySelectorAll(u), a = 0; t = n[a++];) Prism.highlightElement(t)
                }
            }), Prism.fileHighlight = function () {
                e || (console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."), e = !0), Prism.plugins.fileHighlight.highlight.apply(this, arguments)
            })
        }();
}

prism();

//添加代码高亮依赖
let witcat_BBcode_javascript = document.createElement("script");
witcat_BBcode_javascript.src = "https://cdn.jsdelivr.net/gh/little-starts/custom-extension@BBcode/wit_cat/prism-javascript.min.js";
document.body.appendChild(witcat_BBcode_javascript);

let witcat_BBcode_css = document.createElement("script");
witcat_BBcode_css.src = "https://cdn.jsdelivr.net/gh/little-starts/custom-extension@BBcode/wit_cat/prism-css.min.js";
document.body.appendChild(witcat_BBcode_css);

let witcat_BBcode_markup = document.createElement("script");
witcat_BBcode_markup.src = "https://cdn.jsdelivr.net/gh/little-starts/custom-extension@BBcode/wit_cat/prism-markup.min.js";
document.body.appendChild(witcat_BBcode_markup);

let witcat_BBcode_python = document.createElement("script");
witcat_BBcode_python.src = "https://cdn.jsdelivr.net/gh/little-starts/custom-extension@BBcode/wit_cat/prism-python.min.js";
document.body.appendChild(witcat_BBcode_python);
