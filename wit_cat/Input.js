// import Cast from "cast.js";

const _picture = "data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1OTQuMzE4NyIgaGVpZ2h0PSI1MTQuNzMxNjEiIHZpZXdCb3g9IjAsMCw1OTQuMzE4Nyw1MTQuNzMxNjEiPjxkZWZzPjxsaW5lYXJHcmFkaWVudCB4MT0iMjQwLjAwMDAyIiB5MT0iLTEuNjM3MyIgeDI9IjI0MC4wMDAwMiIgeTI9IjM2MS42MzczOSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci0xIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM1MmJhYmEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Y2FlYWUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjU2LjE5MzU2IiB5MT0iMTM0LjQ4MzI0IiB4Mj0iMjU2LjE5MzU2IiB5Mj0iMjQ0LjkyOTA3IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTIiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2FlYzdjNyIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk2YzJjMiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IHgxPSIyNjkuMjY2NjciIHkxPSIxMzkuMDcyMDEiIHgyPSIyNjkuMjY2NjciIHkyPSIyNDMuOTcwMzYiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMyI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZjFmZmZmIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjY2NmZmZmIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjI0MS4zODE3MSIgeTE9IjE2MC4yMTE4NSIgeDI9IjI0MS4zODE3MSIgeTI9IjIwNi4wNzQxOSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci00Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNhZmM5YzkiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNiYWQ4ZDgiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMTIyLjU4Nzk3IiB5MT0iLTQxLjcwNzA4IiB4Mj0iMTIyLjU4Nzk3IiB5Mj0iNDMxLjI2NTg5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzRjYWVhZSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQ1YTBhMCIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IHgxPSIyNy41MjYzIiB5MT0iLTI4LjQ5Mzg2IiB4Mj0iMjcuNTI2MyIgeTI9IjIxNi4yNTA4OCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci02Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Y2FlYWUiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0NWEwYTAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iNDQ0LjQxNjk1IiB5MT0iLTIwLjk4NDg1IiB4Mj0iNDQ0LjQxNjk1IiB5Mj0iMTM1LjE3MTMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItNyI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjNGNhZWFlIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDVhMGEwIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjExNi41ODE5NiIgeTE9Ii00OS4yMTQ1OSIgeDI9IjExNi41ODE5NiIgeTI9IjQyMy43NTgzOCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci04Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Mzk4OTgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Mjk1OTUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjEuNTIwMyIgeTE9Ii0zNi4wMDEzOCIgeDI9IjIxLjUyMDMiIHkyPSIyMDguNzQzMzciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItOSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjNDM5ODk4Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDI5NTk1Ii8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjQzOC40MTA5NCIgeTE9Ii0xNy45ODE4NSIgeDI9IjQzOC40MTA5NCIgeTI9IjEzOC4xNzQzIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTEwIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Mzk4OTgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Mjk1OTUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMzA3LjI1NzgyIiB5MT0iMjI5LjgyODMiIHgyPSIzMDcuMjU3ODIiIHkyPSI0MTYuNjUyMTgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMTEiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzQzOTg5OCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQyOTU5NSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4LjUzMzc2LDY3LjQ2NTcyKSI+PGcgZGF0YS1wYXBlci1kYXRhPSJ7JnF1b3Q7aXNQYWludGluZ0xheWVyJnF1b3Q7OnRydWV9IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxwYXRoIGQ9Ik0tMS42OTc0LDM2MS42MzczOXYtMzYzLjI3NDc0aDQ4My4zOTQ4NnYzNjMuMjc0NzR6IiBmaWxsPSJ1cmwoI2NvbG9yLTEpIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMCIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiLz48cGF0aCBkPSJNMTgzLjg0MjgzLDE5OS4zNjIxOWMwLC0xNC45MjA1MyAwLC0yNS4zOTMwMyAwLC0zNC4zMjkwNGMwLC0xNC45MjUzNCA4Ljc3Nzk2LC0zMC4wNDk3NSAzMS4wOTM4LC0zMC4wNDk3NWMxNi4xNzQ3LDAgMjY2LjY1ODcxLC0wLjUwMDE2IDI2Ni42NTg3MSwtMC41MDAxNnY3Mi45MDcyNmMwLDAgLTE1LjI3ODcyLC04Ljk2MzM2IC0yNy44ODEzNywxMi41MzU4MmMtNy44MjE5NiwxMy4zNDM2OSAtOS42OTAwNiw2MC43MzAxNCAtMTYuNzgxMzMsNjAuODg4OGMtMTUuMTQ2MjEsMC4zMzg4NyAtMTIuNDk3NTgsLTMzLjYyMDQyIC0yMy4xOTQwOSwtMzQuMDUxMmMtNS40NTEwMiwtMC4zOTY2NiAtMTcuMzU5OTcsOS43NDg5MyAtMjAuMjIxNjEsMjcuNzEwOTJjLTIuMjgzOTUsMTQuMzM1OTEgNC4yNzQ2OSw0Mi4zMDk2OCAtMy42ODkzLDQxLjg3NzMyYy0zMC4zNTE1MiwtMS42NDc3NCAtMTkuNDUwODEsLTcyLjE2MTE0IC00NC44NDIwNywtODcuOTk4MzdjLTEzLjg4NTcyLC04LjY2MDkxIC0xOS4yMjA0NSwtMjkuMjIxMzUgLTQzLjQ1MDI2LC0xNC4yOTI1Yy0xMy43NDA0NSw4LjQ2NTk3IC0xMy45MzQ4NSwtMi42NTIxNiAtMjguMDE5MjUsNS4yMjgzNGMtMTAuOTg5MzMsNi4xNDg3NSAtMTEuODEyNzQsMjUuNDg4MSAtMjAuMDM1ODksMjUuNjM4NDJjLTkuNzM0NDQsMC4xNzc5NCAtMTQuMjg3MDgsLTIzLjI1NDM2IC0yNC4wNTU4MSwtMjYuNDY5MDFjLTE0LjM0MDA2LC00LjcxODk1IC0yMi43NTc1Nyw0LjA1NDM5IC0yNi42MDgwMSw0LjE2OTIzYy0xMS41NTk5NywwLjM0NDc3IC0xOC45NzM1MSwtMTYuNjE4OTYgLTE4Ljk3MzUxLC0yMy4yNjYwOHoiIGZpbGw9InVybCgjY29sb3ItMikiIHN0cm9rZT0iI2NjZmZmZiIgc3Ryb2tlLXdpZHRoPSIwIiBzdHJva2UtbGluZWNhcD0iYnV0dCIvPjxwYXRoIGQ9Ik0xODkuODU0ODMsMjAxLjI1NTM5YzAsLTE0LjMwMDYyIDAsLTIyLjEzNTI4IDAsLTMwLjcwMDAyYzAsLTE0LjMwNTIyIDguNDEzMjUsLTI4LjgwMTI1IDI5LjgwMTkyLC0yOC44MDEyNWMxNS41MDI2OCwwIDI2MS45Mzg1OSwtMC40NzkzOCAyNjEuOTM4NTksLTAuNDc5MzhjMCwwIDAsNS40OTk0MSAwLDEwLjMzNjdjMCwyMi4zNzcxNiAwLDU3LjMzODY5IDAsNTcuMzM4NjljMCwwIC0xNC4yMDA3NiwtNy42MDYyNiAtMjYuNTc4MzUsMTIuMDgzNzZjLTYuNzM2MTIsMTAuNzE1NjkgLTkuNzY0MjUsNTEuMTYzODggLTE2Ljk1NDg3LDU1LjUzOTY1Yy0xMi4zNTEyOCw0LjgzMTYyIC0xNS40NzcyNSwtMjguMTAxNjUgLTI0LjE1NzI1LC0yOC4zNTI3Yy0yMi41NDA5MywtMS41NzMxNyAtMTIuMjUwNTIsNjAuODAwNCAtMjEuMzYxNDQsNjMuOTUxMDFjLTIzLjc5MjUzLDguMjI3NiAtMjIuNDc1MjQsLTU3LjI5NTA5IC00MS45MDgzMywtNzUuMzA0NzVjLTIxLjUyNDMxLC0xOS45NDc3IC00NS4wOTYxMywtMjMuMjk4NzIgLTQ3Ljk3NzYzLC0yMS41MjMzMmMtMTMuMTY5NTcsOC4xMTQyMiAtMTMuMzU1ODgsLTIuNTQxOTggLTI2Ljg1NTEyLDUuMDExMTJjLTEwLjUzMjc1LDUuODkzMjggLTExLjMyMTk1LDI0LjQyOTEyIC0xOS4yMDM0NSwyNC41NzMyYy05LjMyOTk5LDAuMTcwNTUgLTEzLjY5MzQ5LC0yMi4yODgxOSAtMjMuMDU2MzUsLTI1LjM2OTI5Yy0xMy43NDQyNywtNC41MjI4OSAtMjEuODEyMDYsMy44ODU5MyAtMjUuNTAyNTIsMy45OTZjLTExLjA3OTY4LDAuMzMwNDQgLTE4LjE4NTIxLC0xNS45Mjg0NyAtMTguMTg1MjEsLTIyLjI5OTQzeiIgZmlsbD0idXJsKCNjb2xvci0zKSIgc3Ryb2tlPSIjY2NmZmZmIiBzdHJva2Utd2lkdGg9IjAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PGcgc3Ryb2tlLXdpZHRoPSIwIiBzdHJva2UtbGluZWNhcD0iYnV0dCI+PHBhdGggZD0iTTIzMy40MTQxOCwyMDYuMDc0MTlsMC4wNzA3OSwtNS4zODE2NGw1LjA4MzYyLDAuMDgzMzR2LTQwLjU2NDAzaDUuODYzNzJ2NDAuNjQ3MzdoNC45MTY5NHY1LjE5NjIyeiIgZmlsbD0idXJsKCNjb2xvci00KSIgc3Ryb2tlPSIjMDAwMDAwIi8+PHBhdGggZD0iTTIzMy40MTY0NywxNjUuMTg3MzJ2LTUuMjQxMjJoMTYuMTY3ODR2NS4yNDEyMnoiIGZpbGw9IiNhZmM5YzkiIHN0cm9rZT0ibm9uZSIvPjwvZz48ZyBmaWxsPSIjNDM5ODk4IiBzdHJva2Utd2lkdGg9IjAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ij48cGF0aCBkPSJNMjM3LjA2ODIyLDIwMy4wNTQ3di00NS44NDM1OWg1Ljg2MzcydjQ1Ljg0MzU5eiIgc3Ryb2tlPSIjMDAwMDAwIi8+PHBhdGggZD0iTTIzMS45MTYxLDE2Mi4xODY1OXYtNS4yNDEyMmgxNi4xNjc4NHY1LjI0MTIyeiIgc3Ryb2tlPSJub25lIi8+PHBhdGggZD0iTTIzMS45MTYxLDIwMy4xMzAwMnYtNS4yNDEyM2gxNi4xNjc4NHY1LjI0MTIzeiIgc3Ryb2tlPSJub25lIi8+PC9nPjxwYXRoIGQ9Ik0xODUuOTQzNzIsLTQzLjIwNzgzYzAsMCAtNDguMzE4ODksOTEuMTgwNDggLTYxLjUwODcxLDEzMi45OTE1MWMtMy43ODI2LDExLjk5MDYyIDIwLjc2NTM1LDgxLjEzNzc0IDEwLjk2NDUxLDEyOC44NDU4M2MtNy4zMjI0NCwzNS42NDM4NSAtNjEuMjMxNjYsMjMuODM5NjIgLTY3LjYwOTEzLDM5LjM2MTU0Yy0yMy4wNTY2OSw1Ni4xMTY5MiAtMTMuMjMxNDQsMTczLjI3NDg1IC0xMy4yMzE0NCwxNzMuMjc0ODUiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci01KSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PHBhdGggZD0iTTgxLjU4MDM1LC0yOC40OTM4NmMwLDAgLTY0LjU2ODMsNjIuMDg4MTcgLTIzLjg3NTI3LDE2MC43MTM4NWMxOS4xNTIyNiw0Ni40MTgzNyAtODQuMjMyODMsODQuMDMwOSAtODQuMjMyODMsODQuMDMwOSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTYpIiBzdHJva2Utd2lkdGg9IjMyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48cGF0aCBkPSJNNDQ3LjIwMjM2LC0yMC45ODQ4NWMwLDAgLTIwNS4xNjY3LDI5LjE1MjA2IC0yMTMuNzU1NjksODQuMjMzNjJjLTExLjg3OTIsNzYuMTgxODMgMjk2LjMzODI4LC04MC4yNTQ5OCAyOTYuMzM4MjgsLTMuMTUyNTQiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci03KSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PHBhdGggZD0iTTE3NS40MzU0NywtNTEuNDY1NzJjMCwwIC00My44MTY2NCw5MS45MzA4NSAtNTcuMDA2NDUsMTMzLjc0MTg5Yy0zLjc4MjYsMTEuOTkwNjIgMjAuNzY1MzQsODEuMTM3NzQgMTAuOTY0NTEsMTI4Ljg0NTgzYy03LjMyMjQ0LDM1LjY0Mzg1IC02MS4yMzE2NiwyMy44Mzk2MiAtNjcuNjA5MTMsMzkuMzYxNTRjLTIzLjA1NjY5LDU2LjExNjkyIC0xMy4yMzE0NCwxNzMuMjc0ODUgLTEzLjIzMTQ0LDE3My4yNzQ4NSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTgpIiBzdHJva2Utd2lkdGg9IjMyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48cGF0aCBkPSJNNzUuNTc0MzQsLTM2LjAwMTM4YzAsMCAtNjQuNTY4Myw2Mi4wODgxNyAtMjMuODc1MjcsMTYwLjcxMzg1YzE5LjE1MjI2LDQ2LjQxODM3IC04NC4yMzI4Myw4NC4wMzA5IC04NC4yMzI4Myw4NC4wMzA5IiBmaWxsPSJub25lIiBzdHJva2U9InVybCgjY29sb3ItOSkiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik00NDEuMTk2MzUsLTI4LjQ5MjM2YzAsMCAtMjE3LjE3ODcxLDMwLjY1MzU2IC0yMjUuNzY3Nyw4NS43MzUxM2MtMTEuODc5Miw3Ni4xODE4MyAzMTQuMzU2MywtODQuNzU5NDggMzE0LjM1NjMsLTcuNjU3MDUiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci0xMCkiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik0xMzIuNzU2NTMsMzc2LjU1NjcyYzAsMCAyMy42NjYyOSwtNzIuOTM5NDcgNjIuNzc2MTcsLTg4LjYzNjA2YzkuMTkxNDgsLTMuNjg4OTYgMTIuNzc1Nyw1MC40NjgyOCAyMS42NzEzNyw2Ni4xNTgwNGM3LjE3NzQ3LDEyLjY1OTI4IDIwLjM5NjExLDguMjI0NjMgMjcuODY2ODgsMy4xNjUyM2MyNi43MjgyMSwtMTguMTAxMDMgNDcuNDk1MTQsLTY4Ljk2MjMyIDYzLjg1NDYsLTc5Ljk4NjY4YzE1LjYzMDY3LC0xMC41MzMyMyAzLjg1MDc3LDExNi4xNDYyNCAyOS41NjUwMiwxNDYuNjYyNWMzLjU1ODkyLDQuMjIzNTMgNTcuMjY3NTEsLTcuNTM0OTMgMTAwLjQwOTksLTU3LjgxNDFjMzguMzI2NzQsLTQ0LjY2NjkgODQuNzQxOCwtODIuNTAzMDggODYuMTg3NTgsLTgyLjk5Njk3IiBmaWxsPSJub25lIiBzdHJva2U9IiM0NjlmOWYiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik0xMjkuNDc1MTYsMzY2LjEyODQ3YzkuODIxNzQsLTQ3LjU1NjQgNzEuODI5NTcsLTEwMS44NzM4NSA3NS4zNzUxLC04Ny40MTA2NGM5LjYxNzEzLDM5LjIzMDg5IC0zLjEzNjcyLDk0LjMwOTI0IDM2Ljc1ODY4LDY3LjMwNzhjMjkuNjg0OTUsLTIwLjA5MDk1IDUxLjg1OTE2LC03MC42NjA1NyA2OS4xMDAwMiwtODIuMjc4ODhjMTUuNjMwNjcsLTEwLjUzMzIzIC01LjE1Mzc0LDEyMi4xNDkyNCAyMC41NjA1MSwxNTIuNjY1NWM0LjcwMjMyLDUuNTgwNDUgNjEuMzQzNDMsLTEzLjk0MjM3IDEwOS41MTI3NSwtNzAuNjk4OTVjMjAuNjc0NiwtMjQuMzYwMzIgODIuMTY0ODIsLTc2LjU1MDIxIDgzLjA4Nzc0LC03Ni44NjU0OSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTExKSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PC9nPjwvZz48L3N2Zz48IS0tcm90YXRpb25DZW50ZXI6Mjg4LjUzMzc2MDAwMDAwMDAzOjI0Ny40NjU3Mi0tPg==";

const _icon = "data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIxNzcuMDg4NTUiIGhlaWdodD0iMTc3LjA4ODU1IiB2aWV3Qm94PSIwLDAsMTc3LjA4ODU1LDE3Ny4wODg1NSI+PGRlZnM+PGxpbmVhckdyYWRpZW50IHgxPSIyNTYuMTkzNTYiIHkxPSIxMzcuNDg0NzQiIHgyPSIyNTYuMTkzNTYiIHkyPSIyNDcuOTMwNTciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYWVjN2M3Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjOTZjMmMyIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjI2OS4yNjY2NyIgeTE9IjE0Mi4wNzM1MSIgeDI9IjI2OS4yNjY2NyIgeTI9IjI0Ni45NzE4NiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci0yIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNmMWZmZmYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNjY2ZmZmYiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjQxLjM4MTcxIiB5MT0iMTYwLjIxMTg0IiB4Mj0iMjQxLjM4MTcxIiB5Mj0iMjA2LjA3NDE5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTMiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2FmYzljOSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2JhZDhkOCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNTEuNDU1NzYsLTkxLjQ1NTc0KSI+PGcgZGF0YS1wYXBlci1kYXRhPSJ7JnF1b3Q7aXNQYWludGluZ0xheWVyJnF1b3Q7OnRydWV9IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZS13aWR0aD0iMCIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxwYXRoIGQ9Ik0xNTEuNDU1NzYsMjY4LjU0NDI5di0xNzcuMDg4NTVoMTc3LjA4ODU1djE3Ny4wODg1NXoiIGZpbGw9IiM1MmJhYmEiIHN0cm9rZT0ibm9uZSIvPjxwYXRoIGQ9Ik0xODMuODQyODMsMjAyLjM2MzY5YzAsLTE0LjkyMDUzIDAsLTI1LjM5MzAzIDAsLTM0LjMyOTA0YzAsLTE0LjkyNTM0IDguNzc3OTYsLTMwLjA0OTc1IDMxLjA5MzgsLTMwLjA0OTc1YzE2LjE3NDcsMCAxMTMuNjA3NjgsLTAuNTAwMTYgMTEzLjYwNzY4LC0wLjUwMDE2djcyLjkwNzI2YzAsMCAtMTguMDI5MzEsMS4xMzgxIC0yNy4wMDksNi42NzA4Yy0xMy43NDA0NSw4LjQ2NTk3IC0xMy45MzQ4NSwtMi42NTIxNiAtMjguMDE5MjUsNS4yMjgzNGMtMTAuOTg5MzMsNi4xNDg3NSAtMTEuODEyNzQsMjUuNDg4MSAtMjAuMDM1ODksMjUuNjM4NDJjLTkuNzM0NDQsMC4xNzc5NCAtMTQuMjg3MDgsLTIzLjI1NDM2IC0yNC4wNTU4MSwtMjYuNDY5MDFjLTE0LjM0MDA2LC00LjcxODk1IC0yMi43NTc1Nyw0LjA1NDM5IC0yNi42MDgwMSw0LjE2OTIzYy0xMS41NTk5NywwLjM0NDc3IC0xOC45NzM1MSwtMTYuNjE4OTYgLTE4Ljk3MzUxLC0yMy4yNjYwOHoiIGZpbGw9InVybCgjY29sb3ItMSkiIHN0cm9rZT0iI2NjZmZmZiIvPjxwYXRoIGQ9Ik0xODkuODU0ODMsMjA0LjI1NjljMCwtMTQuMzAwNjIgMCwtMjIuMTM1MjggMCwtMzAuNzAwMDJjMCwtMTQuMzA1MjIgOC40MTMyNSwtMjguODAxMjUgMjkuODAxOTIsLTI4LjgwMTI1YzE1LjUwMjY4LDAgMTA4Ljg4NzU2LC0wLjQ3OTM4IDEwOC44ODc1NiwtMC40NzkzOGMwLDAgMCw1LjQ5OTQxIDAsMTAuMzM2N2MwLDExLjM5MjkxIDAsNTcuMzM4NjkgMCw1Ny4zMzg2OWMwLDAgLTE3LjI4MDI0LDEuMDkwODEgLTI1Ljg4Njg0LDYuMzkzNjVjLTEzLjE2OTU3LDguMTE0MjIgLTEzLjM1NTg4LC0yLjU0MTk4IC0yNi44NTUxMiw1LjAxMTEyYy0xMC41MzI3NSw1Ljg5MzI4IC0xMS4zMjE5NSwyNC40MjkxMiAtMTkuMjAzNDUsMjQuNTczMmMtOS4zMjk5OSwwLjE3MDU1IC0xMy42OTM0OSwtMjIuMjg4MTkgLTIzLjA1NjM1LC0yNS4zNjkyOWMtMTMuNzQ0MjcsLTQuNTIyODkgLTIxLjgxMjA2LDMuODg1OTMgLTI1LjUwMjUyLDMuOTk2Yy0xMS4wNzk2OCwwLjMzMDQ0IC0xOC4xODUyMSwtMTUuOTI4NDcgLTE4LjE4NTIxLC0yMi4yOTk0M3oiIGZpbGw9InVybCgjY29sb3ItMikiIHN0cm9rZT0iI2NjZmZmZiIvPjxnPjxwYXRoIGQ9Ik0yMzMuNDE0MTgsMjA2LjA3NDE5bDAuMDcwNzksLTUuMzgxNjRsNS4wODM2MiwwLjA4MzM0di00MC41NjQwM2g1Ljg2MzcydjQwLjY0NzM3aDQuOTE2OTR2NS4xOTYyMnoiIGZpbGw9InVybCgjY29sb3ItMykiIHN0cm9rZT0iIzAwMDAwMCIvPjxwYXRoIGQ9Ik0yMzMuNDE2NDcsMTY1LjE4NzMydi01LjI0MTIyaDE2LjE2Nzg0djUuMjQxMjJ6IiBmaWxsPSIjYWZjOWM5IiBzdHJva2U9Im5vbmUiLz48L2c+PGcgZmlsbD0iIzQ5YTdhNyI+PHBhdGggZD0iTTIzNy4wNjgyMiwyMDMuMDU0Njl2LTQ1Ljg0MzU5aDUuODYzNzJ2NDUuODQzNTl6IiBzdHJva2U9IiMwMDAwMDAiLz48cGF0aCBkPSJNMjMxLjkxNjEsMTYyLjE4NjU4di01LjI0MTIyaDE2LjE2Nzg0djUuMjQxMjJ6IiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJNMjMxLjkxNjEsMjAzLjEzMDAydi01LjI0MTIzaDE2LjE2Nzg0djUuMjQxMjN6IiBzdHJva2U9Im5vbmUiLz48L2c+PC9nPjwvZz48L3N2Zz48IS0tcm90YXRpb25DZW50ZXI6ODguNTQ0MjQ0OTk5OTk5OTk6ODguNTQ0MjU1MDAwMDAwMDItLT4=";

const extensionId = "WitCatInput";

let keypress = {};
let lastKey = "", MouseWheel = 0;
let timer;

//找渲染cvs
let cvs = document.getElementsByTagName("canvas")[0];
if (cvs === null) {
	alert("当前页面不支持输入框，请前往作品详情页体验完整作品！");
}
else {
	for (let i = 1; cvs.className !== "" && i <= document.getElementsByTagName("canvas").length; i++) {
		cvs = document.getElementsByTagName("canvas")[i];
	}
	if (cvs === null) {
		alert("当前页面不支持输入框，请前往作品详情页体验完整作品！");
	}
}

class WitCatInput {
	constructor(runtime) {
		this.runtime = runtime;
		this._formatMessage = runtime.getFormatMessage({
			"zh-cn": {
				"WitCatInput.name": "[beta]白猫的输入框",
				"WitCatInput.createinput": "ID为[id]的[type]框X[x]Y[y]宽[width]高[height]内容[text]颜色[color]提示[texts]字体大小[size]",
				"WitCatInput.deleteinput": "删除ID为[id]的文本框",
				"WitCatInput.getinput": "获得ID为[id]的文本框的[type]",
				"WitCatInput.isinput": "焦点是否在ID为[id]的文本框上",
				"WitCatInput.whatinput": "焦点位置",
				"WitCatInput.nowinput": "将焦点聚焦在ID为[id]的文本框上",
				"WitCatInput.deleteallinput": "删除所有文本框",
				"WitCatInput.compute": "当前分辨率下高[size]的字体大小",
				"WitCatInput.type.1": "单行文本",
				"WitCatInput.type.2": "多行文本",
				"WitCatInput.number": "第[num]个文本框的[type]",
				"WitCatInput.numbers": "文本框的数量",
				"WitCatInput.number.1": "X",
				"WitCatInput.number.2": "Y",
				"WitCatInput.number.3": "宽",
				"WitCatInput.number.4": "高",
				"WitCatInput.number.5": "内容",
				"WitCatInput.number.6": "颜色",
				"WitCatInput.number.7": "提示",
				"WitCatInput.number.8": "字体大小",
				"WitCatInput.number.9": "所有(json)",
				"WitCatInput.number.10": "ID",
				"WitCatInput.key": "按下按键[type]?",
				"WitCatInput.keys": "按下按键[type]?",
				"WitCatInput.lastkey": "上次按下的键",
				"WitCatInput.mousewheel": "鼠标滚轮",
				"WitCatInput.setinput": "设置ID为[id]的文本框的[type]为[text]",
			},
			en: {
				"WitCatInput.name": "[beta]WitCat‘s Input",
				"WitCatInput.createinput": "[type]input with ID[id]X[x]Y[y]width[width]height[height]content[text]color[color]prompt[texts]font-size[size]",
				"WitCatInput.deleteinput": "delete an input with ID[id]",
				"WitCatInput.getinput": "get [type] with ID[id]",
				"WitCatInput.isinput": "is the focus on the input with ID[id]?",
				"WitCatInput.whatinput": "Focal position",
				"WitCatInput.nowinput": "let teh focus on the input with ID[id]",
				"WitCatInput.deleteallinput": "delete all input",
				"WitCatInput.compute": "Font size of now screen[size]",
				"WitCatInput.type.1": "Single line",
				"WitCatInput.type.2": "Multiple lines",
				"WitCatInput.number": "[type]of[num]input",
				"WitCatInput.numbers": "input number",
				"WitCatInput.number.1": "X",
				"WitCatInput.number.2": "Y",
				"WitCatInput.number.3": "width",
				"WitCatInput.number.4": "height",
				"WitCatInput.number.5": "content",
				"WitCatInput.number.6": "color",
				"WitCatInput.number.7": "prompt",
				"WitCatInput.number.8": "font-size",
				"WitCatInput.number.9": "all(json)",
				"WitCatInput.number.10": "ID",
				"WitCatInput.key": "Press the key[type]?",
				"WitCatInput.keys": "Press the key [type]?",
				"WitCatInput.lastkey": "last key pressed",
				"WitCatInput.mousewheel": "MouseWheel",
				"WitCatInput.setinput": "Set[type]of input whose ID is[id]to[text]",
			}
		})
	}

	formatMessage(id) {
		return this._formatMessage({
			id,
			default: id,
			description: id
		});
	}

	getInfo() {
		return {
			id: extensionId, // 拓展id
			name: this.formatMessage("WitCatInput.name"), // 拓展名
			docsURI: "https://www.ccw.site/post/6153a7a6-05fb-462e-b785-b97700b12bc2",
			blockIconURI: _icon,
			menuIconURI: _icon,
			color1: "#52baba",
			color2: "#ffffff",
			blocks: [
				{
					opcode: "createinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.createinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "type",
						},
						x: {
							type: "number",
							defaultValue: "0",
						},
						y: {
							type: "number",
							defaultValue: "0",
						},
						width: {
							type: "number",
							defaultValue: "100",
						},
						height: {
							type: "number",
							defaultValue: "20",
						},
						text: {
							type: "string",
							defaultValue: "hello world!",
						},
						color: {
							type: "string",
							defaultValue: "#000000",
						},
						texts: {
							type: "string",
							defaultValue: "hello world!",
						},
						size: {
							type: "number",
							defaultValue: "16",
						}
					},
				},
				{
					opcode: "setinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "typess",
						},
						text: {
							type: "string",
							defaultValue: "10",
						},
					},
				},
				{
					opcode: "compute",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.compute"),
					arguments: {
						size: {
							type: "number",
							defaultValue: "16",
						}
					},
				},
				{
					opcode: "deleteinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.deleteinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						}
					},
				},
				{
					opcode: "getinput",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.getinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "types",
						}
					},
				},
				{
					opcode: "number",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.number"),
					arguments: {
						num: {
							type: "number",
							defaultValue: "1",
						},
						type: {
							type: "string",
							menu: "types",
						}
					},
				},
				{
					opcode: "numbers",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.numbers"),
					arguments: {},
				},
				{
					opcode: "isinput",
					blockType: "Boolean",
					text: this.formatMessage("WitCatInput.isinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						}
					},
				},
				{
					opcode: "whatinput",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.whatinput"),
					arguments: {},
				},
				{
					opcode: "nowinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.nowinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						}
					},
				},
				{
					opcode: "key",
					blockType: "Boolean",
					text: this.formatMessage("WitCatInput.key"),
					arguments: {
						type: {
							type: "string",
							defaultValue: "KeyA",
						}
					},
				},
				{
					opcode: "mousewheel",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.mousewheel"),
					arguments: {},
				},
				{
					opcode: "keys",
					blockType: "hat",
					text: this.formatMessage("WitCatInput.keys"),
					func: false,
					arguments: {
						type: {
							type: "string",
							defaultValue: "KeyA",
						}
					},
				},
				{
					opcode: "lastkey",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.lastkey"),
					func: false,
					arguments: {},
				},
				{
					opcode: "deleteallinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.deleteallinput"),
					arguments: {},
				},
			],
			menus: {
				type: [
					{
						text: this.formatMessage('WitCatInput.type.1'),
						value: 'input'
					},
					{
						text: this.formatMessage('WitCatInput.type.2'),
						value: 'Textarea'
					},
				],
				types: [
					{
						text: this.formatMessage('WitCatInput.number.10'),
						value: 'ID'
					},
					{
						text: this.formatMessage('WitCatInput.number.1'),
						value: 'X'
					},
					{
						text: this.formatMessage('WitCatInput.number.2'),
						value: 'Y'
					},
					{
						text: this.formatMessage('WitCatInput.number.3'),
						value: 'width'
					},
					{
						text: this.formatMessage('WitCatInput.number.4'),
						value: 'height'
					},
					{
						text: this.formatMessage('WitCatInput.number.5'),
						value: 'content'
					},
					{
						text: this.formatMessage('WitCatInput.number.6'),
						value: 'color'
					},
					{
						text: this.formatMessage('WitCatInput.number.7'),
						value: 'prompt'
					},
					{
						text: this.formatMessage('WitCatInput.number.8'),
						value: 'font-size'
					},
					{
						text: this.formatMessage('WitCatInput.number.9'),
						value: 'json'
					},
				],
				typess: [
					{
						text: this.formatMessage('WitCatInput.number.1'),
						value: 'X'
					},
					{
						text: this.formatMessage('WitCatInput.number.2'),
						value: 'Y'
					},
					{
						text: this.formatMessage('WitCatInput.number.3'),
						value: 'width'
					},
					{
						text: this.formatMessage('WitCatInput.number.4'),
						value: 'height'
					},
					{
						text: this.formatMessage('WitCatInput.number.5'),
						value: 'content'
					},
					{
						text: this.formatMessage('WitCatInput.number.6'),
						value: 'color'
					},
					{
						text: this.formatMessage('WitCatInput.number.7'),
						value: 'prompt'
					},
					{
						text: this.formatMessage('WitCatInput.number.8'),
						value: 'font-size'
					},
				]
			}
		};
	}
	//设置或创建文本框
	createinput(args) {
		let x = args.x;
		let y = args.y;
		let width = args.width;
		let height = args.height;
		if (args.x > this.runtime.stageWidth) {
			x = this.runtime.stageWidth;
		}
		if (args.x < 0) {
			x = 0;
		}
		if (args.y > this.runtime.stageHeight) {
			y = this.runtime.stageHeight;
		}
		if (args.y < 0) {
			y = 0;
		}
		if (Number(args.x) + Number(args.width) > this.runtime.stageWidth) {
			width = this.runtime.stageWidth - x;
		}
		if (args.width < 0) {
			width = 0;
		}
		if (Number(args.y) + Number(args.height) > this.runtime.stageHeight) {
			height = this.runtime.stageHeight - y;
		}
		if (args.height < 0) {
			height = 0;
		}
		x = (x / this.runtime.stageWidth) * 100;
		y = (y / this.runtime.stageHeight) * 100;
		width = (width / this.runtime.stageWidth) * 100;
		height = (height / this.runtime.stageHeight) * 100;
		let dom = `background-color: transparent;border:0px;text-shadow: 0 0 0 #000;outline: none;position:absolute; left:` + x + `%; top:` + y + `%; width:` + width + `%; height:` + height + `%;font-size: ` + args.size + `px;resize:none;color:` + args.color + `;`;
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			if (search.name === args.type) {
				search.style = dom;
				search.value = args.text;
				search.placeholder = args.texts;
			}
			else {
				cvs.parentNode.removeChild(search);
				let eleLink = document.createElement(args.type);
				if (args.type === "input") {
					eleLink.type = "text";
				}
				eleLink.style = dom;
				eleLink.id = "WitCatInput" + args.id;
				eleLink.value = args.text;
				eleLink.className = "WitCatInput";
				eleLink.name = args.type;
				eleLink.placeholder = args.texts;
				cvs.parentNode.appendChild(eleLink);
			}
		}
		else {
			let eleLink = document.createElement(args.type);
			if (args.type === "input") {
				eleLink.type = "text";
			}
			eleLink.style = dom;
			eleLink.id = "WitCatInput" + args.id;
			eleLink.value = args.text;
			eleLink.className = "WitCatInput";
			eleLink.name = args.type;
			eleLink.placeholder = args.texts;
			cvs.parentNode.appendChild(eleLink);
		}
	}
	//删除文本框
	deleteinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			cvs.parentNode.removeChild(search);
		}
	}
	//获取文本框内容
	getinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			if (args.type === "X")
				return (search.style.left.split("%")[0] / 100) * this.runtime.stageWidth;
			else if (args.type === "Y")
				return (search.style.top.split("%")[0] / 100) * this.runtime.stageHeight;
			else if (args.type === "width")
				return (search.style.width.split("%")[0] / 100) * this.runtime.stageWidth;
			else if (args.type === "height")
				return (search.style.height.split("%")[0] / 100) * this.runtime.stageHeight;
			else if (args.type === "content")
				return search.value;
			else if (args.type === "color")
				return search.style.color.colorHex();
			else if (args.type === "prompt")
				return search.placeholder;
			else if (args.type === "font-size")
				return search.style.fontSize.split("px")[0];
			else if (args.type === "ID")
				return search.id.split("WitCatInput")[1];
			else {
				return (
					"{\"" + "X" + "\":\"" + ((search.style.left.split("%")[0] / 100) * this.runtime.stageWidth) + "\"," +
					"\"" + "Y" + "\":\"" + ((search.style.top.split("%")[0] / 100) * this.runtime.stageHeight) + "\"," +
					"\"" + "width" + "\":\"" + ((search.style.width.split("%")[0] / 100) * this.runtime.stageWidth) + "\"," +
					"\"" + "height" + "\":\"" + ((search.style.height.split("%")[0] / 100) * this.runtime.stageHeight) + "\"," +
					"\"" + "content" + "\":" + JSON.stringify(search.value) + "," +
					"\"" + "color" + "\":\"" + (search.style.color.colorHex()) + "\"," +
					"\"" + "prompt" + "\":\"" + (search.placeholder) + "\"," +
					"\"" + "font-size" + "\":\"" + (search.style.fontSize.split("px")[0]) + "\"," +
					"\"" + "ID" + "\":\"" + (search.id.split("WitCatInput")[1]) + "\"}"
				)
			}
		}
		else {
			return ("");
		}
	}
	//焦点判断
	isinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			if (search === document.activeElement) {
				return (true);
			}
			else {
				return (false);
			}
		}
		else {
			return (false);
		}
	}
	//焦点位置
	whatinput() {
		if (document.activeElement.className === "WitCatInput") {
			return document.activeElement.id.split("WitCatInput")[1];
		}
		else {
			return "";
		}
	}
	//焦点获取
	nowinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			search.focus();
		}
		else if (document.activeElement.className === "WitCatInput") {
			document.activeElement.blur();
		}
	}
	//删除所有文本框
	deleteallinput() {
		let search = document.getElementsByClassName("WitCatInput");
		let i = 0;
		for (i = search.length - 1; i >= 0; i--) {
			search[i].parentNode.removeChild(search[i]);
		}
	}
	//计算坐标
	compute(args) {
		return (cvs.style.width.split("px")[0] / 360) * args.size;
	}
	//获取状态
	number(args) {
		let search = document.getElementsByClassName("WitCatInput");
		if (search.length >= args.num && args.num > 0) {
			if (args.type === "X")
				return (search[args.num - 1].style.left.split("%")[0] / 100) * this.runtime.stageWidth;
			else if (args.type === "Y")
				return (search[args.num - 1].style.top.split("%")[0] / 100) * this.runtime.stageHeight;
			else if (args.type === "width")
				return (search[args.num - 1].style.width.split("%")[0] / 100) * this.runtime.stageWidth;
			else if (args.type === "height")
				return (search[args.num - 1].style.height.split("%")[0] / 100) * this.runtime.stageHeight;
			else if (args.type === "content")
				return search[args.num - 1].value;
			else if (args.type === "color")
				return search[args.num - 1].style.color.colorHex();
			else if (args.type === "prompt")
				return search[args.num - 1].placeholder;
			else if (args.type === "font-size")
				return search[args.num - 1].style.fontSize.split("px")[0];
			else if (args.type === "ID")
				return search[args.num - 1].id.split("WitCatInput")[1];
			else {
				return (
					"{\"" + "X" + "\":\"" + ((search[args.num - 1].style.left.split("%")[0] / 100) * this.runtime.stageWidth) + "\"," +
					"\"" + "Y" + "\":\"" + ((search[args.num - 1].style.top.split("%")[0] / 100) * this.runtime.stageHeight) + "\"," +
					"\"" + "width" + "\":\"" + ((search[args.num - 1].style.width.split("%")[0] / 100) * this.runtime.stageWidth) + "\"," +
					"\"" + "height" + "\":\"" + ((search[args.num - 1].style.height.split("%")[0] / 100) * this.runtime.stageHeight) + "\"," +
					"\"" + "content" + "\":" + JSON.stringify(search[args.num - 1].value) + "," +
					"\"" + "color" + "\":\"" + (search[args.num - 1].style.color.colorHex()) + "\"," +
					"\"" + "prompt" + "\":\"" + (search[args.num - 1].placeholder) + "\"," +
					"\"" + "font-size" + "\":\"" + (search[args.num - 1].style.fontSize.split("px")[0]) + "\"," +
					"\"" + "ID" + "\":\"" + (search[args.num - 1].id.split("WitCatInput")[1]) + "\"}"
				)
			}
		}
		else {
			return "";
		}
	}
	//文本框数量
	numbers() {
		let search = document.getElementsByClassName("WitCatInput");
		return search.length;
	}
	//按键检测
	key(args) {
		return (args.type in keypress);
	}
	//按键检测
	keys(args) {
		return (args.type in keypress);
	}
	//上次按下的键
	lastkey() {
		return lastKey;
	}
	//鼠标滚轮
	mousewheel() {
		return MouseWheel;
	}
	//设置文本框
	setinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			let x = search.style.left.split("%")[0];
			let y = search.style.top.split("%")[0];
			let width = search.style.width.split("%")[0];
			let height = search.style.height.split("%")[0];
			let content = search.value;
			let prompt = search.placeholder;
			let color = search.style.color.colorHex()
			let size = search.style.fontSize.split("px")[0];
			if (args.type === "X") {
				x = args.text;
				if (args.text > this.runtime.stageWidth) {
					x = this.runtime.stageWidth;
				}
				if (args.text < 0) {
					x = 0;
				}
				x = (x / this.runtime.stageWidth) * 100;
			}
			else if (args.type === "Y") {
				y = args.text;
				if (args.text > this.runtime.stageHeight) {
					y = this.runtime.stageHeight;
				}
				if (args.text < 0) {
					y = 0;
				}
				y = (y / this.runtime.stageHeight) * 100;
			}
			else if (args.type === "width") {
				width = args.text;
				if (Number(x) + Number(args.text) > this.runtime.stageWidth) {
					width = this.runtime.stageWidth - x;
				}
				if (args.text < 0) {
					width = 0;
				}
				width = (width / this.runtime.stageWidth) * 100;
			}
			else if (args.type === "height") {
				height = args.text;
				if (Number(y) + Number(args.text) > this.runtime.stageHeight) {
					height = this.runtime.stageHeight - y;
				}
				if (args.text < 0) {
					height = 0;
				}
				height = (height / this.runtime.stageHeight) * 100;
			}
			else if (args.type === "content") {
				content = args.text;
			}
			else if (args.type === "prompt") {
				prompt = args.text;
			}
			else if (args.type === "color") {
				color = args.text;
			}
			else if (args.type === "font-size") {
				size = args.text;
			}

			let dom = `background-color: transparent;border:0px;text-shadow: 0 0 0 #000;outline: none;position:absolute; left:` + x + `%; top:` + y + `%; width:` + width + `%; height:` + height + `%;font-size: ` + size + `px;resize:none;color:` + color + `;`;

			search.style = dom;
			search.value = content;
			search.placeholder = prompt;
		}
	}
}

window.tempExt = {
	Extension: WitCatInput,
	info: {
		name: "WitCatInput.name",
		description: "WitCatInput.descp",
		extensionId: extensionId,
		iconURL: _picture,
		insetIconURL: _icon,
		featured: true,
		disabled: false,
		collaborator: "白猫 @ CCW"
	},
	l10n: {
		"zh-cn": {
			"WitCatInput.name": "[beta]白猫的输入框",
			"WitCatInput.descp": "全新的输入框！"
		},
		en: {
			"WitCatInput.name": "[beta]WitCat‘s Input",
			"WitCatInput.descp": "what a nice input!"
		}
	}
};

/* vim: set expandtab tabstop=2 shiftwidth=2: */
//颜色转换
String.prototype.colorHex = function () {
	// RGB颜色值的正则
	var reg = /^(rgb|RGB)/;
	var color = this;
	if (reg.test(color)) {
		var strHex = "#";
		// 把RGB的3个数值变成数组
		var colorArr = color.replace(/(?:\(|\)|rgb|RGB)*/g, "").split(",");
		// 转成16进制
		for (var i = 0; i < colorArr.length; i++) {
			var hex = Number(colorArr[i]).toString(16);
			if (hex === "0") {
				hex += hex;
			}
			strHex += hex;
		}
		return strHex;
	} else {
		return String(color);
	}
};

//键盘事件监听
document.addEventListener("keydown", keydown);
document.addEventListener("keyup", keyup);
function keydown(event) {
	keypress[event.code] = true;
	lastKey = event.code;
}
function keyup(event) {
	delete keypress[event.code];
}
//滚轮事件监听
var scrollFunc = e => {
	e = e || window.event;
	if (e.wheelDelta) {  //判断浏览器IE，谷歌滑轮事件
		MouseWheel = e.wheelDelta;
	} else if (e.detail) {  //Firefox滑轮事件
		MouseWheel = e.detail;
	}
	clearTimeout(timer);
	timer = setTimeout(() => {
		MouseWheel = 0;
	}, 30);
};
//给页面绑定滑轮滚动事件
if (cvs.parentNode.addEventListener) { //火狐使用DOMMouseScroll绑定
	cvs.parentNode.addEventListener('DOMMouseScroll', scrollFunc, false);
}
//其他浏览器直接绑定滚动事件
cvs.parentNode.onmousewheel = scrollFunc;
