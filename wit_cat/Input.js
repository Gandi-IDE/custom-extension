// import Cast from "cast.js";

const witcat_input_picture = "data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1OTQuMzE4NyIgaGVpZ2h0PSI1MTQuNzMxNjEiIHZpZXdCb3g9IjAsMCw1OTQuMzE4Nyw1MTQuNzMxNjEiPjxkZWZzPjxsaW5lYXJHcmFkaWVudCB4MT0iMjQwLjAwMDAyIiB5MT0iLTEuNjM3MyIgeDI9IjI0MC4wMDAwMiIgeTI9IjM2MS42MzczOSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci0xIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM1MmJhYmEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Y2FlYWUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjU2LjE5MzU2IiB5MT0iMTM0LjQ4MzI0IiB4Mj0iMjU2LjE5MzU2IiB5Mj0iMjQ0LjkyOTA3IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTIiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2FlYzdjNyIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk2YzJjMiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IHgxPSIyNjkuMjY2NjciIHkxPSIxMzkuMDcyMDEiIHgyPSIyNjkuMjY2NjciIHkyPSIyNDMuOTcwMzYiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMyI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZjFmZmZmIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjY2NmZmZmIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjI0MS4zODE3MSIgeTE9IjE2MC4yMTE4NSIgeDI9IjI0MS4zODE3MSIgeTI9IjIwNi4wNzQxOSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci00Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNhZmM5YzkiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNiYWQ4ZDgiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMTIyLjU4Nzk3IiB5MT0iLTQxLjcwNzA4IiB4Mj0iMTIyLjU4Nzk3IiB5Mj0iNDMxLjI2NTg5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzRjYWVhZSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQ1YTBhMCIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IHgxPSIyNy41MjYzIiB5MT0iLTI4LjQ5Mzg2IiB4Mj0iMjcuNTI2MyIgeTI9IjIxNi4yNTA4OCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci02Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Y2FlYWUiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0NWEwYTAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iNDQ0LjQxNjk1IiB5MT0iLTIwLjk4NDg1IiB4Mj0iNDQ0LjQxNjk1IiB5Mj0iMTM1LjE3MTMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItNyI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjNGNhZWFlIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDVhMGEwIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjExNi41ODE5NiIgeTE9Ii00OS4yMTQ1OSIgeDI9IjExNi41ODE5NiIgeTI9IjQyMy43NTgzOCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci04Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Mzk4OTgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Mjk1OTUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjEuNTIwMyIgeTE9Ii0zNi4wMDEzOCIgeDI9IjIxLjUyMDMiIHkyPSIyMDguNzQzMzciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItOSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjNDM5ODk4Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDI5NTk1Ii8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjQzOC40MTA5NCIgeTE9Ii0xNy45ODE4NSIgeDI9IjQzOC40MTA5NCIgeTI9IjEzOC4xNzQzIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTEwIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Mzk4OTgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Mjk1OTUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMzA3LjI1NzgyIiB5MT0iMjI5LjgyODMiIHgyPSIzMDcuMjU3ODIiIHkyPSI0MTYuNjUyMTgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMTEiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzQzOTg5OCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQyOTU5NSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4LjUzMzc2LDY3LjQ2NTcyKSI+PGcgZGF0YS1wYXBlci1kYXRhPSJ7JnF1b3Q7aXNQYWludGluZ0xheWVyJnF1b3Q7OnRydWV9IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxwYXRoIGQ9Ik0tMS42OTc0LDM2MS42MzczOXYtMzYzLjI3NDc0aDQ4My4zOTQ4NnYzNjMuMjc0NzR6IiBmaWxsPSJ1cmwoI2NvbG9yLTEpIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMCIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiLz48cGF0aCBkPSJNMTgzLjg0MjgzLDE5OS4zNjIxOWMwLC0xNC45MjA1MyAwLC0yNS4zOTMwMyAwLC0zNC4zMjkwNGMwLC0xNC45MjUzNCA4Ljc3Nzk2LC0zMC4wNDk3NSAzMS4wOTM4LC0zMC4wNDk3NWMxNi4xNzQ3LDAgMjY2LjY1ODcxLC0wLjUwMDE2IDI2Ni42NTg3MSwtMC41MDAxNnY3Mi45MDcyNmMwLDAgLTE1LjI3ODcyLC04Ljk2MzM2IC0yNy44ODEzNywxMi41MzU4MmMtNy44MjE5NiwxMy4zNDM2OSAtOS42OTAwNiw2MC43MzAxNCAtMTYuNzgxMzMsNjAuODg4OGMtMTUuMTQ2MjEsMC4zMzg4NyAtMTIuNDk3NTgsLTMzLjYyMDQyIC0yMy4xOTQwOSwtMzQuMDUxMmMtNS40NTEwMiwtMC4zOTY2NiAtMTcuMzU5OTcsOS43NDg5MyAtMjAuMjIxNjEsMjcuNzEwOTJjLTIuMjgzOTUsMTQuMzM1OTEgNC4yNzQ2OSw0Mi4zMDk2OCAtMy42ODkzLDQxLjg3NzMyYy0zMC4zNTE1MiwtMS42NDc3NCAtMTkuNDUwODEsLTcyLjE2MTE0IC00NC44NDIwNywtODcuOTk4MzdjLTEzLjg4NTcyLC04LjY2MDkxIC0xOS4yMjA0NSwtMjkuMjIxMzUgLTQzLjQ1MDI2LC0xNC4yOTI1Yy0xMy43NDA0NSw4LjQ2NTk3IC0xMy45MzQ4NSwtMi42NTIxNiAtMjguMDE5MjUsNS4yMjgzNGMtMTAuOTg5MzMsNi4xNDg3NSAtMTEuODEyNzQsMjUuNDg4MSAtMjAuMDM1ODksMjUuNjM4NDJjLTkuNzM0NDQsMC4xNzc5NCAtMTQuMjg3MDgsLTIzLjI1NDM2IC0yNC4wNTU4MSwtMjYuNDY5MDFjLTE0LjM0MDA2LC00LjcxODk1IC0yMi43NTc1Nyw0LjA1NDM5IC0yNi42MDgwMSw0LjE2OTIzYy0xMS41NTk5NywwLjM0NDc3IC0xOC45NzM1MSwtMTYuNjE4OTYgLTE4Ljk3MzUxLC0yMy4yNjYwOHoiIGZpbGw9InVybCgjY29sb3ItMikiIHN0cm9rZT0iI2NjZmZmZiIgc3Ryb2tlLXdpZHRoPSIwIiBzdHJva2UtbGluZWNhcD0iYnV0dCIvPjxwYXRoIGQ9Ik0xODkuODU0ODMsMjAxLjI1NTM5YzAsLTE0LjMwMDYyIDAsLTIyLjEzNTI4IDAsLTMwLjcwMDAyYzAsLTE0LjMwNTIyIDguNDEzMjUsLTI4LjgwMTI1IDI5LjgwMTkyLC0yOC44MDEyNWMxNS41MDI2OCwwIDI2MS45Mzg1OSwtMC40NzkzOCAyNjEuOTM4NTksLTAuNDc5MzhjMCwwIDAsNS40OTk0MSAwLDEwLjMzNjdjMCwyMi4zNzcxNiAwLDU3LjMzODY5IDAsNTcuMzM4NjljMCwwIC0xNC4yMDA3NiwtNy42MDYyNiAtMjYuNTc4MzUsMTIuMDgzNzZjLTYuNzM2MTIsMTAuNzE1NjkgLTkuNzY0MjUsNTEuMTYzODggLTE2Ljk1NDg3LDU1LjUzOTY1Yy0xMi4zNTEyOCw0LjgzMTYyIC0xNS40NzcyNSwtMjguMTAxNjUgLTI0LjE1NzI1LC0yOC4zNTI3Yy0yMi41NDA5MywtMS41NzMxNyAtMTIuMjUwNTIsNjAuODAwNCAtMjEuMzYxNDQsNjMuOTUxMDFjLTIzLjc5MjUzLDguMjI3NiAtMjIuNDc1MjQsLTU3LjI5NTA5IC00MS45MDgzMywtNzUuMzA0NzVjLTIxLjUyNDMxLC0xOS45NDc3IC00NS4wOTYxMywtMjMuMjk4NzIgLTQ3Ljk3NzYzLC0yMS41MjMzMmMtMTMuMTY5NTcsOC4xMTQyMiAtMTMuMzU1ODgsLTIuNTQxOTggLTI2Ljg1NTEyLDUuMDExMTJjLTEwLjUzMjc1LDUuODkzMjggLTExLjMyMTk1LDI0LjQyOTEyIC0xOS4yMDM0NSwyNC41NzMyYy05LjMyOTk5LDAuMTcwNTUgLTEzLjY5MzQ5LC0yMi4yODgxOSAtMjMuMDU2MzUsLTI1LjM2OTI5Yy0xMy43NDQyNywtNC41MjI4OSAtMjEuODEyMDYsMy44ODU5MyAtMjUuNTAyNTIsMy45OTZjLTExLjA3OTY4LDAuMzMwNDQgLTE4LjE4NTIxLC0xNS45Mjg0NyAtMTguMTg1MjEsLTIyLjI5OTQzeiIgZmlsbD0idXJsKCNjb2xvci0zKSIgc3Ryb2tlPSIjY2NmZmZmIiBzdHJva2Utd2lkdGg9IjAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PGcgc3Ryb2tlLXdpZHRoPSIwIiBzdHJva2UtbGluZWNhcD0iYnV0dCI+PHBhdGggZD0iTTIzMy40MTQxOCwyMDYuMDc0MTlsMC4wNzA3OSwtNS4zODE2NGw1LjA4MzYyLDAuMDgzMzR2LTQwLjU2NDAzaDUuODYzNzJ2NDAuNjQ3MzdoNC45MTY5NHY1LjE5NjIyeiIgZmlsbD0idXJsKCNjb2xvci00KSIgc3Ryb2tlPSIjMDAwMDAwIi8+PHBhdGggZD0iTTIzMy40MTY0NywxNjUuMTg3MzJ2LTUuMjQxMjJoMTYuMTY3ODR2NS4yNDEyMnoiIGZpbGw9IiNhZmM5YzkiIHN0cm9rZT0ibm9uZSIvPjwvZz48ZyBmaWxsPSIjNDM5ODk4IiBzdHJva2Utd2lkdGg9IjAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ij48cGF0aCBkPSJNMjM3LjA2ODIyLDIwMy4wNTQ3di00NS44NDM1OWg1Ljg2MzcydjQ1Ljg0MzU5eiIgc3Ryb2tlPSIjMDAwMDAwIi8+PHBhdGggZD0iTTIzMS45MTYxLDE2Mi4xODY1OXYtNS4yNDEyMmgxNi4xNjc4NHY1LjI0MTIyeiIgc3Ryb2tlPSJub25lIi8+PHBhdGggZD0iTTIzMS45MTYxLDIwMy4xMzAwMnYtNS4yNDEyM2gxNi4xNjc4NHY1LjI0MTIzeiIgc3Ryb2tlPSJub25lIi8+PC9nPjxwYXRoIGQ9Ik0xODUuOTQzNzIsLTQzLjIwNzgzYzAsMCAtNDguMzE4ODksOTEuMTgwNDggLTYxLjUwODcxLDEzMi45OTE1MWMtMy43ODI2LDExLjk5MDYyIDIwLjc2NTM1LDgxLjEzNzc0IDEwLjk2NDUxLDEyOC44NDU4M2MtNy4zMjI0NCwzNS42NDM4NSAtNjEuMjMxNjYsMjMuODM5NjIgLTY3LjYwOTEzLDM5LjM2MTU0Yy0yMy4wNTY2OSw1Ni4xMTY5MiAtMTMuMjMxNDQsMTczLjI3NDg1IC0xMy4yMzE0NCwxNzMuMjc0ODUiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci01KSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PHBhdGggZD0iTTgxLjU4MDM1LC0yOC40OTM4NmMwLDAgLTY0LjU2ODMsNjIuMDg4MTcgLTIzLjg3NTI3LDE2MC43MTM4NWMxOS4xNTIyNiw0Ni40MTgzNyAtODQuMjMyODMsODQuMDMwOSAtODQuMjMyODMsODQuMDMwOSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTYpIiBzdHJva2Utd2lkdGg9IjMyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48cGF0aCBkPSJNNDQ3LjIwMjM2LC0yMC45ODQ4NWMwLDAgLTIwNS4xNjY3LDI5LjE1MjA2IC0yMTMuNzU1NjksODQuMjMzNjJjLTExLjg3OTIsNzYuMTgxODMgMjk2LjMzODI4LC04MC4yNTQ5OCAyOTYuMzM4MjgsLTMuMTUyNTQiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci03KSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PHBhdGggZD0iTTE3NS40MzU0NywtNTEuNDY1NzJjMCwwIC00My44MTY2NCw5MS45MzA4NSAtNTcuMDA2NDUsMTMzLjc0MTg5Yy0zLjc4MjYsMTEuOTkwNjIgMjAuNzY1MzQsODEuMTM3NzQgMTAuOTY0NTEsMTI4Ljg0NTgzYy03LjMyMjQ0LDM1LjY0Mzg1IC02MS4yMzE2NiwyMy44Mzk2MiAtNjcuNjA5MTMsMzkuMzYxNTRjLTIzLjA1NjY5LDU2LjExNjkyIC0xMy4yMzE0NCwxNzMuMjc0ODUgLTEzLjIzMTQ0LDE3My4yNzQ4NSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTgpIiBzdHJva2Utd2lkdGg9IjMyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48cGF0aCBkPSJNNzUuNTc0MzQsLTM2LjAwMTM4YzAsMCAtNjQuNTY4Myw2Mi4wODgxNyAtMjMuODc1MjcsMTYwLjcxMzg1YzE5LjE1MjI2LDQ2LjQxODM3IC04NC4yMzI4Myw4NC4wMzA5IC04NC4yMzI4Myw4NC4wMzA5IiBmaWxsPSJub25lIiBzdHJva2U9InVybCgjY29sb3ItOSkiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik00NDEuMTk2MzUsLTI4LjQ5MjM2YzAsMCAtMjE3LjE3ODcxLDMwLjY1MzU2IC0yMjUuNzY3Nyw4NS43MzUxM2MtMTEuODc5Miw3Ni4xODE4MyAzMTQuMzU2MywtODQuNzU5NDggMzE0LjM1NjMsLTcuNjU3MDUiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci0xMCkiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik0xMzIuNzU2NTMsMzc2LjU1NjcyYzAsMCAyMy42NjYyOSwtNzIuOTM5NDcgNjIuNzc2MTcsLTg4LjYzNjA2YzkuMTkxNDgsLTMuNjg4OTYgMTIuNzc1Nyw1MC40NjgyOCAyMS42NzEzNyw2Ni4xNTgwNGM3LjE3NzQ3LDEyLjY1OTI4IDIwLjM5NjExLDguMjI0NjMgMjcuODY2ODgsMy4xNjUyM2MyNi43MjgyMSwtMTguMTAxMDMgNDcuNDk1MTQsLTY4Ljk2MjMyIDYzLjg1NDYsLTc5Ljk4NjY4YzE1LjYzMDY3LC0xMC41MzMyMyAzLjg1MDc3LDExNi4xNDYyNCAyOS41NjUwMiwxNDYuNjYyNWMzLjU1ODkyLDQuMjIzNTMgNTcuMjY3NTEsLTcuNTM0OTMgMTAwLjQwOTksLTU3LjgxNDFjMzguMzI2NzQsLTQ0LjY2NjkgODQuNzQxOCwtODIuNTAzMDggODYuMTg3NTgsLTgyLjk5Njk3IiBmaWxsPSJub25lIiBzdHJva2U9IiM0NjlmOWYiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik0xMjkuNDc1MTYsMzY2LjEyODQ3YzkuODIxNzQsLTQ3LjU1NjQgNzEuODI5NTcsLTEwMS44NzM4NSA3NS4zNzUxLC04Ny40MTA2NGM5LjYxNzEzLDM5LjIzMDg5IC0zLjEzNjcyLDk0LjMwOTI0IDM2Ljc1ODY4LDY3LjMwNzhjMjkuNjg0OTUsLTIwLjA5MDk1IDUxLjg1OTE2LC03MC42NjA1NyA2OS4xMDAwMiwtODIuMjc4ODhjMTUuNjMwNjcsLTEwLjUzMzIzIC01LjE1Mzc0LDEyMi4xNDkyNCAyMC41NjA1MSwxNTIuNjY1NWM0LjcwMjMyLDUuNTgwNDUgNjEuMzQzNDMsLTEzLjk0MjM3IDEwOS41MTI3NSwtNzAuNjk4OTVjMjAuNjc0NiwtMjQuMzYwMzIgODIuMTY0ODIsLTc2LjU1MDIxIDgzLjA4Nzc0LC03Ni44NjU0OSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTExKSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PC9nPjwvZz48L3N2Zz48IS0tcm90YXRpb25DZW50ZXI6Mjg4LjUzMzc2MDAwMDAwMDAzOjI0Ny40NjU3Mi0tPg==";

const witcat_input_icon = "data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIxNzcuMDg4NTUiIGhlaWdodD0iMTc3LjA4ODU1IiB2aWV3Qm94PSIwLDAsMTc3LjA4ODU1LDE3Ny4wODg1NSI+PGRlZnM+PGxpbmVhckdyYWRpZW50IHgxPSIyNTYuMTkzNTYiIHkxPSIxMzcuNDg0NzQiIHgyPSIyNTYuMTkzNTYiIHkyPSIyNDcuOTMwNTciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYWVjN2M3Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjOTZjMmMyIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjI2OS4yNjY2NyIgeTE9IjE0Mi4wNzM1MSIgeDI9IjI2OS4yNjY2NyIgeTI9IjI0Ni45NzE4NiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci0yIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNmMWZmZmYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNjY2ZmZmYiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjQxLjM4MTcxIiB5MT0iMTYwLjIxMTg0IiB4Mj0iMjQxLjM4MTcxIiB5Mj0iMjA2LjA3NDE5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTMiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2FmYzljOSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2JhZDhkOCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNTEuNDU1NzYsLTkxLjQ1NTc0KSI+PGcgZGF0YS1wYXBlci1kYXRhPSJ7JnF1b3Q7aXNQYWludGluZ0xheWVyJnF1b3Q7OnRydWV9IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZS13aWR0aD0iMCIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxwYXRoIGQ9Ik0xNTEuNDU1NzYsMjY4LjU0NDI5di0xNzcuMDg4NTVoMTc3LjA4ODU1djE3Ny4wODg1NXoiIGZpbGw9IiM1MmJhYmEiIHN0cm9rZT0ibm9uZSIvPjxwYXRoIGQ9Ik0xODMuODQyODMsMjAyLjM2MzY5YzAsLTE0LjkyMDUzIDAsLTI1LjM5MzAzIDAsLTM0LjMyOTA0YzAsLTE0LjkyNTM0IDguNzc3OTYsLTMwLjA0OTc1IDMxLjA5MzgsLTMwLjA0OTc1YzE2LjE3NDcsMCAxMTMuNjA3NjgsLTAuNTAwMTYgMTEzLjYwNzY4LC0wLjUwMDE2djcyLjkwNzI2YzAsMCAtMTguMDI5MzEsMS4xMzgxIC0yNy4wMDksNi42NzA4Yy0xMy43NDA0NSw4LjQ2NTk3IC0xMy45MzQ4NSwtMi42NTIxNiAtMjguMDE5MjUsNS4yMjgzNGMtMTAuOTg5MzMsNi4xNDg3NSAtMTEuODEyNzQsMjUuNDg4MSAtMjAuMDM1ODksMjUuNjM4NDJjLTkuNzM0NDQsMC4xNzc5NCAtMTQuMjg3MDgsLTIzLjI1NDM2IC0yNC4wNTU4MSwtMjYuNDY5MDFjLTE0LjM0MDA2LC00LjcxODk1IC0yMi43NTc1Nyw0LjA1NDM5IC0yNi42MDgwMSw0LjE2OTIzYy0xMS41NTk5NywwLjM0NDc3IC0xOC45NzM1MSwtMTYuNjE4OTYgLTE4Ljk3MzUxLC0yMy4yNjYwOHoiIGZpbGw9InVybCgjY29sb3ItMSkiIHN0cm9rZT0iI2NjZmZmZiIvPjxwYXRoIGQ9Ik0xODkuODU0ODMsMjA0LjI1NjljMCwtMTQuMzAwNjIgMCwtMjIuMTM1MjggMCwtMzAuNzAwMDJjMCwtMTQuMzA1MjIgOC40MTMyNSwtMjguODAxMjUgMjkuODAxOTIsLTI4LjgwMTI1YzE1LjUwMjY4LDAgMTA4Ljg4NzU2LC0wLjQ3OTM4IDEwOC44ODc1NiwtMC40NzkzOGMwLDAgMCw1LjQ5OTQxIDAsMTAuMzM2N2MwLDExLjM5MjkxIDAsNTcuMzM4NjkgMCw1Ny4zMzg2OWMwLDAgLTE3LjI4MDI0LDEuMDkwODEgLTI1Ljg4Njg0LDYuMzkzNjVjLTEzLjE2OTU3LDguMTE0MjIgLTEzLjM1NTg4LC0yLjU0MTk4IC0yNi44NTUxMiw1LjAxMTEyYy0xMC41MzI3NSw1Ljg5MzI4IC0xMS4zMjE5NSwyNC40MjkxMiAtMTkuMjAzNDUsMjQuNTczMmMtOS4zMjk5OSwwLjE3MDU1IC0xMy42OTM0OSwtMjIuMjg4MTkgLTIzLjA1NjM1LC0yNS4zNjkyOWMtMTMuNzQ0MjcsLTQuNTIyODkgLTIxLjgxMjA2LDMuODg1OTMgLTI1LjUwMjUyLDMuOTk2Yy0xMS4wNzk2OCwwLjMzMDQ0IC0xOC4xODUyMSwtMTUuOTI4NDcgLTE4LjE4NTIxLC0yMi4yOTk0M3oiIGZpbGw9InVybCgjY29sb3ItMikiIHN0cm9rZT0iI2NjZmZmZiIvPjxnPjxwYXRoIGQ9Ik0yMzMuNDE0MTgsMjA2LjA3NDE5bDAuMDcwNzksLTUuMzgxNjRsNS4wODM2MiwwLjA4MzM0di00MC41NjQwM2g1Ljg2MzcydjQwLjY0NzM3aDQuOTE2OTR2NS4xOTYyMnoiIGZpbGw9InVybCgjY29sb3ItMykiIHN0cm9rZT0iIzAwMDAwMCIvPjxwYXRoIGQ9Ik0yMzMuNDE2NDcsMTY1LjE4NzMydi01LjI0MTIyaDE2LjE2Nzg0djUuMjQxMjJ6IiBmaWxsPSIjYWZjOWM5IiBzdHJva2U9Im5vbmUiLz48L2c+PGcgZmlsbD0iIzQ5YTdhNyI+PHBhdGggZD0iTTIzNy4wNjgyMiwyMDMuMDU0Njl2LTQ1Ljg0MzU5aDUuODYzNzJ2NDUuODQzNTl6IiBzdHJva2U9IiMwMDAwMDAiLz48cGF0aCBkPSJNMjMxLjkxNjEsMTYyLjE4NjU4di01LjI0MTIyaDE2LjE2Nzg0djUuMjQxMjJ6IiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJNMjMxLjkxNjEsMjAzLjEzMDAydi01LjI0MTIzaDE2LjE2Nzg0djUuMjQxMjN6IiBzdHJva2U9Im5vbmUiLz48L2c+PC9nPjwvZz48L3N2Zz48IS0tcm90YXRpb25DZW50ZXI6ODguNTQ0MjQ0OTk5OTk5OTk6ODguNTQ0MjU1MDAwMDAwMDItLT4=";

const witcat_input_extensionId = "WitCatInput";

/** @typedef {string|number} SCarg Êù•Ëá™ScratchÂúÜÂΩ¢Ê°ÜÁöÑÂèÇÊï∞ÔºåËôΩÁÑ∂Ëøô‰∏™Ê°ÜÂèØËÉΩÂè™ËÉΩËæìÂÖ•Êï∞Â≠óÔºå‰ΩÜÊòØÂèØ‰ª•ÊîæÂÖ•ÂèòÈáèÔºåÂõ†Ê≠§ÊúâÂèØËÉΩËé∑ÂæóÊï∞Â≠óÂíåÊñáÊú¨ÔºåÈúÄË¶ÅÂêåÊó∂Â§ÑÁêÜ */

/** @type {{[key: string]: true}} */
let keypress = {};
let lastKey = "", MouseWheel = 0;
/** @type {number|undefined} */
let timer = undefined;
/** @type {{[key: string]: number}} */
let inputFontSize = {};
let adaptive = false;
/** @type {MutationObserver} */
let observer;

//ÊâæÊ∏≤Êüìcvs
/** @type {HTMLCanvasElement} */
let cvs = document.getElementsByTagName("canvas")[0];
if (cvs === null) {
	alert("ÂΩìÂâçÈ°µÈù¢‰∏çÊîØÊåÅËæìÂÖ•Ê°ÜÔºåËØ∑ÂâçÂæÄ‰ΩúÂìÅËØ¶ÊÉÖÈ°µ‰ΩìÈ™åÂÆåÊï¥‰ΩúÂìÅÔºÅ");
}
else {
	for (let i = 1; cvs.className !== "" && i <= document.getElementsByTagName("canvas").length; i++) {
		cvs = document.getElementsByTagName("canvas")[i];
	}
	if (cvs === null) {
		alert("ÂΩìÂâçÈ°µÈù¢‰∏çÊîØÊåÅËæìÂÖ•Ê°ÜÔºåËØ∑ÂâçÂæÄ‰ΩúÂìÅËØ¶ÊÉÖÈ°µ‰ΩìÈ™åÂÆåÊï¥‰ΩúÂìÅÔºÅ");
	}
}

class WitCatInput {
	constructor(runtime) {
		this.runtime = runtime;
		this._formatMessage = runtime.getFormatMessage({
			"zh-cn": {
				"WitCatInput.name": "[beta]ÁôΩÁå´ÁöÑËæìÂÖ•Ê°Ü",
				"WitCatInput.createinput": "ÂàõÂª∫Êàñ‰øÆÊîπ[type]ÊñáÊú¨Ê°ÜÂπ∂ÂëΩÂêç‰∏∫[id]ÔºåX[x]Y[y]ÂÆΩ[width]È´ò[height]ÂÜÖÂÆπ[text]È¢úËâ≤[color]ÊèêÁ§∫[texts]Â≠ó‰ΩìÂ§ßÂ∞è[size]",
				"WitCatInput.deleteinput": "Âà†Èô§ÊñáÊú¨Ê°Ü[id]",
				"WitCatInput.getinput": "Ëé∑ÂæóÊñáÊú¨Ê°Ü[id]ÁöÑ[type]",
				"WitCatInput.isinput": "ÁÑ¶ÁÇπÊòØÂê¶Âú®ÊñáÊú¨Ê°Ü[id]‰∏ä",
				"WitCatInput.whatinput": "ÁÑ¶ÁÇπ‰ΩçÁΩÆ",
				"WitCatInput.nowinput": "Â∞ÜÁÑ¶ÁÇπËÅöÁÑ¶Âú®ÊñáÊú¨Ê°Ü[id]‰∏ä",
				"WitCatInput.deleteallinput": "Âà†Èô§ÊâÄÊúâÊñáÊú¨Ê°Ü",
				"WitCatInput.compute": "ÂΩìÂâçÂàÜËæ®Áéá‰∏ãÈ´ò[size]ÁöÑÂ≠ó‰ΩìÂ§ßÂ∞è",
				"WitCatInput.type.1": "ÂçïË°å",
				"WitCatInput.type.2": "Â§öË°å",
				"WitCatInput.number": "Á¨¨[num]‰∏™ÊñáÊú¨Ê°ÜÁöÑ[type]",
				"WitCatInput.numbers": "ÊñáÊú¨Ê°ÜÁöÑÊï∞Èáè",
				"WitCatInput.number.1": "X",
				"WitCatInput.number.2": "Y",
				"WitCatInput.number.3": "ÂÆΩ",
				"WitCatInput.number.4": "È´ò",
				"WitCatInput.number.5": "ÂÜÖÂÆπ",
				"WitCatInput.number.6": "È¢úËâ≤",
				"WitCatInput.number.7": "ÊèêÁ§∫",
				"WitCatInput.number.8": "Â≠ó‰ΩìÂ§ßÂ∞è",
				"WitCatInput.number.9": "ÊâÄÊúâ(json)",
				"WitCatInput.number.10": "ID",
				"WitCatInput.number.11": "ÊªöÂä®‰ΩçÁΩÆ",
				"WitCatInput.number.12": "ÊñáÊú¨È´òÂ∫¶",
				"WitCatInput.number.13": "ÂÖâÊ†á‰ΩçÁΩÆ",
				"WitCatInput.number.14": "ÈÄèÊòéÂ∫¶",
				"WitCatInput.number.15": "ËÉåÊôØÂõæÁâá",
				"WitCatInput.number.16": "Â≠ó‰Ωì",
				"WitCatInput.number.17": "Ë°åÈ´ò",
				"WitCatInput.number.18": "Â≠ó‰ΩìÁ≤óÁªÜ",
				"WitCatInput.number.19": "Èò¥ÂΩ±",
				"WitCatInput.fontweight": "ËÆæÁΩÆÊñáÊú¨Ê°Ü[id]ÁöÑÂ≠ó‰ΩìÁ≤óÁªÜ‰∏∫[text]", // Âú®ÊñáÊ°£‰∏≠ÊèêÁ§∫Áî®Êà∑Â≠ó‰ΩìÂÖºÂÆπÊÄßÈóÆÈ¢òÔºåÂπ∂Êé®ËçêÂêàÈÄÇÁöÑÂ≠ó‰Ωì
				"WitCatInput.normal": "Â∏∏ËßÑ",
				"WitCatInput.bold": "Á≤ó‰Ωì",
				"WitCatInput.thin": "ÁªÜ‰Ωì",
				"WitCatInput.key": "Êåâ‰∏ãÊåâÈîÆ[type]?",
				"WitCatInput.keys": "Êåâ‰∏ãÊåâÈîÆ[type]?",
				"WitCatInput.keypress": "Êåâ‰∏ãÁöÑÊåâÈîÆ",
				"WitCatInput.lastkey": "‰∏äÊ¨°Êåâ‰∏ãÁöÑÈîÆ",
				"WitCatInput.mousewheel": "Èº†Ê†áÊªöËΩÆÈÄüÂ∫¶", // Ëøô‰∏™ÁßØÊú®Â∫îËØ•Âú® More_Mouse ÈáåÔºü
				"WitCatInput.setinput": "ËÆæÁΩÆÊñáÊú¨Ê°Ü[id]ÁöÑ[type]‰∏∫[text]",
				"WitCatInput.setread": "ËÆæÁΩÆÊñáÊú¨Ê°Ü[id]‰∏∫[read]", // ÈáçÂ§ç‰ΩøÁî®‰∏âÊ¨°Ôºü
				"WitCatInput.setfontfamily": "ËÆæÁΩÆÊñáÊú¨Ê°Ü[id]Â≠ó‰Ωì‰ªé[text]Âä†ËΩΩÂ≠ó‰ΩìÂêç[name]", // ÂàÜÊàê‚ÄúÂä†ËΩΩ‚ÄùÂíå‚Äú‰ΩøÁî®‚Äù
				"WitCatInput.read.1": "ÂèØÁºñËæë",
				"WitCatInput.read.2": "‰∏çÂèØÁºñËæë",
				"WitCatInput.password.1": "ÊñáÊú¨Ê°Ü",
				"WitCatInput.password.2": "ÂØÜÁ†ÅÊ°Ü",
				"WitCatInput.textalign.1": "Â∑¶ÂØπÈΩê",
				"WitCatInput.textalign.2": "‰∏≠ÂØπÈΩê",
				"WitCatInput.textalign.3": "Âè≥ÂØπÈΩê",
				"WitCatInput.docs": "üìñÊãìÂ±ïÊïôÁ®ã",
				"WitCatInput.input": "ËæìÂÖ•Ê°Ü",
				"WitCatInput.focal": "ÁÑ¶ÁÇπ",
				"WitCatInput.keyboard": "ÈîÆÁõò",
				"WitCatInput.shadow": "Èò¥ÂΩ±x[x]y[y]ÂÆΩ[width]È¢úËâ≤[color]",
				"WitCatInput.fontadaptive": "Â≠ó‰ΩìÂ§ßÂ∞èËá™ÈÄÇÂ∫î[type]",
				"WitCatInput.set.1": "ÂêØÁî®",
				"WitCatInput.set.2": "Á¶ÅÁî®",
			},
			en: {
				"WitCatInput.name": "[beta]WitCat‚Äòs Input",
				"WitCatInput.createinput": "Create or modify [type]input ID[id]X[x]Y[y]width[width]height[height]content[text]color[color]prompt[texts]fontSize[size]",
				"WitCatInput.deleteinput": "Delete input[id]",
				"WitCatInput.getinput": "[type] of input [id]",
				"WitCatInput.isinput": "input [id] received focus?",
				"WitCatInput.whatinput": "focused input id",
				"WitCatInput.nowinput": "Focus on input [id]",
				"WitCatInput.deleteallinput": "Delete all inputs",
				"WitCatInput.compute": "Font size of now screen[size]",
				"WitCatInput.type.1": "single-line",
				"WitCatInput.type.2": "multi-line",
				"WitCatInput.number": "[type]of input[num]",
				"WitCatInput.numbers": "input count",
				"WitCatInput.number.1": "X",
				"WitCatInput.number.2": "Y",
				"WitCatInput.number.3": "width",
				"WitCatInput.number.4": "height",
				"WitCatInput.number.5": "content",
				"WitCatInput.number.6": "color",
				"WitCatInput.number.7": "prompt",
				"WitCatInput.number.8": "font size",
				"WitCatInput.number.9": "all(json)",
				"WitCatInput.number.10": "ID",
				"WitCatInput.number.11": "scroll position",
				"WitCatInput.number.12": "text height",
				"WitCatInput.number.13": "cursor position ",
				"WitCatInput.number.14": "transparency",
				"WitCatInput.number.15": "background",
				"WitCatInput.number.16": "font family",
				"WitCatInput.number.17": "line height",
				"WitCatInput.number.18": "font weight",
				"WitCatInput.number.19": "shadow",
				"WitCatInput.fontweight": "Set fontweight of input[id] to[text]",
				"WitCatInput.normal": "normal",
				"WitCatInput.bold": "bold",
				"WitCatInput.thin": "thin",
				"WitCatInput.key": "key[type]pressed?",
				"WitCatInput.keys": "When key [type] pressed",
				"WitCatInput.keypress": "pressed keys",
				"WitCatInput.lastkey": "last key pressed",
				"WitCatInput.mousewheel": "mouse wheel speed",
				"WitCatInput.setinput": "Set[type]of input[id]to[text]",
				"WitCatInput.setread": "Set input[id]to[read]",
				"WitCatInput.setfontfamily": "ID[id]`s font family url[text] name [name]",
				"WitCatInput.read.1": "editable",
				"WitCatInput.read.2": "uneditable",
				"WitCatInput.password.1": "text",
				"WitCatInput.password.2": "password",
				"WitCatInput.textalign.1": "left",
				"WitCatInput.textalign.2": "center",
				"WitCatInput.textalign.3": "right",
				"WitCatInput.docs": "üìñTutorials",
				"WitCatInput.input": "text area",
				"WitCatInput.focal": "focal",
				"WitCatInput.keyboard": "keyboard",
				"WitCatInput.shadow": "shadow x[x]y[y]weight[width]color[color]",
				"WitCatInput.fontadaptive": "[type]font size adaptation",
				"WitCatInput.set.1": "Enable",
				"WitCatInput.set.2": "Disable",
			}
		})
	}

	/**
	 * ÁøªËØë
	 * @param {string} id
	 * @returns {string}
	 */
	formatMessage(id) {
		return this._formatMessage({
			id,
			default: id,
			description: id
		});
	}

	getInfo() {
		return {
			id: witcat_input_extensionId, // ÊãìÂ±ïid
			name: this.formatMessage("WitCatInput.name"), // ÊãìÂ±ïÂêç
			blockIconURI: witcat_input_icon,
			menuIconURI: witcat_input_icon,
			color1: "#52baba",
			color2: "#459c9c",
			blocks: [
				{
					blockType: "button",
					text: this.formatMessage('WitCatInput.docs'),
					onClick: this.docs,
				},
				"---" + this.formatMessage('WitCatInput.input'),
				{
					opcode: "createinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.createinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "type",
						},
						x: {
							type: "number",
							defaultValue: "0",
						},
						y: {
							type: "number",
							defaultValue: "0",
						},
						width: {
							type: "number",
							defaultValue: "100",
						},
						height: {
							type: "number",
							defaultValue: "20",
						},
						text: {
							type: "string",
							defaultValue: "hello world!",
						},
						color: {
							type: "string",
							defaultValue: "#000000",
						},
						texts: {
							type: "string",
							defaultValue: "hello world!",
						},
						size: {
							type: "number",
							defaultValue: "16",
						}
					},
				},
				{
					opcode: "setinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "typess",
						},
						text: {
							type: "string",
							defaultValue: "10",
						},
					},
				},
				{
					opcode: "shadow",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.shadow"),
					arguments: {
						x: {
							type: "number",
							defaultValue: "0",
						},
						y: {
							type: "number",
							defaultValue: "0",
						},
						width: {
							type: "number",
							defaultValue: "3",
						},
						color: {
							type: "string",
							defaultValue: "#000000",
						},
					},
				},
				{
					opcode: "fontweight",
					blockType: "command",
					text: this.formatMessage("WitCatInput.fontweight"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						text: {
							type: "string",
							menu: "fontweight",
						},
					},
				},
				{
					opcode: "setread",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setread"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						read: {
							type: "string",
							menu: "read",
						},
					},
				},
				{
					opcode: "password",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setread"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						read: {
							type: "string",
							menu: "password",
						},
					},
				},
				{
					opcode: "textalign",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setread"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						read: {
							type: "string",
							menu: "textalign",
						},
					},
				},
				{
					opcode: "setfont",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setfontfamily"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						text: {
							type: "string",
							defaultValue: "url",
						},
						name: {
							type: "string",
							defaultValue: "arial",
						},
					},
				},
				{
					opcode: "compute",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.compute"),
					arguments: {
						size: {
							type: "number",
							defaultValue: "16",
						}
					},
				},
				{
					opcode: "getinput",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.getinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "types",
						}
					},
				},
				{
					opcode: "number",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.number"),
					arguments: {
						num: {
							type: "number",
							defaultValue: "1",
						},
						type: {
							type: "string",
							menu: "types",
						}
					},
				},
				{
					opcode: "numbers",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.numbers"),
					arguments: {},
				},
				{
					opcode: "deleteinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.deleteinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						}
					},
				},
				{
					opcode: "deleteallinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.deleteallinput"),
					arguments: {},
				},
				{
					opcode: "fontadaptive",
					blockType: "command",
					text: this.formatMessage("WitCatInput.fontadaptive"),
					arguments: {
						type: {
							type: "Boolean",
							menu: "set",
						}
					},
				},
				"---" + this.formatMessage('WitCatInput.focal'),
				{
					opcode: "isinput",
					blockType: "Boolean",
					text: this.formatMessage("WitCatInput.isinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						}
					},
				},
				{
					opcode: "whatinput",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.whatinput"),
					arguments: {},
				},
				{
					opcode: "nowinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.nowinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						}
					},
				},
				"---" + this.formatMessage('WitCatInput.keyboard'),
				{
					opcode: "key",
					blockType: "Boolean",
					text: this.formatMessage("WitCatInput.key"),
					arguments: {
						type: {
							type: "string",
							defaultValue: "KeyA",
						}
					},
				},
				{
					opcode: "mousewheel",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.mousewheel"),
					arguments: {},
				},
				{
					opcode: "keys",
					blockType: "hat",
					text: this.formatMessage("WitCatInput.keys"),
					func: false,
					arguments: {
						type: {
							type: "string",
							defaultValue: "KeyA",
						}
					},
				},
				{
					opcode: "lastkey",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.lastkey"),
					func: false,
					arguments: {},
				},
				{
					opcode: "keypress",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.keypress"),
					func: false,
					arguments: {},
				},
			],
			menus: {
				type: [
					{
						text: this.formatMessage('WitCatInput.type.1'),
						value: 'input'
					},
					{
						text: this.formatMessage('WitCatInput.type.2'),
						value: 'Textarea'
					},
				],
				types: [
					{
						text: this.formatMessage('WitCatInput.number.10'),
						value: 'ID'
					},
					{
						text: this.formatMessage('WitCatInput.number.1'),
						value: 'X'
					},
					{
						text: this.formatMessage('WitCatInput.number.2'),
						value: 'Y'
					},
					{
						text: this.formatMessage('WitCatInput.number.3'),
						value: 'width'
					},
					{
						text: this.formatMessage('WitCatInput.number.4'),
						value: 'height'
					},
					{
						text: this.formatMessage('WitCatInput.number.5'),
						value: 'content'
					},
					{
						text: this.formatMessage('WitCatInput.number.6'),
						value: 'color'
					},
					{
						text: this.formatMessage('WitCatInput.number.7'),
						value: 'prompt'
					},
					{
						text: this.formatMessage('WitCatInput.number.8'),
						value: 'font-size'
					},
					{
						text: this.formatMessage('WitCatInput.number.11'),
						value: 'rp'
					},
					{
						text: this.formatMessage('WitCatInput.number.12'),
						value: 'th'
					},
					{
						text: this.formatMessage('WitCatInput.number.13'),
						value: 'cp'
					},
					{
						text: this.formatMessage('WitCatInput.number.14'),
						value: 'op'
					},
					{
						text: this.formatMessage('WitCatInput.number.15'),
						value: 'bg'
					},
					{
						text: this.formatMessage('WitCatInput.number.16'),
						value: 'ff'
					},
					{
						text: this.formatMessage('WitCatInput.number.17'),
						value: 'lh'
					},
					{
						text: this.formatMessage('WitCatInput.number.18'),
						value: 'fw'
					},
					{
						text: this.formatMessage('WitCatInput.number.19'),
						value: 'ts'
					},
					{
						text: this.formatMessage('WitCatInput.number.9'),
						value: 'json'
					},
				],
				typess: [
					{
						text: this.formatMessage('WitCatInput.number.1'),
						value: 'X'
					},
					{
						text: this.formatMessage('WitCatInput.number.2'),
						value: 'Y'
					},
					{
						text: this.formatMessage('WitCatInput.number.3'),
						value: 'width'
					},
					{
						text: this.formatMessage('WitCatInput.number.4'),
						value: 'height'
					},
					{
						text: this.formatMessage('WitCatInput.number.5'),
						value: 'content'
					},
					{
						text: this.formatMessage('WitCatInput.number.6'),
						value: 'color'
					},
					{
						text: this.formatMessage('WitCatInput.number.7'),
						value: 'prompt'
					},
					{
						text: this.formatMessage('WitCatInput.number.8'),
						value: 'font-size'
					},
					{
						text: this.formatMessage('WitCatInput.number.11'),
						value: 'rp'
					},
					{
						text: this.formatMessage('WitCatInput.number.13'),
						value: 'cp'
					},
					{
						text: this.formatMessage('WitCatInput.number.14'),
						value: 'op'
					},
					{
						text: this.formatMessage('WitCatInput.number.15'),
						value: 'bg'
					},
					{
						text: this.formatMessage('WitCatInput.number.17'),
						value: 'lh'
					},
					{
						text: this.formatMessage('WitCatInput.number.19'),
						value: 'ts'
					},
					{
						text: '‚ö†css',
						value: 'css'
					},
				],
				read: [
					{
						text: this.formatMessage('WitCatInput.read.1'),
						value: 'eb'
					},
					{
						text: this.formatMessage('WitCatInput.read.2'),
						value: 'ue'
					},
				],
				password: [
					{
						text: this.formatMessage('WitCatInput.password.1'),
						value: 'text'
					},
					{
						text: this.formatMessage('WitCatInput.password.2'),
						value: 'password'
					},
				],
				textalign: [
					{
						text: this.formatMessage('WitCatInput.textalign.1'),
						value: 'left'
					},
					{
						text: this.formatMessage('WitCatInput.textalign.2'),
						value: 'center'
					},
					{
						text: this.formatMessage('WitCatInput.textalign.3'),
						value: 'right'
					},
				],
				fontweight: {
					acceptReporters: true,
					items: [
						{
							text: `100(${this.formatMessage('WitCatInput.thin')})`,
							value: '100'
						},
						{
							text: '200',
							value: '200'
						},
						{
							text: '300',
							value: '300'
						},
						{
							text: `400(${this.formatMessage('WitCatInput.normal')})`,
							value: '400'
						},
						{
							text: '500',
							value: '500'
						},
						{
							text: '600',
							value: '600'
						},
						{
							text: `700(${this.formatMessage('WitCatInput.bold')})`,
							value: '700'
						},
						{
							text: '800',
							value: '800'
						},
						{
							text: '900',
							value: '900'
						},
					],
				},
				set: [
					{
						text: this.formatMessage('WitCatInput.set.1'),
						value: 'true'
					},
					{
						text: this.formatMessage('WitCatInput.set.2'),
						value: 'false'
					},
				],
			}
		};
	}

	/**
	 * ÊâìÂºÄÊïôÁ®ã
	 * @returns {void}
	 */
	docs() {
		let a = document.createElement('a');
		a.href = "https://www.ccw.site/post/6153a7a6-05fb-462e-b785-b97700b12bc2";
		a.rel = "noopener noreferrer";
		a.target = "_blank";
		a.click();
	}

	/**
	 * ÈôêÂà∂ÂÄºÁöÑËåÉÂõ¥ÔºåÂ¶ÇÊûúÂÄºÊòØNaNÔºåËøîÂõûÊúÄÂ∞èÂÄº
	 * @param {number} x Êï∞ÂÄº
	 * @param {number} min ÊúÄÂ∞èÂÄº
	 * @param {number} max ÊúÄÂ§ßÂÄº
	 * @return {number}
	 */
	_clamp(x, min, max) {
		return isNaN(x) ? min : x < min ? min : x > max ? max : x;
		// return isNaN(x) ? min : Math.min(max, Math.max(min, x));
	}

	/**
	 * ËÆæÁΩÆÊàñÂàõÂª∫ÊñáÊú¨Ê°Ü
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @param {SCarg} args.type ÊñáÊú¨Ê°ÜÁ±ªÂûã "input"|"textarea"
	 * @param {SCarg} args.x Â∑¶‰∏äËßíx
	 * @param {SCarg} args.y Â∑¶‰∏äËßíy
	 * @param {SCarg} args.width ÂÆΩÂ∫¶
	 * @param {SCarg} args.height È´òÂ∫¶
	 * @param {SCarg} args.text ÂàùÂßãÊñáÊú¨
	 * @param {SCarg} args.color ÊñáÂ≠óÈ¢úËâ≤
	 * @param {SCarg} args.texts ÊèêÁ§∫ÊñáÊú¨
	 * @param {SCarg} args.size ÊñáÂ≠óÂ§ßÂ∞è 
	 */
	createinput(args) {
		let x = Number(args.x);
		let y = Number(args.y);
		let width = Number(args.width);
		let height = Number(args.height);
		x = this._clamp(x, 0, this.runtime.stageWidth);
		y = this._clamp(y, 0, this.runtime.stageHeight);
		width = this._clamp(width, 0, this.runtime.stageWidth - x);
		height = this._clamp(height, 0, this.runtime.stageHeight - y);
		x = (x / this.runtime.stageWidth) * 100;
		y = (y / this.runtime.stageHeight) * 100;
		width = (width / this.runtime.stageWidth) * 100;
		height = (height / this.runtime.stageHeight) * 100;

		let search = document.getElementById("WitCatInput" + args.id);
		// ËøôÈáåÈÄöËøá‚ÄúÂ¶ÇÊûú‰∏çÁ¨¶ÂêàÔºåÂ∞±Âà†Èô§ÔºõÂ¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂ∞±Âª∫Á´ã‚ÄùÁöÑÊñπÂºèÔºå
		// ÈÅøÂÖçÂêéÈù¢Â§ßÈáèÂ§çÂà∂Á≤òË¥¥Ê†∑ÂºèÊìç‰Ωú„ÄÇ
		// Â§ßÊÆµÁöÑÂ§çÂà∂Á≤òË¥¥ÂæÄÂæÄÊÑèÂë≥ÁùÄ‰πãÂêé‰ºöÁäØÈîôÔºàÂè™Êîπ‰∏ÄÂçäÔºâ
		if (search !== null && search.name !== args.type) {
			cvs.parentNode.removeChild(search);
			search = null;
		}
		if (search === null) {
			search = document.createElement(args.type);
			if (args.type === "input") {
				search.type = "text";
			}
			search.id = "WitCatInput" + args.id;
			search.value = args.text;
			search.className = "WitCatInput";
			search.name = args.type;
			search.placeholder = args.texts;
			cvs.parentNode.appendChild(search);
		}

		// Áé∞Âú®Áõ¥Êé•ÈÄöËøástyleÁöÑÂ±ûÊÄß‰øÆÊîπÊ†∑ÂºèË°®Ôºå‰∏çÈúÄË¶ÅÊãÖÂøÉ‚ÄúÂàÜÂè∑Ê≥®ÂÖ•‚ÄùÈóÆÈ¢ò‰∫Ü
		let sstyle = search.style;
		sstyle.backgroundColor = "transparent";
		sstyle.border = "0px";
		sstyle.textShadow = "0 0 0 #000";
		sstyle.outline = "none";
		sstyle.position = "absolute";
		sstyle.left = `${x}%`;
		sstyle.top = `${y}%`;
		sstyle.width = `${width}%`;
		sstyle.height = `${height}%`;
		sstyle.fontSize = `${Number(adaptive ? (Number(cvs.style.width.split("px")[0]) / 360) * args.size : args.size)}px`;
		sstyle.resize = "none";
		sstyle.color = args.color;
		sstyle.opacity = "1";
		sstyle.backgroundSize = "100% 100%";
		search.value = args.text;
		search.placeholder = args.texts;

		inputFontSize[args.id] = args.size;
	}

	/**
	 * Âà†Èô§ÊñáÊú¨Ê°Ü
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Üid
	 */
	deleteinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			cvs.parentNode.removeChild(search);
		}
	}

	/**
	 * Ëé∑ÂèñÊñáÊú¨Ê°ÜÂÜÖÂÆπ
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Üid
	 * @param {SCarg} args.type ÂÜÖÂÆπÁ±ªÂûã
	 * @return {SCarg}
	 */
	getinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		return search === null ? "" : this._getattrib(search, args.type);
	}

	/**
	 * ÁÑ¶ÁÇπÂà§Êñ≠
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @returns {boolean}
	 */
	isinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			if (search === document.activeElement) {
				return true;
			}
			else {
				return false;
			}
		}
		else {
			return false;
		}
	}

	/**
	 * ÁÑ¶ÁÇπ‰ΩçÁΩÆ
	 * @returns {string} ÊñáÊú¨Ê°Ü ID
	 */
	whatinput() {
		if (document.activeElement.className === "WitCatInput") {
			return document.activeElement.id.split("WitCatInput")[1];
		}
		else {
			return "";
		}
	}

	/**
	 * ÁÑ¶ÁÇπËé∑Âèñ
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 */
	nowinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			search.focus();
		}
		else if (document.activeElement.className === "WitCatInput") {
			document.activeElement.blur();
		}
	}

	/**
	 * Âà†Èô§ÊâÄÊúâÊñáÊú¨Ê°Ü
	 */
	deleteallinput() {
		let search = document.getElementsByClassName("WitCatInput");
		let i = 0;
		for (i = search.length - 1; i >= 0; i--) {
			search[i].parentNode.removeChild(search[i]);
		}
	}

	/**
	 * ËÆ°ÁÆóÊñáÂ≠óÂ§ßÂ∞è
	 * @param {object} args
	 * @param {SCarg} args.size Scratch ÊñáÂ≠óÂ§ßÂ∞è
	 */
	compute(args) {
		return (Number(cvs.style.width.split("px")[0]) / 360) * args.size;
	}

	/**
	 * Ëé∑ÂèñÊåáÂÆöÁºñÂè∑ÁöÑÊñáÊú¨Ê°ÜÂ±ûÊÄß
	 * @param {object} args
	 * @param {SCarg} args.num ÊñáÊú¨Ê°ÜÂ∫èÂè∑
	 * @param {SCarg} args.type Â±ûÊÄßÁ±ªÂûã
	 * @returns {SCarg}
	 */
	number(args) {
		let searchall = document.getElementsByClassName("WitCatInput");
		let index = Number(args.num);
		if (searchall.length >= index && index > 0) {
			let search = searchall[index - 1];
			return this._getattrib(search, args.type);
		} else {
			return "";
		}
	}

	/**
	 * Ëé∑ÂèñÊñáÊú¨Ê°ÜÁöÑÂ±ûÊÄß
	 * @param {Element} element ÊñáÊú¨Ê°ÜÂÖÉÁ¥†
	 * @param {string} type Â±ûÊÄßÁ±ªÂûã
	 * @returns {number|string}
	 */
	_getattrib(element, type) {
		// Áî®‰∫éÈÄöËøáÁ±ªÂûãÊ£ÄÊü•ÔºåÁ°Æ‰øù‰∏çÂá∫Èîô
		if (!(element instanceof HTMLInputElement || element instanceof HTMLTextAreaElement)) {
			console.warn("Input.js: Ëé∑ÂèñÂà∞ÁöÑÂÖÉÁ¥†ÁöÑÁ±ªÂûã‰∏çÊ≠£Á°Æ: ", element);
			return "";
		}
		switch (type) {
			case "X":
				return (Number(element.style.left.split("%")[0]) / 100) * this.runtime.stageWidth;
			// ÁêÜËÆ∫‰∏äÈúÄË¶ÅÂä†break;Ôºå‰ΩÜÊòØÂâçÈù¢Â∑≤Áªèreturn‰∫Ü
			case "Y":
				return (Number(element.style.top.split("%")[0]) / 100) * this.runtime.stageHeight;
			case "width":
				return (Number(element.style.width.split("%")[0]) / 100) * this.runtime.stageWidth;
			case "height":
				return (Number(element.style.height.split("%")[0]) / 100) * this.runtime.stageHeight;
			case "content":
				return element.value;
			case "color":
				return string_colorHex(element.style.color);
			case "prompt":
				return element.placeholder;
			case "font-size":
				return element.style.fontSize.split("px")[0];
			case "ID":
				// Áõ¥Êé•‰∏äÊ≠£ÂàôÔºåÂèØ‰ª•Â§ÑÁêÜÁ±ª‰ºº‚ÄúWitCatInput123WitCatInput456‚ÄùËøôÊ†∑ÂåÖÂê´‚ÄúWitCatInput‚ÄùÁöÑÂ•áËë©ID
				{
					let match = /^WitCatInput(.*)$/.exec(element.id);
					return match === null ? "" : match[1];
				}
			case "rp":
				return element.scrollTop;
			case "th":
				return element.scrollHeight;
			case "cp":
				return JSON.stringify([element.selectionStart, element.selectionEnd]);
			case "op":
				return 100 - (Number(element.style.opacity) * 100);
			case "bg":
				// ‰∏çÈÄÇÂêàsplitÁöÑÂú∞ÊñπÔºåÁõ¥Êé•‰∏äÊ≠£Âàô
				// (Ê≥®Ôºö‰∏ÄÂºÄÂßãbackgroundImageÁöÑÂÄºÂèØËÉΩÊòØÁ©∫ÁöÑÊàñËÄÖÂà´ÁöÑ‰ªÄ‰πà‰∏úË•ø‚Ä¶‚Ä¶)
				{
					// ÊâìËä±Êã¨Âè∑‰πãÂêéÂ∞±ÂèØ‰ª•Âú®ÈáåÈù¢Â£∞ÊòéÂèòÈáè‰∫Ü
					let match = /^url\("(.*)"\)$/.exec(element.style.backgroundImage);
					if (match !== null) {
						return decodeURI(match[1]);
					} else {
						// Ê≠£ÂàôÂåπÈÖçÂ§±Ë¥•
						return "";
					}
				}
			case "ff":
				return element.style.fontFamily;
			case "lh":
				return element.style.lineHeight;
			case "fw":
				return element.style.fontWeight;
			case "ts":
				return element.style.textShadow;
			case "json":
				// Áõ¥Êé•ÊääÊï¥‰∏™‰∏úË•øËΩ¨Êàê JSON ÂØπË±°ÔºåÂÜçÊãºÊé•
				return JSON.stringify(
					{
						X: this._getattrib(element, "X"),
						Y: this._getattrib(element, "Y"),
						width: this._getattrib(element, "width"),
						height: this._getattrib(element, "height"),
						content: this._getattrib(element, "content"),
						color: this._getattrib(element, "color"),
						prompt: this._getattrib(element, "prompt"),
						"font-size": this._getattrib(element, "font-size"),
						ID: this._getattrib(element, "ID"),
						"Rolling position": this._getattrib(element, "rp"),
						"Text height": this._getattrib(element, "th"),
						"cursor position": JSON.parse(this._getattrib(element, "cp"))
						// ËøôÈáåÁúãËµ∑Êù•Áº∫‰∫Ü‰∏Ä‰∫õ‰∏úË•øÔºåÂ¶ÇÊûúÊ≤°ÊúâÂêàÂπ∂Â§çÂà∂Á≤òË¥¥ÁöÑ‰ª£Á†Å‰ª•ÂèäËøõ
						// Ë°å‰ºòÂåñÔºåÂ∞ÜÈúÄË¶Å‰øÆÊîπ‰∏§Ê¨°Â§ßÊÆµÂÜÖÂÆπÔºåÁé∞Âú®‰øÆÊîπÂ∞±ÁÆÄÂçï‰∫Ü„ÄÇ
					}
				)
			default:
				return "";
		}
	}

	/**
	 * ÊñáÊú¨Ê°ÜÊï∞Èáè
	 * @returns {number}
	 */
	numbers() {
		let search = document.getElementsByClassName("WitCatInput");
		return search.length;
	}

	/**
	 * ÊåâÈîÆÊ£ÄÊµã
	 * @param {object} args
	 * @param {SCarg} args.type ÊåâÈîÆÁ±ªÂûãÔºåÁî®ÈÄóÂè∑ÂàÜÈöî
	 * @returns {boolean}
	 */
	key(args) {
		let key = args.type.split(",");
		for (const item of key) {
			if (!Object.keys(keypress).includes(item)) {
				return false;
			}
		}
		return true;
	}

	/**
	 * ÊåâÈîÆÊ£ÄÊµã(Â∏ΩÂ≠êÁßØÊú®)
	 * @param {object} args
	 * @param {SCarg} args.type ÊåâÈîÆÁ±ªÂûãÔºåÁî®ÈÄóÂè∑ÂàÜÈöî
	 * @returns {boolean}
	 */
	keys(args) {
		return this.key(args);
	}

	/**
	 * ‰∏äÊ¨°Êåâ‰∏ãÁöÑÈîÆ
	 * @returns {string}
	 */
	lastkey() {
		return lastKey;
	}

	/**
	 * Èº†Ê†áÊªöËΩÆÈÄüÂ∫¶
	 * @returns {number}
	 */
	mousewheel() {
		return MouseWheel;
	}

	/**
	 * ËÆæÁΩÆÊñáÊú¨Ê°Ü
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @param {SCarg} args.type Â±ûÊÄßÁ±ªÂûã
	 * @param {SCarg} args.text Â±ûÊÄßÂÄº
	 */
	setinput(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			let sstyle = search.style;
			let x, y, width, height, opacity;
			switch (args.type) {
				case "X":
					x = this._clamp(Number(args.text), 0, this.runtime.stageWidth);
					x = (x / this.runtime.stageWidth) * 100;
					sstyle.left = x + "%";
					break;
				case "Y":
					y = this._clamp(Number(args.text), 0, this.runtime.stageHeight);
					y = (y / this.runtime.stageHeight) * 100;
					sstyle.top = y + "%";
					break;
				case "width":
					x = Number(sstyle.left.split("%")[0]) / 100 * this.runtime.stageWidth;
					width = this._clamp(Number(args.text), 0, this.runtime.stageWidth - x);
					width = (width / this.runtime.stageWidth) * 100;
					sstyle.width = Number(width) + "%";
					break;
				case "height":
					y = Number(sstyle.top.split("%")[0]) / 100 * this.runtime.stageHeight;
					height = this._clamp(Number(args.text), 0, this.runtime.stageHeight - y);
					height = (height / this.runtime.stageHeight) * 100;
					sstyle.height = Number(height) + "%";
					break;
				case "content":
					search.value = args.text;
					break;
				case "prompt":
					search.placeholder = args.text;
					break;
				case "color":
					sstyle.color = args.text;
					break;
				case "font-size":
					sstyle.fontSize = Number(args.text) + "px";
					inputFontSize[args.id] = Number(args.text);
					break;
				case "rp":
					search.scrollTop = Number(args.text);
					break;
				case "op":
					opacity = this._clamp(Number(args.text), 0, 100);
					opacity = 1 - (opacity / 100);
					sstyle.opacity = String(opacity);
					break;
				case "cp":
					try {
						let selection = JSON.parse(args.text);
						if (selection instanceof Array && selection.length === 2) {
							search.setSelectionRange(selection[0], selection[1]);
						}
						else if (typeof (selection) === "number") {
							search.setSelectionRange(selection, selection);
						}
					}
					catch {
						return;
					}
					break;
				case "bg":
					if (args.text.startsWith("https://m.ccw.site/") || args.text.startsWith("https://m.xiguacity.com/")) {
						sstyle.backgroundImage = 'url("' + encodeURI(String(args.text)) + '")';
						sstyle.backgroundSize = "100% 100%";
					}
					else {
						console.warn("Á¶ÅÊ≠¢ÁöÑÈìæÊé•/ÂõæÁâá\nBanned links/pictures");
					}
					break;
				case "lh":
					sstyle.lineHeight = Number(args.text) + "px";
					break;
				case "ts":
					sstyle.textShadow = args.text;
					break;
				case "css":
					// https://www.cnblogs.com/ndos/p/9706646.html
					search.setAttribute("style", args.text);
					break;
			}
		}
	}

	/**
	 * ËÆæÁΩÆÊòØÂê¶ÂèØ‰øÆÊîπ
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @param {SCarg} args.read ËÉΩÂê¶‰øÆÊîπ
	 */
	setread(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			if (args.read === "eb") {
				search.disabled = false;
			}
			else {
				search.disabled = true;
			}
		}
	}

	/**
	 * ËÆæÁΩÆÊñáÊú¨Ê°ÜÊòØÂê¶‰∏∫ÂØÜÁ†ÅÊ°Ü
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @param {SCarg} args.read ÊòØÂØÜÁ†ÅÊ°Ü "test"|"password"
	 */
	password(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			search.type = args.read;
		}
	}

	/**
	 * Ëé∑ÂèñÊåâ‰∏ãÁöÑÊåâÈîÆ
	 * @returns {string}
	 */
	keypress() {
		return JSON.stringify(Object.keys(keypress));
	}

	/**
	 * ËÆæÁΩÆÂ≠ó‰Ωì
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @param {SCarg} args.name Â≠ó‰ΩìÂêç
	 * @param {SCarg} args.text Â≠ó‰ΩìÈìæÊé•
	 */
	setfont(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			var xhr = new XMLHttpRequest(); // ÂÆö‰πâ‰∏Ä‰∏™ÂºÇÊ≠•ÂØπË±°
			xhr.open('GET', args.text, true); // ÂºÇÊ≠•GETÊñπÂºèÂä†ËΩΩÂ≠ó‰Ωì
			xhr.responseType = "arraybuffer"; //ÊääÂºÇÊ≠•Ëé∑ÂèñÁ±ªÂûãÊîπ‰∏∫arraybuffer‰∫åËøõÂà∂Á±ªÂûã
			xhr.onload = function () {
				// ËøôÈáåÂÅö‰∫Ü‰∏Ä‰∏™Âà§Êñ≠ÔºöÂ¶ÇÊûúÊµèËßàÂô®ÊîØÊåÅFontFaceÊñπÊ≥ïÊâßË°å
				if (typeof FontFace != 'undefined') {
					document.fonts.add(new FontFace(args.name, this.response)); // Â∞ÜÂ≠ó‰ΩìÂØπË±°Ê∑ªÂä†Âà∞È°µÈù¢‰∏≠
					search.style.fontFamily = `"${args.name}"`;
				} else {
					search.innerHTML = `@font-face{font-family:"${args.name}";src:url("${args.text}") `;
				}
			}
			xhr.send();
		}
	}

	/**
	 * ËÆæÁΩÆÂØπÈΩêÊñπÂºè
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @param {SCarg} args.read ÂØπÈΩêÊñπÂºè "left"|"center"|"right"
	 */
	textalign(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			search.style.textAlign = args.read;
		}
	}

	/**
	 * ËÆæÁΩÆÊñáÊú¨Ê°ÜÂ≠ó‰ΩìÁ≤óÁªÜ
	 * @param {object} args
	 * @param {SCarg} args.id ÊñáÊú¨Ê°Ü ID
	 * @param {SCarg} args.text Â≠ó‰ΩìÁ≤óÁªÜ
	 */
	fontweight(args) {
		let search = document.getElementById("WitCatInput" + args.id);
		if (search !== null) {
			search.style.fontWeight = args.text;
		}
	}

	/**
	 * ÂàõÂª∫Èò¥ÂΩ±
	 * @param {object} args
	 * @param {SCarg} args.x ÂÅèÁßªx
	 * @param {SCarg} args.y ÂÅèÁßªy
	 * @param {SCarg} args.width ÂÆΩÂ∫¶
	 * @param {SCarg} args.color È¢úËâ≤
	 * @returns {string}
	 */
	shadow(args) {
		return `${args.x}px ${args.y}px ${args.width}px ${args.color}`
	}

	/**
	 * ËÆæÁΩÆÂ≠ó‰ΩìËá™ÈÄÇÂ∫î
	 * @param {object} args
	 * @param {SCarg} args.type
	 */
	fontadaptive(args) {
		if (args.type == "true") {
			if (!adaptive) {
				let search = document.getElementsByClassName("WitCatInput");
				const config = { attributes: true, childList: true, subtree: true, attributeFilter: ['style'] };
				const callback = function () {
					let len = search.length
					for (let i = 0; i < len; i++) {
						search[i].style.fontSize = ((cvs.style.width.split("px")[0] / 360) * inputFontSize[search[i].id.split("WitCatInput")[1]]) + "px";
					}
				};
				observer = new MutationObserver(callback);
				observer.observe(cvs, config);
				adaptive = true;
			}
		}
		else {
			if (adaptive) {
				observer.disconnect();
				adaptive = false;
			}
		}
	}
}

window.tempExt = {
	Extension: WitCatInput,
	info: {
		name: "WitCatInput.name",
		description: "WitCatInput.descp",
		extensionId: witcat_input_extensionId,
		iconURL: witcat_input_picture,
		insetIconURL: witcat_input_icon,
		featured: true,
		disabled: false,
		collaborator: "ÁôΩÁå´ @ CCW"
	},
	l10n: {
		"zh-cn": {
			"WitCatInput.name": "[beta]ÁôΩÁå´ÁöÑËæìÂÖ•Ê°Ü",
			"WitCatInput.descp": "ÂÖ®Êñ∞ÁöÑËæìÂÖ•Ê°ÜÔºÅ"
		},
		en: {
			"WitCatInput.name": "[beta]WitCat‚Äòs Input",
			"WitCatInput.descp": "what a nice input!"
		}
	}
};

/**
 * È¢úËâ≤ËΩ¨Êç¢
 * @param {string} color
 */
function string_colorHex(color) {
	// RGBÈ¢úËâ≤ÂÄºÁöÑÊ≠£Âàô
	var reg = /^(rgb|RGB)/;
	if (reg.test(color)) {
		var strHex = "#";
		// ÊääRGBÁöÑ3‰∏™Êï∞ÂÄºÂèòÊàêÊï∞ÁªÑ
		var colorArr = color.replace(/(?:\(|\)|rgb|RGB)*/g, "").split(",");
		// ËΩ¨Êàê16ËøõÂà∂
		for (var i = 0; i < colorArr.length; i++) {
			var hex = Number(colorArr[i]).toString(16);
			if (hex === "0") {
				hex += hex;
			}
			strHex += hex;
		}
		return strHex;
	} else {
		return String(color);
	}
}

//ÈîÆÁõò‰∫ã‰ª∂ÁõëÂê¨
document.addEventListener("keydown", keydown);
document.addEventListener("keyup", keyup);

/**
 * Êåâ‰∏ãÈîÆÁöÑÂ§ÑÁêÜ
 * @param {KeyboardEvent} event
 */
function keydown(event) {
	keypress[event.code] = true;
	lastKey = event.code;
}

/**
 * ÊùæÂºÄÈîÆÁöÑÂ§ÑÁêÜ
 * @param {KeyboardEvent} event
 */
function keyup(event) {
	delete keypress[event.code];
}

/**
 * ÊªöËΩÆ‰∫ã‰ª∂ÁõëÂê¨
 * @param {WheelEvent} e
 */
function scrollFunc(e) {
	// Ê≥®ÊÑèËøô‰∏™Ë¥üÊï∞‚Ä¶‚Ä¶
	// ÁõÆÂâçÁöÑÊ†áÂáÜÁî®Ê≥ïÊòØ‰ΩøÁî® deltaYÔºå‰ΩÜÊòØ deltaY ÁöÑÁ¨¶Âè∑Âíå WheelDeltaY Áõ∏Âèç„ÄÇ
	// ‰∏∫‰∫ÜÂíåÂéüÊúâÁöÑË°å‰∏∫‰∏ÄËá¥Ôºå‰πò‰∏ä -3
	// Âú®ÊàëÁöÑÊµèËßàÂô®‰∏≠ deltaY = WheelDeltaY / -3
	MouseWheel = e.deltaY * -3;
	clearTimeout(timer);
	timer = setTimeout(() => {
		MouseWheel = 0;
	}, 30);
};
//ÁªôÈ°µÈù¢ÁªëÂÆöÊªëËΩÆÊªöÂä®‰∫ã‰ª∂
cvs.addEventListener('wheel', scrollFunc, {capture: true});
