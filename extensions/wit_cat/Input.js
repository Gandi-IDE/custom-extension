const witcat_input_picture =
	"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1OTQuMzE4NyIgaGVpZ2h0PSI1MTQuNzMxNjEiIHZpZXdCb3g9IjAsMCw1OTQuMzE4Nyw1MTQuNzMxNjEiPjxkZWZzPjxsaW5lYXJHcmFkaWVudCB4MT0iMjQwLjAwMDAyIiB5MT0iLTEuNjM3MyIgeDI9IjI0MC4wMDAwMiIgeTI9IjM2MS42MzczOSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci0xIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM1MmJhYmEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Y2FlYWUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjU2LjE5MzU2IiB5MT0iMTM0LjQ4MzI0IiB4Mj0iMjU2LjE5MzU2IiB5Mj0iMjQ0LjkyOTA3IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTIiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2FlYzdjNyIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk2YzJjMiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IHgxPSIyNjkuMjY2NjciIHkxPSIxMzkuMDcyMDEiIHgyPSIyNjkuMjY2NjciIHkyPSIyNDMuOTcwMzYiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMyI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZjFmZmZmIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjY2NmZmZmIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjI0MS4zODE3MSIgeTE9IjE2MC4yMTE4NSIgeDI9IjI0MS4zODE3MSIgeTI9IjIwNi4wNzQxOSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci00Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNhZmM5YzkiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNiYWQ4ZDgiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMTIyLjU4Nzk3IiB5MT0iLTQxLjcwNzA4IiB4Mj0iMTIyLjU4Nzk3IiB5Mj0iNDMxLjI2NTg5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTUiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzRjYWVhZSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQ1YTBhMCIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IHgxPSIyNy41MjYzIiB5MT0iLTI4LjQ5Mzg2IiB4Mj0iMjcuNTI2MyIgeTI9IjIxNi4yNTA4OCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci02Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Y2FlYWUiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0NWEwYTAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iNDQ0LjQxNjk1IiB5MT0iLTIwLjk4NDg1IiB4Mj0iNDQ0LjQxNjk1IiB5Mj0iMTM1LjE3MTMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItNyI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjNGNhZWFlIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDVhMGEwIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjExNi41ODE5NiIgeTE9Ii00OS4yMTQ1OSIgeDI9IjExNi41ODE5NiIgeTI9IjQyMy43NTgzOCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci04Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Mzk4OTgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Mjk1OTUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjEuNTIwMyIgeTE9Ii0zNi4wMDEzOCIgeDI9IjIxLjUyMDMiIHkyPSIyMDguNzQzMzciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItOSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjNDM5ODk4Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDI5NTk1Ii8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjQzOC40MTA5NCIgeTE9Ii0xNy45ODE4NSIgeDI9IjQzOC40MTA5NCIgeTI9IjEzOC4xNzQzIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTEwIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM0Mzk4OTgiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0Mjk1OTUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMzA3LjI1NzgyIiB5MT0iMjI5LjgyODMiIHgyPSIzMDcuMjU3ODIiIHkyPSI0MTYuNjUyMTgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMTEiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzQzOTg5OCIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQyOTU5NSIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4LjUzMzc2LDY3LjQ2NTcyKSI+PGcgZGF0YS1wYXBlci1kYXRhPSJ7JnF1b3Q7aXNQYWludGluZ0xheWVyJnF1b3Q7OnRydWV9IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxwYXRoIGQ9Ik0tMS42OTc0LDM2MS42MzczOXYtMzYzLjI3NDc0aDQ4My4zOTQ4NnYzNjMuMjc0NzR6IiBmaWxsPSJ1cmwoI2NvbG9yLTEpIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMCIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiLz48cGF0aCBkPSJNMTgzLjg0MjgzLDE5OS4zNjIxOWMwLC0xNC45MjA1MyAwLC0yNS4zOTMwMyAwLC0zNC4zMjkwNGMwLC0xNC45MjUzNCA4Ljc3Nzk2LC0zMC4wNDk3NSAzMS4wOTM4LC0zMC4wNDk3NWMxNi4xNzQ3LDAgMjY2LjY1ODcxLC0wLjUwMDE2IDI2Ni42NTg3MSwtMC41MDAxNnY3Mi45MDcyNmMwLDAgLTE1LjI3ODcyLC04Ljk2MzM2IC0yNy44ODEzNywxMi41MzU4MmMtNy44MjE5NiwxMy4zNDM2OSAtOS42OTAwNiw2MC43MzAxNCAtMTYuNzgxMzMsNjAuODg4OGMtMTUuMTQ2MjEsMC4zMzg4NyAtMTIuNDk3NTgsLTMzLjYyMDQyIC0yMy4xOTQwOSwtMzQuMDUxMmMtNS40NTEwMiwtMC4zOTY2NiAtMTcuMzU5OTcsOS43NDg5MyAtMjAuMjIxNjEsMjcuNzEwOTJjLTIuMjgzOTUsMTQuMzM1OTEgNC4yNzQ2OSw0Mi4zMDk2OCAtMy42ODkzLDQxLjg3NzMyYy0zMC4zNTE1MiwtMS42NDc3NCAtMTkuNDUwODEsLTcyLjE2MTE0IC00NC44NDIwNywtODcuOTk4MzdjLTEzLjg4NTcyLC04LjY2MDkxIC0xOS4yMjA0NSwtMjkuMjIxMzUgLTQzLjQ1MDI2LC0xNC4yOTI1Yy0xMy43NDA0NSw4LjQ2NTk3IC0xMy45MzQ4NSwtMi42NTIxNiAtMjguMDE5MjUsNS4yMjgzNGMtMTAuOTg5MzMsNi4xNDg3NSAtMTEuODEyNzQsMjUuNDg4MSAtMjAuMDM1ODksMjUuNjM4NDJjLTkuNzM0NDQsMC4xNzc5NCAtMTQuMjg3MDgsLTIzLjI1NDM2IC0yNC4wNTU4MSwtMjYuNDY5MDFjLTE0LjM0MDA2LC00LjcxODk1IC0yMi43NTc1Nyw0LjA1NDM5IC0yNi42MDgwMSw0LjE2OTIzYy0xMS41NTk5NywwLjM0NDc3IC0xOC45NzM1MSwtMTYuNjE4OTYgLTE4Ljk3MzUxLC0yMy4yNjYwOHoiIGZpbGw9InVybCgjY29sb3ItMikiIHN0cm9rZT0iI2NjZmZmZiIgc3Ryb2tlLXdpZHRoPSIwIiBzdHJva2UtbGluZWNhcD0iYnV0dCIvPjxwYXRoIGQ9Ik0xODkuODU0ODMsMjAxLjI1NTM5YzAsLTE0LjMwMDYyIDAsLTIyLjEzNTI4IDAsLTMwLjcwMDAyYzAsLTE0LjMwNTIyIDguNDEzMjUsLTI4LjgwMTI1IDI5LjgwMTkyLC0yOC44MDEyNWMxNS41MDI2OCwwIDI2MS45Mzg1OSwtMC40NzkzOCAyNjEuOTM4NTksLTAuNDc5MzhjMCwwIDAsNS40OTk0MSAwLDEwLjMzNjdjMCwyMi4zNzcxNiAwLDU3LjMzODY5IDAsNTcuMzM4NjljMCwwIC0xNC4yMDA3NiwtNy42MDYyNiAtMjYuNTc4MzUsMTIuMDgzNzZjLTYuNzM2MTIsMTAuNzE1NjkgLTkuNzY0MjUsNTEuMTYzODggLTE2Ljk1NDg3LDU1LjUzOTY1Yy0xMi4zNTEyOCw0LjgzMTYyIC0xNS40NzcyNSwtMjguMTAxNjUgLTI0LjE1NzI1LC0yOC4zNTI3Yy0yMi41NDA5MywtMS41NzMxNyAtMTIuMjUwNTIsNjAuODAwNCAtMjEuMzYxNDQsNjMuOTUxMDFjLTIzLjc5MjUzLDguMjI3NiAtMjIuNDc1MjQsLTU3LjI5NTA5IC00MS45MDgzMywtNzUuMzA0NzVjLTIxLjUyNDMxLC0xOS45NDc3IC00NS4wOTYxMywtMjMuMjk4NzIgLTQ3Ljk3NzYzLC0yMS41MjMzMmMtMTMuMTY5NTcsOC4xMTQyMiAtMTMuMzU1ODgsLTIuNTQxOTggLTI2Ljg1NTEyLDUuMDExMTJjLTEwLjUzMjc1LDUuODkzMjggLTExLjMyMTk1LDI0LjQyOTEyIC0xOS4yMDM0NSwyNC41NzMyYy05LjMyOTk5LDAuMTcwNTUgLTEzLjY5MzQ5LC0yMi4yODgxOSAtMjMuMDU2MzUsLTI1LjM2OTI5Yy0xMy43NDQyNywtNC41MjI4OSAtMjEuODEyMDYsMy44ODU5MyAtMjUuNTAyNTIsMy45OTZjLTExLjA3OTY4LDAuMzMwNDQgLTE4LjE4NTIxLC0xNS45Mjg0NyAtMTguMTg1MjEsLTIyLjI5OTQzeiIgZmlsbD0idXJsKCNjb2xvci0zKSIgc3Ryb2tlPSIjY2NmZmZmIiBzdHJva2Utd2lkdGg9IjAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ii8+PGcgc3Ryb2tlLXdpZHRoPSIwIiBzdHJva2UtbGluZWNhcD0iYnV0dCI+PHBhdGggZD0iTTIzMy40MTQxOCwyMDYuMDc0MTlsMC4wNzA3OSwtNS4zODE2NGw1LjA4MzYyLDAuMDgzMzR2LTQwLjU2NDAzaDUuODYzNzJ2NDAuNjQ3MzdoNC45MTY5NHY1LjE5NjIyeiIgZmlsbD0idXJsKCNjb2xvci00KSIgc3Ryb2tlPSIjMDAwMDAwIi8+PHBhdGggZD0iTTIzMy40MTY0NywxNjUuMTg3MzJ2LTUuMjQxMjJoMTYuMTY3ODR2NS4yNDEyMnoiIGZpbGw9IiNhZmM5YzkiIHN0cm9rZT0ibm9uZSIvPjwvZz48ZyBmaWxsPSIjNDM5ODk4IiBzdHJva2Utd2lkdGg9IjAiIHN0cm9rZS1saW5lY2FwPSJidXR0Ij48cGF0aCBkPSJNMjM3LjA2ODIyLDIwMy4wNTQ3di00NS44NDM1OWg1Ljg2MzcydjQ1Ljg0MzU5eiIgc3Ryb2tlPSIjMDAwMDAwIi8+PHBhdGggZD0iTTIzMS45MTYxLDE2Mi4xODY1OXYtNS4yNDEyMmgxNi4xNjc4NHY1LjI0MTIyeiIgc3Ryb2tlPSJub25lIi8+PHBhdGggZD0iTTIzMS45MTYxLDIwMy4xMzAwMnYtNS4yNDEyM2gxNi4xNjc4NHY1LjI0MTIzeiIgc3Ryb2tlPSJub25lIi8+PC9nPjxwYXRoIGQ9Ik0xODUuOTQzNzIsLTQzLjIwNzgzYzAsMCAtNDguMzE4ODksOTEuMTgwNDggLTYxLjUwODcxLDEzMi45OTE1MWMtMy43ODI2LDExLjk5MDYyIDIwLjc2NTM1LDgxLjEzNzc0IDEwLjk2NDUxLDEyOC44NDU4M2MtNy4zMjI0NCwzNS42NDM4NSAtNjEuMjMxNjYsMjMuODM5NjIgLTY3LjYwOTEzLDM5LjM2MTU0Yy0yMy4wNTY2OSw1Ni4xMTY5MiAtMTMuMjMxNDQsMTczLjI3NDg1IC0xMy4yMzE0NCwxNzMuMjc0ODUiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci01KSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PHBhdGggZD0iTTgxLjU4MDM1LC0yOC40OTM4NmMwLDAgLTY0LjU2ODMsNjIuMDg4MTcgLTIzLjg3NTI3LDE2MC43MTM4NWMxOS4xNTIyNiw0Ni40MTgzNyAtODQuMjMyODMsODQuMDMwOSAtODQuMjMyODMsODQuMDMwOSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTYpIiBzdHJva2Utd2lkdGg9IjMyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48cGF0aCBkPSJNNDQ3LjIwMjM2LC0yMC45ODQ4NWMwLDAgLTIwNS4xNjY3LDI5LjE1MjA2IC0yMTMuNzU1NjksODQuMjMzNjJjLTExLjg3OTIsNzYuMTgxODMgMjk2LjMzODI4LC04MC4yNTQ5OCAyOTYuMzM4MjgsLTMuMTUyNTQiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci03KSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PHBhdGggZD0iTTE3NS40MzU0NywtNTEuNDY1NzJjMCwwIC00My44MTY2NCw5MS45MzA4NSAtNTcuMDA2NDUsMTMzLjc0MTg5Yy0zLjc4MjYsMTEuOTkwNjIgMjAuNzY1MzQsODEuMTM3NzQgMTAuOTY0NTEsMTI4Ljg0NTgzYy03LjMyMjQ0LDM1LjY0Mzg1IC02MS4yMzE2NiwyMy44Mzk2MiAtNjcuNjA5MTMsMzkuMzYxNTRjLTIzLjA1NjY5LDU2LjExNjkyIC0xMy4yMzE0NCwxNzMuMjc0ODUgLTEzLjIzMTQ0LDE3My4yNzQ4NSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTgpIiBzdHJva2Utd2lkdGg9IjMyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48cGF0aCBkPSJNNzUuNTc0MzQsLTM2LjAwMTM4YzAsMCAtNjQuNTY4Myw2Mi4wODgxNyAtMjMuODc1MjcsMTYwLjcxMzg1YzE5LjE1MjI2LDQ2LjQxODM3IC04NC4yMzI4Myw4NC4wMzA5IC04NC4yMzI4Myw4NC4wMzA5IiBmaWxsPSJub25lIiBzdHJva2U9InVybCgjY29sb3ItOSkiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik00NDEuMTk2MzUsLTI4LjQ5MjM2YzAsMCAtMjE3LjE3ODcxLDMwLjY1MzU2IC0yMjUuNzY3Nyw4NS43MzUxM2MtMTEuODc5Miw3Ni4xODE4MyAzMTQuMzU2MywtODQuNzU5NDggMzE0LjM1NjMsLTcuNjU3MDUiIGZpbGw9Im5vbmUiIHN0cm9rZT0idXJsKCNjb2xvci0xMCkiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik0xMzIuNzU2NTMsMzc2LjU1NjcyYzAsMCAyMy42NjYyOSwtNzIuOTM5NDcgNjIuNzc2MTcsLTg4LjYzNjA2YzkuMTkxNDgsLTMuNjg4OTYgMTIuNzc1Nyw1MC40NjgyOCAyMS42NzEzNyw2Ni4xNTgwNGM3LjE3NzQ3LDEyLjY1OTI4IDIwLjM5NjExLDguMjI0NjMgMjcuODY2ODgsMy4xNjUyM2MyNi43MjgyMSwtMTguMTAxMDMgNDcuNDk1MTQsLTY4Ljk2MjMyIDYzLjg1NDYsLTc5Ljk4NjY4YzE1LjYzMDY3LC0xMC41MzMyMyAzLjg1MDc3LDExNi4xNDYyNCAyOS41NjUwMiwxNDYuNjYyNWMzLjU1ODkyLDQuMjIzNTMgNTcuMjY3NTEsLTcuNTM0OTMgMTAwLjQwOTksLTU3LjgxNDFjMzguMzI2NzQsLTQ0LjY2NjkgODQuNzQxOCwtODIuNTAzMDggODYuMTg3NTgsLTgyLjk5Njk3IiBmaWxsPSJub25lIiBzdHJva2U9IiM0NjlmOWYiIHN0cm9rZS13aWR0aD0iMzIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPjxwYXRoIGQ9Ik0xMjkuNDc1MTYsMzY2LjEyODQ3YzkuODIxNzQsLTQ3LjU1NjQgNzEuODI5NTcsLTEwMS44NzM4NSA3NS4zNzUxLC04Ny40MTA2NGM5LjYxNzEzLDM5LjIzMDg5IC0zLjEzNjcyLDk0LjMwOTI0IDM2Ljc1ODY4LDY3LjMwNzhjMjkuNjg0OTUsLTIwLjA5MDk1IDUxLjg1OTE2LC03MC42NjA1NyA2OS4xMDAwMiwtODIuMjc4ODhjMTUuNjMwNjcsLTEwLjUzMzIzIC01LjE1Mzc0LDEyMi4xNDkyNCAyMC41NjA1MSwxNTIuNjY1NWM0LjcwMjMyLDUuNTgwNDUgNjEuMzQzNDMsLTEzLjk0MjM3IDEwOS41MTI3NSwtNzAuNjk4OTVjMjAuNjc0NiwtMjQuMzYwMzIgODIuMTY0ODIsLTc2LjU1MDIxIDgzLjA4Nzc0LC03Ni44NjU0OSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJ1cmwoI2NvbG9yLTExKSIgc3Ryb2tlLXdpZHRoPSIzMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIi8+PC9nPjwvZz48L3N2Zz48IS0tcm90YXRpb25DZW50ZXI6Mjg4LjUzMzc2MDAwMDAwMDAzOjI0Ny40NjU3Mi0tPg==";

const witcat_input_icon =
	"data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSIxNzcuMDg4NTUiIGhlaWdodD0iMTc3LjA4ODU1IiB2aWV3Qm94PSIwLDAsMTc3LjA4ODU1LDE3Ny4wODg1NSI+PGRlZnM+PGxpbmVhckdyYWRpZW50IHgxPSIyNTYuMTkzNTYiIHkxPSIxMzcuNDg0NzQiIHgyPSIyNTYuMTkzNTYiIHkyPSIyNDcuOTMwNTciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBpZD0iY29sb3ItMSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYWVjN2M3Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjOTZjMmMyIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgeDE9IjI2OS4yNjY2NyIgeTE9IjE0Mi4wNzM1MSIgeDI9IjI2OS4yNjY2NyIgeTI9IjI0Ni45NzE4NiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJjb2xvci0yIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNmMWZmZmYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNjY2ZmZmYiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCB4MT0iMjQxLjM4MTcxIiB5MT0iMTYwLjIxMTg0IiB4Mj0iMjQxLjM4MTcxIiB5Mj0iMjA2LjA3NDE5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgaWQ9ImNvbG9yLTMiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2FmYzljOSIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI2JhZDhkOCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNTEuNDU1NzYsLTkxLjQ1NTc0KSI+PGcgZGF0YS1wYXBlci1kYXRhPSJ7JnF1b3Q7aXNQYWludGluZ0xheWVyJnF1b3Q7OnRydWV9IiBmaWxsLXJ1bGU9Im5vbnplcm8iIHN0cm9rZS13aWR0aD0iMCIgc3Ryb2tlLWxpbmVjYXA9ImJ1dHQiIHN0cm9rZS1saW5lam9pbj0ibWl0ZXIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWRhc2hhcnJheT0iIiBzdHJva2UtZGFzaG9mZnNldD0iMCIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOiBub3JtYWwiPjxwYXRoIGQ9Ik0xNTEuNDU1NzYsMjY4LjU0NDI5di0xNzcuMDg4NTVoMTc3LjA4ODU1djE3Ny4wODg1NXoiIGZpbGw9IiM1MmJhYmEiIHN0cm9rZT0ibm9uZSIvPjxwYXRoIGQ9Ik0xODMuODQyODMsMjAyLjM2MzY5YzAsLTE0LjkyMDUzIDAsLTI1LjM5MzAzIDAsLTM0LjMyOTA0YzAsLTE0LjkyNTM0IDguNzc3OTYsLTMwLjA0OTc1IDMxLjA5MzgsLTMwLjA0OTc1YzE2LjE3NDcsMCAxMTMuNjA3NjgsLTAuNTAwMTYgMTEzLjYwNzY4LC0wLjUwMDE2djcyLjkwNzI2YzAsMCAtMTguMDI5MzEsMS4xMzgxIC0yNy4wMDksNi42NzA4Yy0xMy43NDA0NSw4LjQ2NTk3IC0xMy45MzQ4NSwtMi42NTIxNiAtMjguMDE5MjUsNS4yMjgzNGMtMTAuOTg5MzMsNi4xNDg3NSAtMTEuODEyNzQsMjUuNDg4MSAtMjAuMDM1ODksMjUuNjM4NDJjLTkuNzM0NDQsMC4xNzc5NCAtMTQuMjg3MDgsLTIzLjI1NDM2IC0yNC4wNTU4MSwtMjYuNDY5MDFjLTE0LjM0MDA2LC00LjcxODk1IC0yMi43NTc1Nyw0LjA1NDM5IC0yNi42MDgwMSw0LjE2OTIzYy0xMS41NTk5NywwLjM0NDc3IC0xOC45NzM1MSwtMTYuNjE4OTYgLTE4Ljk3MzUxLC0yMy4yNjYwOHoiIGZpbGw9InVybCgjY29sb3ItMSkiIHN0cm9rZT0iI2NjZmZmZiIvPjxwYXRoIGQ9Ik0xODkuODU0ODMsMjA0LjI1NjljMCwtMTQuMzAwNjIgMCwtMjIuMTM1MjggMCwtMzAuNzAwMDJjMCwtMTQuMzA1MjIgOC40MTMyNSwtMjguODAxMjUgMjkuODAxOTIsLTI4LjgwMTI1YzE1LjUwMjY4LDAgMTA4Ljg4NzU2LC0wLjQ3OTM4IDEwOC44ODc1NiwtMC40NzkzOGMwLDAgMCw1LjQ5OTQxIDAsMTAuMzM2N2MwLDExLjM5MjkxIDAsNTcuMzM4NjkgMCw1Ny4zMzg2OWMwLDAgLTE3LjI4MDI0LDEuMDkwODEgLTI1Ljg4Njg0LDYuMzkzNjVjLTEzLjE2OTU3LDguMTE0MjIgLTEzLjM1NTg4LC0yLjU0MTk4IC0yNi44NTUxMiw1LjAxMTEyYy0xMC41MzI3NSw1Ljg5MzI4IC0xMS4zMjE5NSwyNC40MjkxMiAtMTkuMjAzNDUsMjQuNTczMmMtOS4zMjk5OSwwLjE3MDU1IC0xMy42OTM0OSwtMjIuMjg4MTkgLTIzLjA1NjM1LC0yNS4zNjkyOWMtMTMuNzQ0MjcsLTQuNTIyODkgLTIxLjgxMjA2LDMuODg1OTMgLTI1LjUwMjUyLDMuOTk2Yy0xMS4wNzk2OCwwLjMzMDQ0IC0xOC4xODUyMSwtMTUuOTI4NDcgLTE4LjE4NTIxLC0yMi4yOTk0M3oiIGZpbGw9InVybCgjY29sb3ItMikiIHN0cm9rZT0iI2NjZmZmZiIvPjxnPjxwYXRoIGQ9Ik0yMzMuNDE0MTgsMjA2LjA3NDE5bDAuMDcwNzksLTUuMzgxNjRsNS4wODM2MiwwLjA4MzM0di00MC41NjQwM2g1Ljg2MzcydjQwLjY0NzM3aDQuOTE2OTR2NS4xOTYyMnoiIGZpbGw9InVybCgjY29sb3ItMykiIHN0cm9rZT0iIzAwMDAwMCIvPjxwYXRoIGQ9Ik0yMzMuNDE2NDcsMTY1LjE4NzMydi01LjI0MTIyaDE2LjE2Nzg0djUuMjQxMjJ6IiBmaWxsPSIjYWZjOWM5IiBzdHJva2U9Im5vbmUiLz48L2c+PGcgZmlsbD0iIzQ5YTdhNyI+PHBhdGggZD0iTTIzNy4wNjgyMiwyMDMuMDU0Njl2LTQ1Ljg0MzU5aDUuODYzNzJ2NDUuODQzNTl6IiBzdHJva2U9IiMwMDAwMDAiLz48cGF0aCBkPSJNMjMxLjkxNjEsMTYyLjE4NjU4di01LjI0MTIyaDE2LjE2Nzg0djUuMjQxMjJ6IiBzdHJva2U9Im5vbmUiLz48cGF0aCBkPSJNMjMxLjkxNjEsMjAzLjEzMDAydi01LjI0MTIzaDE2LjE2Nzg0djUuMjQxMjN6IiBzdHJva2U9Im5vbmUiLz48L2c+PC9nPjwvZz48L3N2Zz48IS0tcm90YXRpb25DZW50ZXI6ODguNTQ0MjQ0OTk5OTk5OTk6ODguNTQ0MjU1MDAwMDAwMDItLT4=";

// eslint-disable-next-line camelcase
const witcat_input_extensionId = "WitCatInput";

/** @typedef {string|number|boolean} SCarg æ¥è‡ªScratchåœ†å½¢æ¡†çš„å‚æ•°ï¼Œè™½ç„¶è¿™ä¸ªæ¡†å¯èƒ½åªèƒ½è¾“å…¥æ•°å­—ï¼Œä½†æ˜¯å¯ä»¥æ”¾å…¥å˜é‡ï¼Œå› æ­¤æœ‰å¯èƒ½è·å¾—æ•°å­—å’Œæ–‡æœ¬ï¼Œéœ€è¦åŒæ—¶å¤„ç† */

class WitCatInput {
	constructor(runtime) {
		/**
		 * æŒ‰ä¸‹çš„æŒ‰é”®
		 * @type {{[key: string]: true}}
		 */
		this.keypresslist = {};

		/**
		 * æœ€åä¸€æ¬¡æŒ‰ä¸‹çš„æŒ‰é”®
		 */
		this.lastKey = "";

		/**
		 * é¼ æ ‡æ»šè½®é€Ÿåº¦
		 */
		this.MouseWheel = 0;

		/**
		 * ç›‘å¬è¾“å…¥çš„enteräº‹ä»¶
		 */
		this.InputListen = []

		this.InputEnter = false;

		/**
		 * é¼ æ ‡é€Ÿåº¦å¤ä½ä¸º0çš„è®¡æ—¶å™¨
		 * @type {number|undefined}
		 */
		this.timer = undefined;

		/**
		 * ä¿å­˜è¾“å…¥æ¡†æ–‡æœ¬å¤§å°ï¼Œå½“èˆå°å¤§å°å˜åŒ–æ—¶ï¼ŒåŒæ¯”ä¿®æ”¹è¾“å…¥æ¡†æ–‡æœ¬å¤§å°
		 * @type {{[key: string]: number}}
		 */
		this.inputFontSize = {};

		/**
		 * æ˜¯å¦å¼€å¯åŒæ¯”ä¿®æ”¹è¾“å…¥æ¡†æ–‡æœ¬å¤§å°çš„åŠŸèƒ½
		 */
		this.adaptive = false;

		/**
		 * ç›‘æ§èˆå°å¤§å°çš„å˜åŒ–
		 * @type {MutationObserver | null}
		 */
		this.observer = null;
		this.runtime = runtime;

		/**
		 * Scratch æ‰€ä½¿ç”¨çš„ canvasï¼Œè·å–ä¸åˆ°è¿”å› null
		 * @return {HTMLCanvasElement | null}
		 */
		this.canvas = () => {
			try {
				const { canvas } = this.runtime.renderer;
				if (canvas instanceof HTMLCanvasElement) {
					return canvas;
				}
			} catch (err) {
				return null;
			}
			return null;
		};

		/**
		 * æ‰€æœ‰è¾“å…¥æ¡†æ‰€åœ¨çš„çˆ¶è§’è‰²ï¼Œç›®å‰è®¾ä¸º canvas çš„çˆ¶è§’è‰²ã€‚
		 * è·å–ä¸åˆ°è¿”å› null
		 * @return {HTMLElement | null}
		 */
		this.inputParent = () => {
			try {
				const { canvas } = this.runtime.renderer;
				if (canvas instanceof HTMLCanvasElement) {
					return canvas.parentElement;
				}
			} catch (err) {
				console.error(err);
				return null;
			}
			return null;
		};

		if (this.canvas() === null || this.inputParent() === null) {
			console.warn("å½“å‰é¡µé¢ä¸æ”¯æŒæ–‡æœ¬æ¡†ï¼Œè¯·å‰å¾€ä½œå“è¯¦æƒ…é¡µä½“éªŒå®Œæ•´ä½œå“ï¼");
			// æ³¨æ„ï¼šåœ¨æç¤ºä¹‹åï¼Œæ‰©å±•ä»ç„¶åœ¨è¿è¡Œã€‚éœ€è¦åœ¨åé¢å¼•ç”¨ Canvas çš„éƒ¨åˆ†è¿›è¡Œåˆ¤æ–­ã€‚
		}
		this._addevent();

		this._formatMessage = runtime.getFormatMessage({
			"zh-cn": {
				"WitCatInput.name": "ç™½çŒ«çš„è¾“å…¥æ¡†",
				"WitCatInput.createinput":
					"åˆ›å»ºæˆ–ä¿®æ”¹[type]æ–‡æœ¬æ¡†å¹¶å‘½åä¸º[id]ï¼ŒX[x]Y[y]å®½[width]é«˜[height]å†…å®¹[text]é¢œè‰²[color]æç¤º[texts]å­—ä½“å¤§å°[size]",
				"WitCatInput.deleteinput": "åˆ é™¤æ–‡æœ¬æ¡†[id]",
				"WitCatInput.getinput": "è·å¾—æ–‡æœ¬æ¡†[id]çš„[type]",
				"WitCatInput.isinput": "ç„¦ç‚¹æ˜¯å¦åœ¨æ–‡æœ¬æ¡†[id]ä¸Š",
				"WitCatInput.whatinput": "ç„¦ç‚¹ä½ç½®",
				"WitCatInput.nowinput": "å°†ç„¦ç‚¹èšç„¦åœ¨æ–‡æœ¬æ¡†[id]ä¸Š",
				"WitCatInput.deleteallinput": "åˆ é™¤æ‰€æœ‰æ–‡æœ¬æ¡†",
				"WitCatInput.compute": "å½“å‰åˆ†è¾¨ç‡ä¸‹é«˜[size]çš„å­—ä½“å¤§å°",
				"WitCatInput.type.1": "å•è¡Œ",
				"WitCatInput.type.2": "å¤šè¡Œ",
				"WitCatInput.number": "ç¬¬[num]ä¸ªæ–‡æœ¬æ¡†çš„[type]",
				"WitCatInput.numbers": "æ–‡æœ¬æ¡†çš„æ•°é‡",
				"WitCatInput.number.1": "X",
				"WitCatInput.number.2": "Y",
				"WitCatInput.number.3": "å®½",
				"WitCatInput.number.4": "é«˜",
				"WitCatInput.number.5": "å†…å®¹",
				"WitCatInput.number.6": "é¢œè‰²",
				"WitCatInput.number.7": "æç¤º",
				"WitCatInput.number.8": "å­—ä½“å¤§å°",
				"WitCatInput.number.9": "æ‰€æœ‰(json)",
				"WitCatInput.number.10": "ID",
				"WitCatInput.number.11": "æ»šåŠ¨ä½ç½®",
				"WitCatInput.number.12": "æ–‡æœ¬é«˜åº¦",
				"WitCatInput.number.13": "å…‰æ ‡ä½ç½®",
				"WitCatInput.number.14": "é€æ˜åº¦",
				"WitCatInput.number.15": "èƒŒæ™¯å›¾ç‰‡",
				"WitCatInput.number.16": "å­—ä½“",
				"WitCatInput.number.17": "è¡Œé«˜",
				"WitCatInput.number.18": "å­—ä½“ç²—ç»†",
				"WitCatInput.number.19": "é˜´å½±",
				"WitCatInput.number.20": "å­—ä½“",
				"WitCatInput.fontweight": "è®¾ç½®æ–‡æœ¬æ¡†[id]çš„å­—ä½“ç²—ç»†ä¸º[text]", // åœ¨æ–‡æ¡£ä¸­æç¤ºç”¨æˆ·å­—ä½“å…¼å®¹æ€§é—®é¢˜ï¼Œå¹¶æ¨èåˆé€‚çš„å­—ä½“
				"WitCatInput.normal": "å¸¸è§„",
				"WitCatInput.bold": "ç²—ä½“",
				"WitCatInput.thin": "ç»†ä½“",
				"WitCatInput.key": "æŒ‰ä¸‹æŒ‰é”®[type]?",
				"WitCatInput.keys": "å½“æŒ‰ä¸‹æŒ‰é”®[type]æ—¶",
				"WitCatInput.keypress": "æŒ‰ä¸‹çš„æŒ‰é”®",
				"WitCatInput.lastkey": "ä¸Šæ¬¡æŒ‰ä¸‹çš„é”®",
				"WitCatInput.mousewheel": "é¼ æ ‡æ»šè½®é€Ÿåº¦", // è¿™ä¸ªç§¯æœ¨åº”è¯¥åœ¨ More_Mouse é‡Œï¼Ÿ
				"WitCatInput.setinput": "è®¾ç½®æ–‡æœ¬æ¡†[id]çš„[type]ä¸º[text]",
				"WitCatInput.setread": "è®¾ç½®æ–‡æœ¬æ¡†[id]ä¸º[read]", // é‡å¤ä½¿ç”¨ä¸‰æ¬¡ï¼Ÿ
				"WitCatInput.setfontfamily":
					"è®¾ç½®æ–‡æœ¬æ¡†[id]å­—ä½“ä»[text]åŠ è½½å­—ä½“å[name]", // åˆ†æˆâ€œåŠ è½½â€å’Œâ€œä½¿ç”¨â€
				"WitCatInput.read.1": "å¯ç¼–è¾‘",
				"WitCatInput.read.2": "ä¸å¯ç¼–è¾‘",
				"WitCatInput.password.1": "æ–‡æœ¬æ¡†",
				"WitCatInput.password.2": "å¯†ç æ¡†",
				"WitCatInput.textalign.1": "å·¦å¯¹é½",
				"WitCatInput.textalign.2": "ä¸­å¯¹é½",
				"WitCatInput.textalign.3": "å³å¯¹é½",
				"WitCatInput.docs": "ğŸ“–æ‹“å±•æ•™ç¨‹",
				"WitCatInput.input": "è¾“å…¥æ¡†",
				"WitCatInput.assist": "è¾…åŠ©",
				"WitCatInput.focal": "ç„¦ç‚¹",
				"WitCatInput.keyboard": "é”®ç›˜",
				"WitCatInput.shadow": "é˜´å½±x[x]y[y]å®½[width]é¢œè‰²[color]",
				"WitCatInput.shadows": "åˆå¹¶é˜´å½±[first]å’Œ[last]",
				"WitCatInput.fontadaptive": "å­—ä½“å¤§å°è‡ªé€‚åº”[type]",
				"WitCatInput.set.1": "å¯ç”¨",
				"WitCatInput.set.2": "ç¦ç”¨",
				"WitCatInput.color": "æ¸å˜é¢œè‰²[color]å’Œé¢œè‰²[colors]è§’åº¦[deg]",
				"WitCatInput.ok": "ç”¨æˆ·ç¡®è®¤è¾“å…¥?",
				"WitCatInput.setenter": "è®¾ç½®æ–‡æœ¬æ¡†[id]å¿«æ·é”®ç¡®è®¤ä¸º[enter]æ¢è¡Œä¸º[more]",
			},
			en: {
				"WitCatInput.name": "WitCatâ€˜s Input",
				"WitCatInput.createinput":
					"Create or modify [type]input ID[id]X[x]Y[y]width[width]height[height]content[text]color[color]prompt[texts]fontSize[size]",
				"WitCatInput.deleteinput": "Delete input[id]",
				"WitCatInput.getinput": "[type] of input [id]",
				"WitCatInput.isinput": "input [id] received focus?",
				"WitCatInput.whatinput": "focused input id",
				"WitCatInput.nowinput": "Focus on input [id]",
				"WitCatInput.deleteallinput": "Delete all inputs",
				"WitCatInput.compute": "Font size of now screen[size]",
				"WitCatInput.type.1": "single-line",
				"WitCatInput.type.2": "multi-line",
				"WitCatInput.number": "[type]of input[num]",
				"WitCatInput.numbers": "input count",
				"WitCatInput.number.1": "X",
				"WitCatInput.number.2": "Y",
				"WitCatInput.number.3": "width",
				"WitCatInput.number.4": "height",
				"WitCatInput.number.5": "content",
				"WitCatInput.number.6": "color",
				"WitCatInput.number.7": "prompt",
				"WitCatInput.number.8": "font size",
				"WitCatInput.number.9": "all(json)",
				"WitCatInput.number.10": "ID",
				"WitCatInput.number.11": "scroll position",
				"WitCatInput.number.12": "text height",
				"WitCatInput.number.13": "cursor position ",
				"WitCatInput.number.14": "transparency",
				"WitCatInput.number.15": "background",
				"WitCatInput.number.16": "font family",
				"WitCatInput.number.17": "line height",
				"WitCatInput.number.18": "font weight",
				"WitCatInput.number.19": "shadow",
				"WitCatInput.number.20": "font",
				"WitCatInput.fontweight": "Set fontweight of input[id] to[text]",
				"WitCatInput.normal": "normal",
				"WitCatInput.bold": "bold",
				"WitCatInput.thin": "thin",
				"WitCatInput.key": "key[type]pressed?",
				"WitCatInput.keys": "When key [type] pressed",
				"WitCatInput.keypress": "pressed keys",
				"WitCatInput.lastkey": "last key pressed",
				"WitCatInput.mousewheel": "mouse wheel speed",
				"WitCatInput.setinput": "Set[type]of input[id]to[text]",
				"WitCatInput.setread": "Set input[id]to[read]",
				"WitCatInput.setfontfamily":
					"ID[id]`s font family url[text] name [name]",
				"WitCatInput.read.1": "editable",
				"WitCatInput.read.2": "uneditable",
				"WitCatInput.password.1": "text",
				"WitCatInput.password.2": "password",
				"WitCatInput.textalign.1": "left",
				"WitCatInput.textalign.2": "center",
				"WitCatInput.textalign.3": "right",
				"WitCatInput.docs": "ğŸ“–Tutorials",
				"WitCatInput.input": "text area",
				"WitCatInput.assist": "assist",
				"WitCatInput.focal": "focal",
				"WitCatInput.keyboard": "keyboard",
				"WitCatInput.shadow": "shadow x[x]y[y]weight[width]color[color]",
				"WitCatInput.shadows": "Merge shadows[first]with[last]",
				"WitCatInput.fontadaptive": "[type]font size adaptation",
				"WitCatInput.set.1": "Enable",
				"WitCatInput.set.2": "Disable",
				"WitCatInput.color": "Gradient color [color] and color [colors] angle [deg]",
				"WitCatInput.ok": "confirms input?",
				"WitCatInput.setenter": "Set text box [id] shortcut key Confirm [enter] line feed [more]",
			},
		});
	}

	/**
	 * ç¿»è¯‘
	 * @param {string} id
	 * @returns {string}
	 */
	formatMessage(id) {
		return this._formatMessage({
			id,
			default: id,
			description: id,
		});
	}

	getInfo() {
		return {
			id: witcat_input_extensionId, // æ‹“å±•id
			name: this.formatMessage("WitCatInput.name"), // æ‹“å±•å
			blockIconURI: witcat_input_icon,
			menuIconURI: witcat_input_icon,
			color1: "#52baba",
			color2: "#459c9c",
			blocks: [
				{
					blockType: "button",
					text: this.formatMessage("WitCatInput.docs"),
					onClick: this.docs,
				},
				`---${this.formatMessage("WitCatInput.input")}`,
				{
					opcode: "createinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.createinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "type",
						},
						x: {
							type: "number",
							defaultValue: "0",
						},
						y: {
							type: "number",
							defaultValue: "0",
						},
						width: {
							type: "number",
							defaultValue: "100",
						},
						height: {
							type: "number",
							defaultValue: "20",
						},
						text: {
							type: "string",
							defaultValue: "hello world!",
						},
						color: {
							type: "string",
							defaultValue: "#000000",
						},
						texts: {
							type: "string",
							defaultValue: "hello world!",
						},
						size: {
							type: "number",
							defaultValue: "16",
						},
					},
				},
				{
					opcode: "setinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "typess",
						},
						text: {
							type: "string",
							defaultValue: "10",
						},
					},
				},
				{
					opcode: "fontweight",
					blockType: "command",
					text: this.formatMessage("WitCatInput.fontweight"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						text: {
							type: "string",
							menu: "fontweight",
						},
					},
				},
				{
					opcode: "setread",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setread"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						read: {
							type: "string",
							menu: "read",
						},
					},
				},
				{
					opcode: "password",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setread"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						read: {
							type: "string",
							menu: "password",
						},
					},
				},
				{
					opcode: "textalign",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setread"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						read: {
							type: "string",
							menu: "textalign",
						},
					},
				},
				{
					opcode: "setfont",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setfontfamily"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						text: {
							type: "string",
							defaultValue: "url",
						},
						name: {
							type: "string",
							defaultValue: "arial",
						},
					},
				},
				{
					opcode: "setenter",
					blockType: "command",
					text: this.formatMessage("WitCatInput.setenter"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						enter: {
							type: "string",
							defaultValue: "Enter",
						},
						more: {
							type: "string",
							defaultValue: ",Enter",
						},
					},
				},
				{
					opcode: "getinput",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.getinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
						type: {
							type: "string",
							menu: "types",
						},
					},
				},
				{
					opcode: "number",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.number"),
					arguments: {
						num: {
							type: "number",
							defaultValue: "1",
						},
						type: {
							type: "string",
							menu: "types",
						},
					},
				},
				{
					opcode: "numbers",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.numbers"),
					arguments: {},
				},
				{
					opcode: "deleteinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.deleteinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
					},
				},
				{
					opcode: "deleteallinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.deleteallinput"),
					arguments: {},
				},
				{
					opcode: "fontadaptive",
					blockType: "command",
					text: this.formatMessage("WitCatInput.fontadaptive"),
					arguments: {
						type: {
							type: "Boolean",
							menu: "set",
						},
					},
				},
				`---${this.formatMessage("WitCatInput.assist")}`,
				{
					opcode: "ok",
					blockType: "hat",
					text: this.formatMessage("WitCatInput.ok"),
					arguments: {},
				},
				{
					opcode: "oks",
					blockType: "Boolean",
					text: this.formatMessage("WitCatInput.ok"),
					arguments: {},
				},
				{
					opcode: "compute",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.compute"),
					arguments: {
						size: {
							type: "number",
							defaultValue: "16",
						},
					},
				},
				{
					opcode: "shadow",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.shadow"),
					arguments: {
						x: {
							type: "number",
							defaultValue: "0",
						},
						y: {
							type: "number",
							defaultValue: "0",
						},
						width: {
							type: "number",
							defaultValue: "3",
						},
						color: {
							type: "string",
							defaultValue: "#000000",
						},
					},
				},
				{
					opcode: "shadows",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.shadows"),
					arguments: {
						first: {
							type: "string",
							defaultValue: "0px 0px 3px #000000",
						},
						last: {
							type: "string",
							defaultValue: "0px 0px 3px #000000",
						},
					},
				},
				{
					opcode: "color",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.color"),
					arguments: {
						color: {
							type: "color",
							defaultValue: "#ffff00",
						},
						colors: {
							type: "color",
							defaultValue: "#ff0000",
						},
						deg: {
							type: "number",
							defaultValue: "0",
						},
					},
				},
				`---${this.formatMessage("WitCatInput.focal")}`,
				{
					opcode: "isinput",
					blockType: "Boolean",
					text: this.formatMessage("WitCatInput.isinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
					},
				},
				{
					opcode: "whatinput",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.whatinput"),
					arguments: {},
				},
				{
					opcode: "nowinput",
					blockType: "command",
					text: this.formatMessage("WitCatInput.nowinput"),
					arguments: {
						id: {
							type: "string",
							defaultValue: "i",
						},
					},
				},
				`---${this.formatMessage("WitCatInput.keyboard")}`,
				{
					opcode: "key",
					blockType: "Boolean",
					text: this.formatMessage("WitCatInput.key"),
					arguments: {
						type: {
							type: "string",
							defaultValue: "KeyA",
						},
					},
				},
				{
					opcode: "mousewheel",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.mousewheel"),
					arguments: {},
				},
				{
					opcode: "keys",
					blockType: "hat",
					text: this.formatMessage("WitCatInput.keys"),
					func: false,
					arguments: {
						type: {
							type: "string",
							defaultValue: "KeyA",
						},
					},
				},
				{
					opcode: "lastkey",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.lastkey"),
					func: false,
					arguments: {},
				},
				{
					opcode: "keypress",
					blockType: "reporter",
					text: this.formatMessage("WitCatInput.keypress"),
					func: false,
					arguments: {},
				},
			],
			menus: {
				type: [
					{
						text: this.formatMessage("WitCatInput.type.1"),
						value: "input",
					},
					{
						text: this.formatMessage("WitCatInput.type.2"),
						value: "Textarea",
					},
				],
				types: [
					{
						text: this.formatMessage("WitCatInput.number.10"),
						value: "ID",
					},
					{
						text: this.formatMessage("WitCatInput.number.1"),
						value: "X",
					},
					{
						text: this.formatMessage("WitCatInput.number.2"),
						value: "Y",
					},
					{
						text: this.formatMessage("WitCatInput.number.3"),
						value: "width",
					},
					{
						text: this.formatMessage("WitCatInput.number.4"),
						value: "height",
					},
					{
						text: this.formatMessage("WitCatInput.number.5"),
						value: "content",
					},
					{
						text: this.formatMessage("WitCatInput.number.6"),
						value: "color",
					},
					{
						text: this.formatMessage("WitCatInput.number.7"),
						value: "prompt",
					},
					{
						text: this.formatMessage("WitCatInput.number.8"),
						value: "font-size",
					},
					{
						text: this.formatMessage("WitCatInput.number.20"),
						value: "font",
					},
					{
						text: this.formatMessage("WitCatInput.number.11"),
						value: "rp",
					},
					{
						text: this.formatMessage("WitCatInput.number.12"),
						value: "th",
					},
					{
						text: this.formatMessage("WitCatInput.number.13"),
						value: "cp",
					},
					{
						text: this.formatMessage("WitCatInput.number.14"),
						value: "op",
					},
					{
						text: this.formatMessage("WitCatInput.number.15"),
						value: "bg",
					},
					{
						text: this.formatMessage("WitCatInput.number.16"),
						value: "ff",
					},
					{
						text: this.formatMessage("WitCatInput.number.17"),
						value: "lh",
					},
					{
						text: this.formatMessage("WitCatInput.number.18"),
						value: "fw",
					},
					{
						text: this.formatMessage("WitCatInput.number.19"),
						value: "ts",
					},
					{
						text: this.formatMessage("WitCatInput.number.9"),
						value: "json",
					},
				],
				typess: [
					{
						text: this.formatMessage("WitCatInput.number.1"),
						value: "X",
					},
					{
						text: this.formatMessage("WitCatInput.number.2"),
						value: "Y",
					},
					{
						text: this.formatMessage("WitCatInput.number.3"),
						value: "width",
					},
					{
						text: this.formatMessage("WitCatInput.number.4"),
						value: "height",
					},
					{
						text: this.formatMessage("WitCatInput.number.5"),
						value: "content",
					},
					{
						text: this.formatMessage("WitCatInput.number.6"),
						value: "color",
					},
					{
						text: this.formatMessage("WitCatInput.number.7"),
						value: "prompt",
					},
					{
						text: this.formatMessage("WitCatInput.number.8"),
						value: "font-size",
					},
					{
						text: this.formatMessage("WitCatInput.number.20"),
						value: "font",
					},
					{
						text: this.formatMessage("WitCatInput.number.11"),
						value: "rp",
					},
					{
						text: this.formatMessage("WitCatInput.number.13"),
						value: "cp",
					},
					{
						text: this.formatMessage("WitCatInput.number.14"),
						value: "op",
					},
					{
						text: this.formatMessage("WitCatInput.number.15"),
						value: "bg",
					},
					{
						text: this.formatMessage("WitCatInput.number.17"),
						value: "lh",
					},
					{
						text: this.formatMessage("WitCatInput.number.19"),
						value: "ts",
					},
					{
						text: "âš css",
						value: "css",
					},
				],
				read: [
					{
						text: this.formatMessage("WitCatInput.read.1"),
						value: "eb",
					},
					{
						text: this.formatMessage("WitCatInput.read.2"),
						value: "ue",
					},
				],
				password: [
					{
						text: this.formatMessage("WitCatInput.password.1"),
						value: "text",
					},
					{
						text: this.formatMessage("WitCatInput.password.2"),
						value: "password",
					},
				],
				textalign: [
					{
						text: this.formatMessage("WitCatInput.textalign.1"),
						value: "left",
					},
					{
						text: this.formatMessage("WitCatInput.textalign.2"),
						value: "center",
					},
					{
						text: this.formatMessage("WitCatInput.textalign.3"),
						value: "right",
					},
				],
				fontweight: {
					acceptReporters: true,
					items: [
						{
							text: `100(${this.formatMessage("WitCatInput.thin")})`,
							value: "100",
						},
						{
							text: "200",
							value: "200",
						},
						{
							text: "300",
							value: "300",
						},
						{
							text: `400(${this.formatMessage("WitCatInput.normal")})`,
							value: "400",
						},
						{
							text: "500",
							value: "500",
						},
						{
							text: "600",
							value: "600",
						},
						{
							text: `700(${this.formatMessage("WitCatInput.bold")})`,
							value: "700",
						},
						{
							text: "800",
							value: "800",
						},
						{
							text: "900",
							value: "900",
						},
					],
				},
				set: [
					{
						text: this.formatMessage("WitCatInput.set.1"),
						value: "true",
					},
					{
						text: this.formatMessage("WitCatInput.set.2"),
						value: "false",
					},
				],
			},
		};
	}

	/**
	 * æ‰“å¼€æ•™ç¨‹
	 * @returns {void}
	 */
	docs() {
		const a = document.createElement("a");
		a.href = "https://www.ccw.site/post/6153a7a6-05fb-462e-b785-b97700b12bc2";
		a.rel = "noopener noreferrer";
		a.target = "_blank";
		a.click();
	}

	/**
	 * é™åˆ¶å€¼çš„èŒƒå›´ï¼Œå¦‚æœå€¼æ˜¯NaNï¼Œè¿”å›æœ€å°å€¼
	 * @param {number} x æ•°å€¼
	 * @param {number} min æœ€å°å€¼
	 * @param {number} max æœ€å¤§å€¼
	 * @return {number}
	 */
	_clamp(x, min, max) {
		// return isNaN(x) ? min : x < min ? min : x > max ? max : x;
		return Number.isNaN(x) ? min : Math.min(max, Math.max(min, x));
	}

	/**
	 * è®¾ç½®æˆ–åˆ›å»ºæ–‡æœ¬æ¡†
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @param {SCarg} args.type æ–‡æœ¬æ¡†ç±»å‹ "input"|"textarea"
	 * @param {SCarg} args.x å·¦ä¸Šè§’x
	 * @param {SCarg} args.y å·¦ä¸Šè§’y
	 * @param {SCarg} args.width å®½åº¦
	 * @param {SCarg} args.height é«˜åº¦
	 * @param {SCarg} args.text åˆå§‹æ–‡æœ¬
	 * @param {SCarg} args.color æ–‡å­—é¢œè‰²
	 * @param {SCarg} args.texts æç¤ºæ–‡æœ¬
	 * @param {SCarg} args.size æ–‡å­—å¤§å°
	 */
	createinput(args) {
		if (this.canvas() === null || this.inputParent() === null) {
			return;
		}
		let x = Number(args.x);
		let y = Number(args.y);
		let width = Number(args.width);
		let height = Number(args.height);
		x = this._clamp(x, 0, this.runtime.stageWidth);
		y = this._clamp(y, 0, this.runtime.stageHeight);
		width = this._clamp(width, 0, this.runtime.stageWidth - x);
		height = this._clamp(height, 0, this.runtime.stageHeight - y);
		x = (x / this.runtime.stageWidth) * 100;
		y = (y / this.runtime.stageHeight) * 100;
		width = (width / this.runtime.stageWidth) * 100;
		height = (height / this.runtime.stageHeight) * 100;

		/** @type {HTMLInputElement|HTMLTextAreaElement|null} */
		let search = null;
		const tempSearch = document.getElementById(`WitCatInput${args.id}`);
		if (
			tempSearch instanceof HTMLInputElement ||
			tempSearch instanceof HTMLTextAreaElement
		) {
			search = tempSearch;
		}
		// è¿™é‡Œé€šè¿‡â€œå¦‚æœä¸ç¬¦åˆï¼Œå°±åˆ é™¤ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œå°±å»ºç«‹â€çš„æ–¹å¼ï¼Œ
		// é¿å…åé¢å¤§é‡å¤åˆ¶ç²˜è´´æ ·å¼æ“ä½œã€‚
		// å¤§æ®µçš„å¤åˆ¶ç²˜è´´å¾€å¾€æ„å‘³ç€ä¹‹åä¼šçŠ¯é”™ï¼ˆåªæ”¹ä¸€åŠï¼‰
		if (search !== null && search.tagName !== args.type) {
			this.inputParent().removeChild(search);
			search = null;
		}
		if (search === null) {
			// æ ‡å‡†ä¸‹ input å’Œ textarea éƒ½åº”è¯¥æ˜¯å°å†™ï¼Œ
			// ä½†æ˜¯èœå•ä¸­çš„ textarea æ˜¯å¤§å†™çš„ã€‚
			// ä¸ºäº†å…¼å®¹ä¸èƒ½ä¿®æ”¹èœå•æ•°å€¼ï¼Œåªèƒ½è½¬æ¢ã€‚
			const argstype = String(args.type).toLowerCase();
			if (argstype !== "input" && argstype !== "textarea") {
				// é˜²æ­¢ä¿®æ”¹ JSON æ³¨å…¥
				console.warn("Input.js: ç±»å‹åº”è¯¥æ˜¯ input æˆ–è€… textarea");
				return;
			}
			search = document.createElement(argstype);
			let s = {};
			// åªæœ‰ input æ‰æœ‰ type å±æ€§ï¼Œtextarea æ²¡æœ‰
			if (search instanceof HTMLInputElement) {
				search.type = "text";
				s.id = args.id;
				s.enter = "Enter";
				s.more = ",Enter";
			} else {
				s.id = args.id;
				s.enter = ",Enter";
				s.more = "Enter";
			}
			s.input = true;
			search.addEventListener("compositionstart", (e) => {
				this.InputListen.find((event) => event.id === e.target.id.split("WitCatInput")[1]).input = false;
			})
			search.addEventListener("compositionend", (e) => {
				setTimeout(() => {
					this.InputListen.find((event) => event.id === e.target.id.split("WitCatInput")[1]).input = true;
				}, 100);
			})
			this.InputListen = this.InputListen.filter(function (item) {
				return item.id !== args.id;
			});
			this.InputListen.push(s);
			search.onkeydown = (e) => {
				if (e.code === "Enter")
					e.preventDefault();
			}
			search.onkeyup = (e) => {
				if (e.code === "Enter")
					e.preventDefault();
			}
			search.id = `WitCatInput${args.id}`;
			search.value = String(args.text);
			search.className = "WitCatInput";
			search.name = String(args.type);
			search.placeholder = String(args.texts);
			this.inputParent().appendChild(search);
		}

		// ç°åœ¨ç›´æ¥é€šè¿‡styleçš„å±æ€§ä¿®æ”¹æ ·å¼è¡¨ï¼Œä¸éœ€è¦æ‹…å¿ƒâ€œåˆ†å·æ³¨å…¥â€é—®é¢˜äº†
		const sstyle = search.style;
		sstyle.backgroundColor = "transparent";
		sstyle.border = "0px";
		sstyle.textShadow = "0 0 0 #000";
		sstyle.outline = "none";
		sstyle.position = "absolute";
		sstyle.left = `${x}%`;
		sstyle.top = `${y}%`;
		sstyle.width = `${width}%`;
		sstyle.height = `${height}%`;
		sstyle.fontSize = `${this.adaptive
			? (parseFloat(this.canvas().style.width) / 360) * Number(args.size)
			: Number(args.size)
			}px`;
		sstyle.resize = "none";
		sstyle.color = String(args.color);
		sstyle.opacity = "1";
		sstyle.backgroundSize = "100% 100%";
		search.value = String(args.text);
		search.placeholder = String(args.texts);

		this.inputFontSize[String(args.id)] = Number(args.size);
	}

	/**
	 * åˆ é™¤æ–‡æœ¬æ¡†
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡†id
	 */
	deleteinput(args) {
		if (this.inputParent() === null) {
			return;
		}
		this.InputListen = this.InputListen.filter(function (item) {
			return item.id !== args.id;
		});
		const search = document.getElementById(`WitCatInput${args.id}`);
		if (search !== null) {
			this.inputParent().removeChild(search);
		}
	}

	/**
	 * è·å–æ–‡æœ¬æ¡†å†…å®¹
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡†id
	 * @param {SCarg} args.type å†…å®¹ç±»å‹
	 * @return {SCarg}
	 */
	getinput(args) {
		const search = document.getElementById(`WitCatInput${args.id}`);
		return search === null ? "" : this._getattrib(search, String(args.type));
	}

	/**
	 * ç„¦ç‚¹åˆ¤æ–­
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @returns {boolean}
	 */
	isinput(args) {
		const search = document.getElementById(`WitCatInput${args.id}`);
		if (search !== null) {
			if (search === document.activeElement) {
				return true;
			}
			return false;
		}
		return false;
	}

	/**
	 * ç„¦ç‚¹ä½ç½®
	 * @returns {string} æ–‡æœ¬æ¡† ID
	 */
	whatinput() {
		if (
			document.activeElement !== null &&
			document.activeElement.className === "WitCatInput"
		) {
			return this._getWitCatID(document.activeElement);
		}
		return "";
	}

	/**
	 * ç„¦ç‚¹è·å–
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 */
	nowinput(args) {
		const search = document.getElementById(`WitCatInput${args.id}`);
		if (search !== null) {
			search.focus();
		} else {
			const active = document.activeElement;
			if (active !== null && active.className === "WitCatInput") {
				if (
					active instanceof HTMLInputElement ||
					active instanceof HTMLTextAreaElement
				) {
					active.blur();
				}
			}
		}
	}

	/**
	 * åˆ é™¤æ‰€æœ‰æ–‡æœ¬æ¡†
	 */
	deleteallinput() {
		if (this.inputParent() === null) {
			return;
		}
		while (document.getElementsByClassName("WitCatInput").length !== 0) {
			const search = document.getElementsByClassName("WitCatInput");
			search.forEach(item => {
				item.remove();
			});
		}
		this.InputListen = [];
	}

	ok() {
		let s = this.InputEnter;
		return s !== false;
	}

	oks() {
		let s = this.InputEnter;
		return s !== false;
	}

	/**
	 * è®¡ç®—æ–‡å­—å¤§å°
	 * @param {object} args
	 * @param {SCarg} args.size Scratch æ–‡å­—å¤§å°
	 * @returns {number}
	 */
	compute(args) {
		if (this.canvas() === null) {
			return 0;
		}
		return (parseFloat(this.canvas().style.width) / 360) * Number(args.size);
	}

	/**
	 * è·å–æŒ‡å®šç¼–å·çš„æ–‡æœ¬æ¡†å±æ€§
	 * @param {object} args
	 * @param {SCarg} args.num æ–‡æœ¬æ¡†åºå·
	 * @param {SCarg} args.type å±æ€§ç±»å‹
	 * @returns {SCarg}
	 */
	number(args) {
		const searchall = document.getElementsByClassName("WitCatInput");
		const index = Number(args.num);
		const search = searchall[index - 1];
		if (search !== undefined) {
			return this._getattrib(search, String(args.type));
		}
		return "";
	}

	setenter(args) {
		if (this.InputListen.find((e) => { return e.id === args.id }) !== undefined) {
			this.InputListen.find((e) => { return e.id === args.id }).enter = args.enter;
			this.InputListen.find((e) => { return e.id === args.id }).more = args.more;
		}
	}

	/**
	 * è·å–æ–‡æœ¬æ¡†çš„å±æ€§
	 * @param {Element} element æ–‡æœ¬æ¡†å…ƒç´ 
	 * @param {string} type å±æ€§ç±»å‹
	 * @returns {number|string}
	 */
	_getattrib(element, type) {
		// ç”¨äºé€šè¿‡ç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ä¸å‡ºé”™
		if (
			!(
				element instanceof HTMLInputElement ||
				element instanceof HTMLTextAreaElement
			)
		) {
			console.warn("Input.js: è·å–åˆ°çš„å…ƒç´ çš„ç±»å‹ä¸æ­£ç¡®: ", element);
			return "";
		}
		switch (type) {
			case "X":
				return (parseFloat(element.style.left) / 100) * this.runtime.stageWidth;
			// ç†è®ºä¸Šéœ€è¦åŠ break;ï¼Œä½†æ˜¯å‰é¢å·²ç»returnäº†
			case "Y":
				return (parseFloat(element.style.top) / 100) * this.runtime.stageHeight;
			case "width":
				return (
					(parseFloat(element.style.width) / 100) * this.runtime.stageWidth
				);
			case "height":
				return (
					(parseFloat(element.style.height) / 100) * this.runtime.stageHeight
				);
			case "content":
				return element.value;
			case "color":
				return string_colorHex(element.style.color);
			case "prompt":
				return element.placeholder;
			case "font-size":
				return parseFloat(element.style.fontSize);
			case "ID": {
				// ç›´æ¥ä¸Šæ­£åˆ™ï¼Œå¯ä»¥å¤„ç†ç±»ä¼¼â€œWitCatInput123WitCatInput456â€è¿™æ ·åŒ…å«â€œWitCatInputâ€çš„å¥‡è‘©ID
				const match = /^WitCatInput(.*)$/.exec(element.id);
				return match === null || match[1] === undefined ? "" : match[1];
			}
			case "rp":
				return element.scrollTop;
			case "th":
				return element.scrollHeight;
			case "cp":
				return JSON.stringify([element.selectionStart, element.selectionEnd]);
			case "op":
				return 100 - Number(element.style.opacity) * 100;
			case "bg": {
				// (æ³¨ï¼šä¸€å¼€å§‹backgroundImageçš„å€¼å¯èƒ½æ˜¯ç©ºçš„æˆ–è€…åˆ«çš„ä»€ä¹ˆä¸œè¥¿â€¦â€¦) // ä¸é€‚åˆsplitçš„åœ°æ–¹ï¼Œç›´æ¥ä¸Šæ­£åˆ™
				// æ‰“èŠ±æ‹¬å·ä¹‹åå°±å¯ä»¥åœ¨é‡Œé¢å£°æ˜å˜é‡äº†
				const match = /^url\("(.*)"\)$/.exec(element.style.backgroundImage);
				if (match !== null && match[1] !== undefined) {
					return decodeURI(match[1]);
				}
				// æ­£åˆ™åŒ¹é…å¤±è´¥
				return "";
			}
			case "ff":
				return element.style.fontFamily;
			case "lh":
				return parseFloat(element.style.lineHeight);
			case "fw":
				return element.style.fontWeight;
			case "ts":
				return element.style.textShadow;
			case "font":
				return element.style.fontFamily;
			case "json":
				// ç›´æ¥æŠŠæ•´ä¸ªä¸œè¥¿è½¬æˆ JSON å¯¹è±¡ï¼Œå†æ‹¼æ¥
				return JSON.stringify({
					X: this._getattrib(element, "X"),
					Y: this._getattrib(element, "Y"),
					width: this._getattrib(element, "width"),
					height: this._getattrib(element, "height"),
					content: this._getattrib(element, "content"),
					color: this._getattrib(element, "color"),
					prompt: this._getattrib(element, "prompt"),
					"font-size": this._getattrib(element, "font-size"),
					ID: this._getattrib(element, "ID"),
					"Rolling position": this._getattrib(element, "rp"),
					"Text height": this._getattrib(element, "th"),
					"cursor position": JSON.parse(String(this._getattrib(element, "cp"))),
					// è¿™é‡Œçœ‹èµ·æ¥ç¼ºäº†ä¸€äº›ä¸œè¥¿ï¼Œå¦‚æœæ²¡æœ‰åˆå¹¶å¤åˆ¶ç²˜è´´çš„ä»£ç ä»¥åŠè¿›
					// è¡Œä¼˜åŒ–ï¼Œå°†éœ€è¦ä¿®æ”¹ä¸¤æ¬¡å¤§æ®µå†…å®¹ï¼Œç°åœ¨ä¿®æ”¹å°±ç®€å•äº†ã€‚
				});
			default:
				return "";
		}
	}

	/**
	 * æ–‡æœ¬æ¡†æ•°é‡
	 * @returns {number}
	 */
	numbers() {
		const search = document.getElementsByClassName("WitCatInput");
		return search.length;
	}

	/**
	 * æŒ‰é”®æ£€æµ‹
	 * @param {object} args
	 * @param {SCarg} args.type æŒ‰é”®ç±»å‹ï¼Œç”¨é€—å·åˆ†éš”
	 * @returns {boolean}
	 */
	key(args) {
		const key = String(args.type).split(",");
		return key.every((item) => Object.keys(this.keypresslist).includes(item));
	}

	/**
	 * æ”¯æŒç»„åˆé”®çš„æŒ‰é”®æ£€æµ‹
	 * @param {array} keydown æŒ‰ä¸‹çš„æŒ‰é”®
	 * @param {array} press éœ€è¦æŒ‰ä¸‹çš„æŒ‰é”®
	 * @returns {boolean} æ˜¯å¦æŒ‰ä¸‹
	 */
	keypresss(keydown, press) {
		return press.every((item) => Object.keys(keydown).includes(item)) && Object.keys(keydown).every((item) => press.includes(item));
	}

	/**
	 * æŒ‰é”®æ£€æµ‹(å¸½å­ç§¯æœ¨)
	 * @param {object} args
	 * @param {SCarg} args.type æŒ‰é”®ç±»å‹ï¼Œç”¨é€—å·åˆ†éš”
	 * @returns {boolean}
	 */
	keys(args) {
		const key = String(args.type).split(",");
		return key.every((item) => Object.keys(this.keypresslist).includes(item));
	}

	/**
	 * ä¸Šæ¬¡æŒ‰ä¸‹çš„é”®
	 * @returns {string}
	 */
	lastkey() {
		return this.lastKey;
	}

	/**
	 * é¼ æ ‡æ»šè½®é€Ÿåº¦
	 * @returns {number}
	 */
	mousewheel() {
		return this.MouseWheel;
	}

	/**
	 * è®¾ç½®æ–‡æœ¬æ¡†
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @param {SCarg} args.type å±æ€§ç±»å‹
	 * @param {SCarg} args.text å±æ€§å€¼
	 */
	setinput(args) {
		const search = this._findWitCatInput(String(args.id));
		if (search !== null) {
			const sstyle = search.style;
			let x;
			let y;
			let width;
			let height;
			let opacity;
			switch (args.type) {
				case "X":
					x = this._clamp(Number(args.text), 0, this.runtime.stageWidth);
					x = (x / this.runtime.stageWidth) * 100;
					sstyle.left = `${x}%`;
					break;
				case "Y":
					y = this._clamp(Number(args.text), 0, this.runtime.stageHeight);
					y = (y / this.runtime.stageHeight) * 100;
					sstyle.top = `${y}%`;
					break;
				case "width":
					x = (parseFloat(sstyle.left) / 100) * this.runtime.stageWidth;
					width = this._clamp(
						Number(args.text),
						0,
						this.runtime.stageWidth - x
					);
					width = (width / this.runtime.stageWidth) * 100;
					sstyle.width = `${Number(width)}%`;
					break;
				case "height":
					y = (parseFloat(sstyle.top) / 100) * this.runtime.stageHeight;
					height = this._clamp(
						Number(args.text),
						0,
						this.runtime.stageHeight - y
					);
					height = (height / this.runtime.stageHeight) * 100;
					sstyle.height = `${Number(height)}%`;
					break;
				case "content":
					search.value = String(args.text);
					break;
				case "prompt":
					search.placeholder = String(args.text);
					break;
				case "color":
					sstyle.color = String(args.text);
					break;
				case "font-size":
					sstyle.fontSize = `${Number(args.text)}px`;
					this.inputFontSize[String(args.id)] = Number(args.text);
					break;
				case "rp":
					search.scrollTop = Number(args.text);
					break;
				case "op":
					opacity = this._clamp(Number(args.text), 0, 100);
					opacity = 1 - opacity / 100;
					sstyle.opacity = String(opacity);
					break;
				case "cp":
					try {
						const selection = JSON.parse(String(args.text));
						if (selection instanceof Array && selection.length === 2) {
							search.setSelectionRange(selection[0], selection[1]);
						} else if (typeof selection === "number") {
							search.setSelectionRange(selection, selection);
						}
					} catch (err) {
						console.error(err);
					}
					break;
				case "bg":
					if (
						String(args.text).indexOf("ccw") !== -1 ||
						String(args.text).indexOf("xiguacity") !== -1 ||
						String(args.text).startsWith("linear-gradient")
					) {
						sstyle.backgroundImage = `url("${encodeURI(String(args.text))}")`;
						sstyle.backgroundSize = "100% 100%";
					} else {
						console.warn("ç¦æ­¢çš„é“¾æ¥/å›¾ç‰‡\nBanned links/pictures");
					}
					break;
				case "lh":
					sstyle.lineHeight = `${Number(args.text)}px`;
					break;
				case "ts":
					sstyle.textShadow = String(args.text);
					break;
				case "css":
					search.setAttribute("style", String(args.text));
					break;
				case "font":
					search.style.fontFamily = `"${args.text}"`;
					break;
				default:
					break;
			}
		}
	}

	/**
	 * è®¾ç½®æ˜¯å¦å¯ä¿®æ”¹
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @param {SCarg} args.read èƒ½å¦ä¿®æ”¹
	 */
	setread(args) {
		const search = this._findWitCatInput(String(args.id));
		if (search !== null) {
			if (args.read === "eb") {
				search.disabled = false;
			} else {
				search.disabled = true;
			}
		}
	}

	/**
	 * è®¾ç½®æ–‡æœ¬æ¡†æ˜¯å¦ä¸ºå¯†ç æ¡†
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @param {SCarg} args.read æ˜¯å¯†ç æ¡† "test"|"password"
	 */
	password(args) {
		const search = this._findWitCatInput(String(args.id));
		if (search !== null) {
			if (search instanceof HTMLTextAreaElement) {
				console.warn("Input.js: å¤šè¡Œæ–‡æœ¬æ¡†æ— æ³•è®¾ä¸ºå¯†ç æ¡†");
				return;
			}
			search.type = String(args.read);
		}
	}

	/**
	 * è·å–æŒ‰ä¸‹çš„æŒ‰é”®
	 * @returns {string}
	 */
	keypress() {
		return JSON.stringify(Object.keys(this.keypresslist));
	}

	/**
	 * è®¾ç½®å­—ä½“
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @param {SCarg} args.name å­—ä½“å
	 * @param {SCarg} args.text å­—ä½“é“¾æ¥
	 */
	setfont(args) {
		const search = document.getElementById(`WitCatInput${args.id}`);
		if (search !== null) {
			const xhr = new XMLHttpRequest(); // å®šä¹‰ä¸€ä¸ªå¼‚æ­¥å¯¹è±¡
			xhr.open("GET", String(args.text), true); // å¼‚æ­¥GETæ–¹å¼åŠ è½½å­—ä½“
			xhr.responseType = "arraybuffer"; // æŠŠå¼‚æ­¥è·å–ç±»å‹æ”¹ä¸ºarraybufferäºŒè¿›åˆ¶ç±»å‹
			xhr.onload = function () {
				// è¿™é‡Œåšäº†ä¸€ä¸ªåˆ¤æ–­ï¼šå¦‚æœæµè§ˆå™¨æ”¯æŒFontFaceæ–¹æ³•æ‰§è¡Œ
				if (typeof FontFace !== "undefined") {
					document.fonts.add(new FontFace(String(args.name), this.response)); // å°†å­—ä½“å¯¹è±¡æ·»åŠ åˆ°é¡µé¢ä¸­
					search.style.fontFamily = `"${args.name}"`;
				} else {
					search.innerHTML = `@font-face{font-family:"${args.name}";src:url("${args.text}") `;
				}
			};
			xhr.send();
		}
	}

	/**
	 * è®¾ç½®å¯¹é½æ–¹å¼
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @param {SCarg} args.read å¯¹é½æ–¹å¼ "left"|"center"|"right"
	 */
	textalign(args) {
		const search = document.getElementById(`WitCatInput${args.id}`);
		if (search !== null) {
			search.style.textAlign = String(args.read);
		}
	}

	/**
	 * è®¾ç½®æ–‡æœ¬æ¡†å­—ä½“ç²—ç»†
	 * @param {object} args
	 * @param {SCarg} args.id æ–‡æœ¬æ¡† ID
	 * @param {SCarg} args.text å­—ä½“ç²—ç»†
	 */
	fontweight(args) {
		const search = document.getElementById(`WitCatInput${args.id}`);
		if (search !== null) {
			search.style.fontWeight = String(args.text);
		}
	}

	/**
	 * åˆ›å»ºé˜´å½±
	 * @param {object} args
	 * @param {SCarg} args.x åç§»x
	 * @param {SCarg} args.y åç§»y
	 * @param {SCarg} args.width å®½åº¦
	 * @param {SCarg} args.color é¢œè‰²
	 * @returns {string}
	 */
	shadow(args) {
		return `${args.x}px ${args.y}px ${args.width}px ${args.color}`;
	}

	/**
	 * åˆå¹¶é˜´å½±
	 * @param {object} args
	 * @param {SCarg} args.first ç¬¬ä¸€ä¸ªé˜´å½±
	 * @param {SCarg} args.last ç¬¬äºŒä¸ªé˜´å½±
	 * @returns {string}
	 */
	shadows(args) {
		return `${args.first},${args.last}`;
	}

	/**
	 * è®¾ç½®å­—ä½“è‡ªé€‚åº”
	 * @param {object} args
	 * @param {SCarg} args.type
	 */
	fontadaptive(args) {
		if (this.canvas() === null) {
			return;
		}
		if (args.type === "true") {
			if (!this.adaptive) {
				const search = document.getElementsByClassName("WitCatInput");
				const config = {
					attributes: true,
					childList: true,
					subtree: true,
					attributeFilter: ["style"],
				};
				const callback = () => {
					if (this.canvas() === null) {
						return;
					}
					Array.prototype.map.call(search, (item) => {
						const searchId = this._getWitCatID(item);
						const fontsize = this.inputFontSize[searchId];
						if (fontsize) {
							item.style.fontSize = `${(parseFloat(this.canvas().offsetWidth) / 360) * fontsize
								}px`;
						}
					});
				};
				this.observer = new MutationObserver(callback);
				this.observer.observe(this.canvas(), config);
				this.adaptive = true;
			}
		} else if (this.adaptive) {
			if (this.observer !== null) {
				this.observer.disconnect();
			}
			this.adaptive = false;
		}
	}

	color(args) {
		return `linear-gradient(${args.deg}deg, ${args.color}, ${args.colors});`
	}

	/**
	 * æ·»åŠ é”®ç›˜é¼ æ ‡äº‹ä»¶
	 */
	_addevent() {
		if (this.canvas() === null || this.inputParent() === null) {
			return;
		}
		// é”®ç›˜äº‹ä»¶ç›‘å¬
		document.addEventListener("keydown", (event) => {
			this.keypresslist[event.code] = true;
			this.lastKey = event.code;
			if ((event.target instanceof HTMLTextAreaElement || event.target instanceof HTMLInputElement) && event.target.id.startsWith("WitCatInput")) {
				if (this.InputListen.find((e) => e.id === event.target.id.split("WitCatInput")[1]).input) {
					if (this.keypresss(this.keypresslist, this.InputListen.find((e) => e.id === event.target.id.split("WitCatInput")[1]).more.split(','))) {
						if (event.target instanceof HTMLTextAreaElement) {
							let start = event.target.selectionStart;
							let end = event.target.selectionEnd;
							var newDope = event.target.value.substring(0, start) + '\n' + event.target.value.substring(end, event.target.value.length);
							event.target.value = (newDope);
							event.target.selectionStart = start + 1;
							event.target.selectionEnd = start + 1;
						}
					}
					if (
						this.keypresss(this.keypresslist, this.InputListen.find((e) => e.id === event.target.id.split("WitCatInput")[1]).enter.split(','))) {
						clearTimeout(this.InputEnter);
						this.InputEnter = setTimeout(() => {
							this.InputEnter = false;
						}, 300);
					}
				}
			}
		});
		document.addEventListener("keyup", (event) => {
			delete this.keypresslist[event.code];
		});

		// ç»™é¡µé¢ç»‘å®šæ»‘è½®æ»šåŠ¨äº‹ä»¶
		this.canvas().addEventListener(
			"wheel",
			(e) => {
				// æ³¨æ„è¿™ä¸ªè´Ÿæ•°â€¦â€¦
				// ç›®å‰çš„æ ‡å‡†ç”¨æ³•æ˜¯ä½¿ç”¨ deltaYï¼Œä½†æ˜¯ deltaY çš„ç¬¦å·å’Œ WheelDeltaY ç›¸åã€‚
				// ä¸ºäº†å’ŒåŸæœ‰çš„è¡Œä¸ºä¸€è‡´ï¼Œä¹˜ä¸Š -3
				// åœ¨æˆ‘çš„æµè§ˆå™¨ä¸­ deltaY = WheelDeltaY / -3
				clearTimeout(this.timer);
				this.MouseWheel = e.deltaY * -3;
				this.timer = setTimeout(() => {
					this.MouseWheel = 0;
				}, 30);
			},
			{ capture: true }
		);
	}

	/**
	 * è·å–æŒ‡å®šå…ƒç´ çš„ WitCatInput ID
	 * @param {Element} element å…ƒç´ 
	 * @returns {string} å…ƒç´  ID å»æ‰ WitCatInput åçš„éƒ¨åˆ†ï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¿”å› ""
	 */
	_getWitCatID(element) {
		const match = /^WitCatInput(.*)$/.exec(element.id);
		if (match === null || match[1] === undefined) {
			console.warn("Input.js: æ— æ³•è·å– WitCatInput ID: ", element);
			return "";
		}
		return match[1];
	}

	/**
	 * è·å–æŒ‡å®š WitCatInput ID çš„å…ƒç´ 
	 * @param {string} witcatID å…ƒç´ 
	 * @returns {HTMLInputElement | HTMLTextAreaElement | null} è·å–çš„å…ƒç´ ï¼Œæˆ–è€… null
	 */
	_findWitCatInput(witcatID) {
		const search = document.getElementById(`WitCatInput${witcatID}`);
		if (search === null) {
			console.warn("Input.js: æ‰¾ä¸åˆ° ID", witcatID);
			return null;
		}
		if (
			search instanceof HTMLInputElement ||
			search instanceof HTMLTextAreaElement
		) {
			return search;
		}
		console.warn("Input.js: å…ƒç´ ä¸æ˜¯ <input> æˆ–è€… <textarea>");
		return null;
	}
}

/**
 * é¢œè‰²è½¬æ¢
 * @param {string} color
 */
// eslint-disable-next-line camelcase
function string_colorHex(color) {
	// RGBé¢œè‰²å€¼çš„æ­£åˆ™
	const reg = /^(rgb|RGB)/;
	if (reg.test(color)) {
		let strHex = "#";
		// æŠŠRGBçš„3ä¸ªæ•°å€¼å˜æˆæ•°ç»„
		const colorArr = color.replace(/(?:\(|\)|rgb|RGB)*/g, "").split(",");
		// è½¬æˆ16è¿›åˆ¶
		for (let i = 0; i < colorArr.length; i++) {
			let hex = Number(colorArr[i]).toString(16);
			if (hex === "0") {
				hex += hex;
			}
			strHex += hex;
		}
		return strHex;
	}
	return String(color);
}

window.tempExt = {
	Extension: WitCatInput,
	info: {
		name: "WitCatInput.name",
		description: "WitCatInput.descp",
		extensionId: witcat_input_extensionId,
		iconURL: witcat_input_picture,
		insetIconURL: witcat_input_icon,
		featured: true,
		disabled: false,
		collaborator: "ç™½çŒ« @ CCW",
	},
	l10n: {
		"zh-cn": {
			"WitCatInput.name": "ç™½çŒ«çš„è¾“å…¥æ¡† V2.8",
			"WitCatInput.descp": "å…¨æ–°çš„è¾“å…¥æ¡†ï¼",
		},
		en: {
			"WitCatInput.name": "WitCatâ€˜s Input V2.8",
			"WitCatInput.descp": "what a nice input!",
		},
	},
};